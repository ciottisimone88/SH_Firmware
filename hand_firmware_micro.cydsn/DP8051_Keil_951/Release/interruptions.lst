C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE INTERRUPTIONS
OBJECT MODULE PLACED IN .\DP8051_Keil_951\Release\interruptions.obj
COMPILER INVOKED BY: C:\Program Files (x86)\Cypress\PSoC Creator\4.4\PSoC Creator\import\keil\pk51\9.51\C51\BIN\c51.exe 
                    -interruptions.c NOIV LARGE MODDP2 OMF2 VB(1) NOIP INCDIR(.,Generated_Source\PSoC3) FF(3) DB DF(NDEBUG) WL(2) PR(.\DP8051
                    -_Keil_951\Release/interruptions.lst) CD OT(8,SPEED) OJ(.\DP8051_Keil_951\Release\interruptions.obj)

line level    source

*** MESSAGE C286 IN LINE 0 OF (null): license limits optimization to level 5
   1          // ----------------------------------------------------------------------------
   2          // BSD 3-Clause License
   3          
   4          // Copyright (c) 2016, qbrobotics
   5          // Copyright (c) 2017, Centro "E.Piaggio"
   6          // All rights reserved.
   7          
   8          // Redistribution and use in source and binary forms, with or without
   9          // modification, are permitted provided that the following conditions are met:
  10          
  11          // * Redistributions of source code must retain the above copyright notice, this
  12          //   list of conditions and the following disclaimer.
  13          
  14          // * Redistributions in binary form must reproduce the above copyright notice,
  15          //   this list of conditions and the following disclaimer in the documentation
  16          //   and/or other materials provided with the distribution.
  17          
  18          // * Neither the name of the copyright holder nor the names of its
  19          //   contributors may be used to endorse or promote products derived from
  20          //   this software without specific prior written permission.
  21          
  22          // THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  23          // AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  24          // IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
  25          // DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
  26          // FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  27          // DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
  28          // SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
  29          // CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
  30          // OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
  31          // OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  32          // POSSIBILITY OF SUCH DAMAGE.
  33          // ----------------------------------------------------------------------------
  34          
  35          /**
  36          * \file         interruptions.c
  37          *
  38          * \brief        Interruption handling and firmware core functions
  39          * \date         October 01, 2017
  40          * \author       _Centro "E.Piaggio"_
  41          * \copyright    (C) 2012-2016 qbrobotics. All rights reserved.
  42          * \copyright    (C) 2017 Centro "E.Piaggio". All rights reserved.
  43          */
  44          
  45          
  46          //=================================================================     includes
  47          #include <interruptions.h>
  48          #include <command_processing.h>
  49          #include <globals.h>
  50          #include <utils.h>
  51          
  52          
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 2   

  53          //==============================================================================
  54          //                                                            RS485 RX INTERRUPT
  55          //==============================================================================
  56          // Processing RS-485 data frame:
  57          //
  58          // - 0:     Waits for beggining characters
  59          // - 1:     Waits for ID;
  60          // - 2:     Data length;
  61          // - 3:     Receive all bytes;
  62          // - 4:     Wait for another device end of transmission;
  63          //
  64          //==============================================================================
  65          
  66          // PWM values needed to obtain 11.5 V given a certain input tension
  67          // Numbers are sperimentally calculated //[index] (millivolts)
  68          static const uint8 pwm_preload_values[29] = {100,    //0 (11500)
  69                                                        83,
  70                                                        78,
  71                                                        76,
  72                                                        74,
  73                                                        72,    //5 (14000)
  74                                                        70,
  75                                                        68,
  76                                                        67,
  77                                                        65,
  78                                                        64,    //10 (16500)
  79                                                        63,
  80                                                        62,
  81                                                        61,
  82                                                        60,
  83                                                        59,    //15 (19000)
  84                                                        58,
  85                                                        57,
  86                                                        56,
  87                                                        56,
  88                                                        55,    //20 (21500)
  89                                                        54,
  90                                                        54,
  91                                                        53,
  92                                                        52,
  93                                                        52,    //25 (24000)
  94                                                        52,
  95                                                        51,
  96                                                        51};   //28 (25500)
  97          
  98          CYCODE uint8 pwm_preload_values_6v[32] = {  100,  //0 (6000)
  99                                                       76,
 100                                                       71,
 101                                                       68,
 102                                                       66,
 103                                                       64,   //5 (8750)
 104                                                       62,
 105                                                       60,
 106                                                       58,
 107                                                       56,
 108                                                       54,   //10 (11500)
 109                                                       53,
 110                                                       52,
 111                                                       51,
 112                                                       50,
 113                                                       49,   //15 (14250)
 114                                                       47,
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 3   

 115                                                       46,
 116                                                       45,
 117                                                       44,
 118                                                       43,   //20 (17000)
 119                                                       42,
 120                                                       41,
 121                                                       40,
 122                                                       39,
 123                                                       38,   //25 (19750)
 124                                                       37,
 125                                                       37,
 126                                                       37,
 127                                                       37,
 128                                                       36};  //30 (22500)
 129          //==============================================================================
 130          //                                                            WATCHDOG INTERRUPT
 131          //==============================================================================
 132          
 133          CY_ISR(ISR_WATCHDOG_Handler){
 134   1      
 135   1          // Set WDT flag
 136   1          
 137   1          watchdog_flag = TRUE;
 138   1      
 139   1      }
 140          
 141          //==============================================================================
 142          //                                                            RS485 RX INTERRUPT
 143          //==============================================================================
 144          
 145          CY_ISR(ISR_RS485_RX_ExInterrupt) {
 146   1      
 147   1          // Set RS485 flag
 148   1          
 149   1          interrupt_flag = TRUE;
 150   1           
 151   1      }
 152          
 153          //==============================================================================
 154          //                                                        CYCLES TIMER INTERRUPT
 155          //==============================================================================
 156          CY_ISR(ISR_CYCLES_Handler){
 157   1      
 158   1          // Set cycles interrupt flag
 159   1          
 160   1          cycles_interrupt_flag = TRUE;
 161   1          
 162   1          CYCLES_TIMER_STATUS;
 163   1      
 164   1      }
 165          
 166          //==============================================================================
 167          //                                                             INTERRUPT MANAGER
 168          //==============================================================================
 169          // Manage interrupt from RS485 
 170          //==============================================================================
 171          // Processing RS-485 data frame:
 172          //
 173          // - WAIT_START:    Waits for beginning characters;
 174          // - WAIT_ID:       Waits for ID;
 175          // - WAIT_LENGTH:   Data length;
 176          // - RECEIVE:       Receive all bytes;
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 4   

 177          // - UNLOAD:        Wait for another device end of transmission;
 178          //
 179          //==============================================================================
 180          
 181          void interrupt_manager(){
 182   1      
 183   1          
 184   1          //===========================================     local variables definition
 185   1      
 186   1          static uint8 CYDATA state = WAIT_START;                      // state
 187   1          
 188   1          //------------------------------------------------- local data packet
 189   1          static uint8 CYDATA data_packet_index;
 190   1          static uint8 CYDATA data_packet_length;
 191   1          static uint8 data_packet_buffer[128];                     
 192   1          static uint8 CYDATA rx_queue[3];                    // last 2 bytes received
 193   1          //-------------------------------------------------
 194   1      
 195   1          uint8 CYDATA    rx_data;                            // RS485 UART rx data
 196   1          CYBIT           rx_data_type;                       // my id?
 197   1          uint8 CYDATA    package_count = 0;                     
 198   1      
 199   1          //======================================================     receive routine
 200   1          
 201   1          // Get data until buffer is not empty 
 202   1          
 203   1          while(UART_RS485_GetRxBufferSize() && (package_count < 6)){  
 204   2              // 6 - estimated maximum number of packets we can read without blocking firmware execution
 205   2              
 206   2              // Get next char
 207   2              rx_data = UART_RS485_GetChar();
 208   2              
 209   2              switch (state) {
 210   3                  //-----     wait for frame start     -------------------------------
 211   3                  case WAIT_START:
 212   3                  
 213   3                      rx_queue[0] = rx_queue[1];
 214   3                      rx_queue[1] = rx_queue[2];
 215   3                      rx_queue[2] = rx_data;
 216   3                      
 217   3                      // Check for header configuration package
 218   3                      if ((rx_queue[1] == 58) && (rx_queue[2] == 58)) {
 219   4                          rx_queue[0] = 0;
 220   4                          rx_queue[1] = 0;
 221   4                          rx_queue[2] = 0;
 222   4                          state       = WAIT_ID;                    
 223   4                      }else
 224   3                          if ((rx_queue[0] == 63) &&      //ASCII - ?
 225   3                              (rx_queue[1] == 13) &&      //ASCII - CR
 226   3                              (rx_queue[2] == 10))        //ASCII - LF)
 227   3                              infoGet(INFO_ALL);
 228   3                      break;
 229   3      
 230   3                  //-----     wait for id     ----------------------------------------
 231   3                  case  WAIT_ID:
 232   3      
 233   3                      // packet is for my ID or is broadcast
 234   3                      if (rx_data == c_mem.id || rx_data == 0)
 235   3                          rx_data_type = FALSE;
 236   3                      else                //packet is for others
 237   3                          rx_data_type = TRUE;
 238   3                      
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 5   

 239   3                      data_packet_length = 0;
 240   3                      state = WAIT_LENGTH;
 241   3                      break;
 242   3      
 243   3                  //-----     wait for length     ------------------------------------
 244   3                  case  WAIT_LENGTH:
 245   3      
 246   3       
 247   3                      data_packet_length = rx_data;
 248   3                      // check validity of pack length
 249   3                      if (data_packet_length <= 1) {
 250   4                          data_packet_length = 0;
 251   4                          state = WAIT_START;
 252   4                      } else if (data_packet_length > 128) {
 253   4                          data_packet_length = 0;
 254   4                          state = WAIT_START;
 255   4                      } else {
 256   4                          data_packet_index = 0;
 257   4                          
 258   4                          if(rx_data_type == FALSE)
 259   4                              state = RECEIVE;          // packet for me or broadcast
 260   4                          else
 261   4                              state = UNLOAD;           // packet for others
 262   4                      }
 263   3                      break;
 264   3      
 265   3                  //-----     receiving     -------------------------------------------
 266   3                  case RECEIVE:
 267   3      
 268   3                      data_packet_buffer[data_packet_index] = rx_data;
 269   3                      data_packet_index++;
 270   3                      
 271   3                      // check end of transmission
 272   3                      if (data_packet_index >= data_packet_length) {
 273   4                          // verify if frame ID corresponded to the device ID
 274   4                          if (rx_data_type == FALSE) {
 275   5                              // copying data from buffer to global packet
 276   5                              memcpy(g_rx.buffer, data_packet_buffer, data_packet_length);
 277   5                              g_rx.length = data_packet_length;
 278   5                              g_rx.ready  = 1;
 279   5                              commProcess();
 280   5                          }
 281   4                          
 282   4                          data_packet_index  = 0;
 283   4                          data_packet_length = 0;
 284   4                          state              = WAIT_START;
 285   4                          package_count++;
 286   4                      
 287   4                      }
 288   3                      break;
 289   3      
 290   3                  //-----     other device is receving     ---------------------------
 291   3                  case UNLOAD:
 292   3                      if (!(--data_packet_length)) {
 293   4                          data_packet_index  = 0;
 294   4                          data_packet_length = 0;
 295   4                          RS485_CTS_Write(1);
 296   4                          RS485_CTS_Write(0);
 297   4                          state              = WAIT_START;
 298   4                          package_count++;
 299   4                      }
 300   3                      break;
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 6   

 301   3              }
 302   2          }
 303   1      }
 304          //==============================================================================
 305          //                                                            FUNCTION SCHEDULER
 306          //==============================================================================
 307          // Call all the function with the right frequency
 308          //==============================================================================
 309          // Base frequency 1000 Hz
 310          //==============================================================================
 311          
 312          void function_scheduler(void) {
 313   1       
 314   1          static uint16 counter_calibration = DIV_INIT_VALUE;
 315   1          CYBIT write_cycles = FALSE;
 316   1          timer_value0 = (uint32)MY_TIMER_ReadCounter();
 317   1      
 318   1          // Start ADC Conversion, SOC = 1
 319   1      
 320   1          ADC_SOC_Write(0x01); 
 321   1          
 322   1          // Check Interrupt 
 323   1      
 324   1          if (interrupt_flag){
 325   2              interrupt_flag = FALSE;
 326   2              interrupt_manager();
 327   2              write_cycles = TRUE;
 328   2          }
 329   1        
 330   1          //---------------------------------- Get Encoders
 331   1      
 332   1          encoder_reading(0); 
 333   1          
 334   1          // Check Interrupt     
 335   1          
 336   1          if (interrupt_flag){
 337   2              interrupt_flag = FALSE;
 338   2              interrupt_manager();
 339   2              write_cycles = TRUE;
 340   2          }   
 341   1          
 342   1          encoder_reading(1);
 343   1          
 344   1          // Check Interrupt 
 345   1          
 346   1          if (interrupt_flag){
 347   2              interrupt_flag = FALSE;
 348   2              interrupt_manager();
 349   2              write_cycles = TRUE;
 350   2          }
 351   1          
 352   1          encoder_reading(2);
 353   1          
 354   1          // Check Interrupt 
 355   1          
 356   1          if (interrupt_flag){
 357   2              interrupt_flag = FALSE;
 358   2              interrupt_manager();
 359   2              write_cycles = TRUE;
 360   2          }
 361   1      
 362   1          //---------------------------------- Control Motor
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 7   

 363   1         
 364   1          motor_control();
 365   1      
 366   1          // Check Interrupt 
 367   1      
 368   1          if (interrupt_flag){
 369   2              interrupt_flag = FALSE;
 370   2              interrupt_manager();
 371   2              write_cycles = TRUE;
 372   2          }
 373   1      
 374   1          //---------------------------------- Read conversion buffer - LOCK function
 375   1      
 376   1          analog_read_end();
 377   1      
 378   1          if (interrupt_flag){
 379   2              interrupt_flag = FALSE;
 380   2              interrupt_manager();
 381   2              write_cycles = TRUE;
 382   2          }
 383   1      
 384   1          //---------------------------------- Control Overcurrent
 385   1      
 386   1          overcurrent_control();
 387   1          
 388   1          // Check Interrupt 
 389   1          
 390   1          if (interrupt_flag){
 391   2              interrupt_flag = FALSE;
 392   2              interrupt_manager();
 393   2              write_cycles = TRUE;
 394   2          }
 395   1      
 396   1          //---------------------------------- Calibration 
 397   1      
 398   1          // Divider 10, freq = 500 Hz
 399   1          if (calib.enabled == TRUE) {
 400   2              if (counter_calibration == CALIBRATION_DIV) {
 401   3                  calibration();
 402   3                  counter_calibration = 0;
 403   3              }
 404   2              counter_calibration++;
 405   2          }
 406   1      
 407   1          // Check Interrupt 
 408   1          
 409   1          if (interrupt_flag){
 410   2              interrupt_flag = FALSE;
 411   2              interrupt_manager();
 412   2              write_cycles = TRUE;
 413   2          }
 414   1          
 415   1          //---------------------------------- Rest position check
 416   1          
 417   1          // Divider 10, freq = 500 Hz
 418   1          if (c_mem.rest_position_flag == TRUE){
 419   2              if (counter_calibration == CALIBRATION_DIV) {
 420   3                      check_rest_position();
 421   3                      counter_calibration = 0;
 422   3              }
 423   2              counter_calibration++;
 424   2      
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 8   

 425   2              // Check Interrupt     
 426   2              if (interrupt_flag){
 427   3                  interrupt_flag = FALSE;
 428   3                  interrupt_manager();
 429   3                              write_cycles = TRUE;
 430   3              }
 431   2          } 
 432   1      
 433   1          //---------------------------------- Control Cycles Counter
 434   1      
 435   1          cycles_counter_update();
 436   1      
 437   1          // Check Cycles Interrupt 
 438   1          
 439   1          if (cycles_interrupt_flag){
 440   2              cycles_interrupt_flag = FALSE;
 441   2      
 442   2              // Cycles are written only every 120 seconds (CYCLES_TIMER interrupt)
 443   2              // to save EEPROM writings (1M maximum)
 444   2              if(can_write) {
 445   3                  cycles_status = PREPARE_DATA;
 446   3                  
 447   3                  //Update time variable
 448   3                  g_mem.total_time_on = g_mem.total_time_on + 120;  // Add 120 seconds.
 449   3              }
 450   2          }
 451   1          
 452   1          // Check Interrupt 
 453   1          
 454   1          if (interrupt_flag){
 455   2              interrupt_flag = FALSE;
 456   2              interrupt_manager();
 457   2          }
 458   1          
 459   1          //---------------------------------- Update States
 460   1          
 461   1          // Load k-1 state
 462   1          memcpy( &g_measOld, &g_meas, sizeof(g_meas) );
 463   1          memcpy( &g_refOld, &g_ref, sizeof(g_ref) );
 464   1      
 465   1          // Load k+1 state
 466   1          memcpy( &g_ref, &g_refNew, sizeof(g_ref) );
 467   1      
 468   1          if (interrupt_flag){
 469   2              interrupt_flag = FALSE;
 470   2              interrupt_manager();
 471   2              write_cycles = TRUE;
 472   2          }
 473   1      
 474   1          timer_value = (uint32)MY_TIMER_ReadCounter();
 475   1          cycle_time = (float)((timer_value0 - timer_value)/1000000.0);
 476   1          MY_TIMER_WriteCounter(5000000);
 477   1      
 478   1      }
 479          
 480          //==============================================================================
 481          //                                                                MOTORS CONTROL
 482          //==============================================================================
 483          
 484          void motor_control() {
 485   1      
 486   1          int32 CYDATA pwm_input = 0;
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 9   

 487   1      
 488   1          int32 CYDATA pos_error;         // position error
 489   1          int32 CYDATA curr_error;        // current error
 490   1      
 491   1          int32 CYDATA i_ref;             // current reference
 492   1          int32 CYDATA handle_value;
 493   1      
 494   1          int32 CYDATA err_emg_1, err_emg_2;
 495   1      
 496   1          int32 CYDATA k_p = c_mem.k_p;  
 497   1          int32 CYDATA k_i = c_mem.k_i; 
 498   1          int32 CYDATA k_d = c_mem.k_d; 
 499   1      
 500   1          int32 CYDATA k_p_c = c_mem.k_p_c;  
 501   1          int32 CYDATA k_i_c = c_mem.k_i_c; 
 502   1          int32 CYDATA k_d_c = c_mem.k_d_c;   
 503   1      
 504   1          int32 CYDATA k_p_dl = c_mem.k_p_dl;  
 505   1          int32 CYDATA k_i_dl = c_mem.k_i_dl; 
 506   1          int32 CYDATA k_d_dl = c_mem.k_d_dl;
 507   1          int32 CYDATA pos_error_max = ((int32)c_mem.current_limit << 13)/(k_p_dl);
 508   1          
 509   1          int32 CYDATA k_p_c_dl = c_mem.k_p_c_dl;  
 510   1          int32 CYDATA k_i_c_dl = c_mem.k_i_c_dl; 
 511   1          int32 CYDATA k_d_c_dl = c_mem.k_d_c_dl;   
 512   1      
 513   1          // Static Variables
 514   1      
 515   1          static int32 pos_error_sum;     // position error sum for integral
 516   1          static int32 curr_error_sum;    // current error sum for integral
 517   1          
 518   1          static int32 prev_pos_err;      // previous position error for deriv. control
 519   1          static int32 prev_curr_err;     // previous current error for deriv. control
 520   1      
 521   1          static CYBIT motor_dir = FALSE;
 522   1      
 523   1          static uint8 current_emg = 0;   // 0 NONE
 524   1                                          // 1 EMG 1
 525   1                                          // 2 EMG 2
 526   1                                          // wait for both to get down
 527   1      
 528   1          err_emg_1 = g_meas.emg[0] - c_mem.emg_threshold[0];
 529   1          err_emg_2 = g_meas.emg[1] - c_mem.emg_threshold[1];
 530   1      
 531   1          // =========================== POSITION INPUT ==============================
 532   1          switch(c_mem.input_mode) {
 533   2      
 534   2              case INPUT_MODE_ENCODER3:
 535   2      
 536   2                  // Calculate handle value based on position of handle in the
 537   2                  // sensor chain and multiplication factor between handle and motor position
 538   2                  if (c_mem.double_encoder_on_off) 
 539   2                      handle_value = g_meas.pos[2] * c_mem.motor_handle_ratio;
 540   2                  else
 541   2                      handle_value = g_meas.pos[1] * c_mem.motor_handle_ratio;
 542   2                  
 543   2      
 544   2                  // Read handle and use it as reference for the motor
 545   2                  if (((handle_value - g_ref.pos[0]) > c_mem.max_step_pos) && (c_mem.max_step_pos != 0))
 546   2                      g_ref.pos[0] += c_mem.max_step_pos;
 547   2                  else {
 548   3                      if (((handle_value - g_ref.pos[0]) < c_mem.max_step_neg) && (c_mem.max_step_neg != 0))
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 10  

 549   3                          g_ref.pos[0] += c_mem.max_step_neg;
 550   3                      else
 551   3                          g_ref.pos[0] = handle_value;
 552   3                  }
 553   2                  break;
 554   2      
 555   2              case INPUT_MODE_EMG_PROPORTIONAL:
 556   2                  if (err_emg_1 > 0)
 557   2                      g_ref.pos[0] = (err_emg_1 * g_mem.pos_lim_sup[0]) / (1024 - c_mem.emg_threshold[0]);
 558   2                  else
 559   2                      g_ref.pos[0] = 0;
 560   2                  break;
 561   2      
 562   2              case INPUT_MODE_EMG_INTEGRAL:
 563   2                  g_ref.pos[0] = g_refOld.pos[0];
 564   2                  if (err_emg_1 > 0) {
 565   3                      g_ref.pos[0] = g_refOld.pos[0] + (err_emg_1 * (int)g_mem.emg_speed * 2) / (1024 - c_mem.em
             -g_threshold[0]);
 566   3                  }
 567   2                  if (err_emg_2 > 0) {
 568   3                      g_ref.pos[0] = g_refOld.pos[0] - (err_emg_2 * (int)g_mem.emg_speed * 2) / (1024 - c_mem.em
             -g_threshold[1]);
 569   3                  }
 570   2                  break;
 571   2      
 572   2              case INPUT_MODE_EMG_FCFS:
 573   2                  g_ref.pos[0] = g_refOld.pos[0];
 574   2                  switch (current_emg) {
 575   3                      case 0:
 576   3                          // Look for the first EMG passing the threshold
 577   3                          if (err_emg_1 > 0) {
 578   4                              current_emg = 1;
 579   4                              break;
 580   4                          }
 581   3                          if (err_emg_2 > 0) {
 582   4                              current_emg = 2;
 583   4                              break;
 584   4                          }
 585   3                          break;
 586   3      
 587   3                      case 1:
 588   3                          // EMG 1 is first
 589   3                          if (err_emg_1 < 0) {
 590   4                              current_emg = 0;
 591   4                              break;
 592   4                          }
 593   3                          g_ref.pos[0] = g_refOld.pos[0] + (err_emg_1 * g_mem.emg_speed * 2) / (1024 - c_mem.emg
             -_threshold[0]);
 594   3                          break;
 595   3      
 596   3                      case 2:
 597   3                          // EMG 2 is first
 598   3                          if (err_emg_2 < 0) {
 599   4                              current_emg = 0;
 600   4                              break;
 601   4                          }
 602   3                          g_ref.pos[0] = g_refOld.pos[0] - (err_emg_2 * g_mem.emg_speed * 2) / (1024 - c_mem.emg
             -_threshold[1]);
 603   3                          break;
 604   3      
 605   3                      default:
 606   3                          break;
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 11  

 607   3                  }
 608   2      
 609   2                  break;
 610   2      
 611   2              case INPUT_MODE_EMG_FCFS_ADV:
 612   2                  g_ref.pos[0] = g_refOld.pos[0];
 613   2                  switch (current_emg) {
 614   3                      // Look for the first EMG passing the threshold
 615   3                      case 0:
 616   3                          if (err_emg_1 > 0) {
 617   4                              current_emg = 1;
 618   4                              break;
 619   4                          }
 620   3                          if (err_emg_2 > 0) {
 621   4                              current_emg = 2;
 622   4                              break;
 623   4                          }
 624   3                          break;
 625   3      
 626   3                      // EMG 1 is first
 627   3                      case 1:
 628   3                          // If both signals are under threshold go back to status 0
 629   3                          if ((err_emg_1 < 0) && (err_emg_2 < 0)) {
 630   4                              current_emg = 0;
 631   4                              break;
 632   4                          }
 633   3                          // but if the current signal come back over threshold, continue using it
 634   3                          if (err_emg_1 > 0) 
 635   3                              g_ref.pos[0] = g_refOld.pos[0] + (err_emg_1 * g_mem.emg_speed << 2) / (1024 - c_me
             -m.emg_threshold[0]);
 636   3                          
 637   3                          break;
 638   3      
 639   3                      // EMG 2 is first
 640   3                      case 2:
 641   3                          // If both signals are under threshold go back to status 0
 642   3                          if ((err_emg_1 < 0) && (err_emg_2 < 0)) {
 643   4                              current_emg = 0;
 644   4                              break;
 645   4                          }
 646   3                          // but if the current signal come back over threshold, continue using it
 647   3                          if (err_emg_2 > 0) {
 648   4                              g_ref.pos[0] = g_refOld.pos[0] - (err_emg_2 * c_mem.emg_speed << 2) / (1024 - c_me
             -m.emg_threshold[1]);
 649   4                          }
 650   3                          break;
 651   3      
 652   3                      default:
 653   3                          break;
 654   3                  }
 655   2      
 656   2              default:
 657   2                  break;
 658   2          }
 659   1      
 660   1          // Position limit saturation
 661   1          if (c_mem.pos_lim_flag) {
 662   2              if (g_ref.pos[0] < c_mem.pos_lim_inf[0]) 
 663   2                  g_ref.pos[0] = c_mem.pos_lim_inf[0];
 664   2              if (g_ref.pos[0] > c_mem.pos_lim_sup[0]) 
 665   2                  g_ref.pos[0] = c_mem.pos_lim_sup[0];
 666   2          }
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 12  

 667   1          
 668   1          if (c_mem.rest_position_flag == TRUE) {
 669   2              if (rest_enabled == 1){
 670   3                  // Change position reference to drive motor to rest position smoothly
 671   3                  g_ref.pos[0] = rest_pos_curr_ref;
 672   3              }
 673   2              
 674   2              if (forced_open == 1) {
 675   3                  // Open the SoftHand as EMG PROPORTIONAL input mode 
 676   3                  if (err_emg_2 > 0)
 677   3                      g_ref.pos[0] = g_mem.rest_pos - (err_emg_2 * g_mem.rest_pos) / (1024 - c_mem.emg_threshold
             -[1]);
 678   3                  else {
 679   4                      g_ref.pos[0] = g_mem.rest_pos;
 680   4                      forced_open = 0;
 681   4                  }
 682   3              }
 683   2          }
 684   1      
 685   1          switch(c_mem.control_mode) {
 686   2              // ======================= CURRENT AND POSITION CONTROL =======================
 687   2              case CURR_AND_POS_CONTROL:
 688   2                  pos_error = g_ref.pos[0] - g_meas.pos[0];
 689   2      
 690   2                  pos_error_sum += pos_error;
 691   2                  
 692   2                  // pos error max saturation
 693   2                  if (pos_error > pos_error_max)
 694   2                      pos_error = pos_error_max;
 695   2                  else {
 696   3                      if (pos_error < -pos_error_max)
 697   3                          pos_error = -pos_error_max;
 698   3                  }
 699   2      
 700   2                  // error_sum saturation
 701   2                  if (pos_error_sum > POS_INTEGRAL_SAT_LIMIT)
 702   2                      pos_error_sum = POS_INTEGRAL_SAT_LIMIT;
 703   2                  else {
 704   3                      if (pos_error_sum < -POS_INTEGRAL_SAT_LIMIT) 
 705   3                          pos_error_sum = -POS_INTEGRAL_SAT_LIMIT;
 706   3                  }
 707   2                  
 708   2                  // ------ position PID control ------
 709   2                  
 710   2                  i_ref = 0;
 711   2                  
 712   2                  // Proportional
 713   2                  if (k_p_dl != 0)
 714   2                      i_ref += (int32)(k_p_dl * pos_error) >> 13;
 715   2      
 716   2                  // Integral
 717   2                  if (k_i_dl != 0)
 718   2                      i_ref += (int32)(k_i_dl * pos_error_sum) >> 13;
 719   2      
 720   2                  // Derivative
 721   2                  if (k_d_dl != 0)
 722   2                      i_ref += (int32)(k_d_dl * (pos_error - prev_pos_err)) >> 13;
 723   2                              
 724   2                  // Update previous position
 725   2                  prev_pos_err = pos_error;
 726   2      
 727   2                  i_ref += g_ref.curr_offset;
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 13  

 728   2                                  
 729   2                  // motor direction depends on i_ref
 730   2                  if (i_ref >= 0)
 731   2                      motor_dir = TRUE;
 732   2                  else
 733   2                      motor_dir = FALSE;
 734   2      
 735   2                  // saturate max current
 736   2                  if (i_ref > c_mem.current_limit)
 737   2                      i_ref = c_mem.current_limit;
 738   2                  else {
 739   3                      if (i_ref < -c_mem.current_limit)
 740   3                          i_ref = -c_mem.current_limit;
 741   3                      }
 742   2      
 743   2                  // current error and curr error sum
 744   2                  curr_error = i_ref - g_meas.curr[0];
 745   2                  curr_error_sum += curr_error;
 746   2                  
 747   2                  if (curr_error_sum > CURR_INTEGRAL_SAT_LIMIT)
 748   2                      curr_error_sum = CURR_INTEGRAL_SAT_LIMIT;
 749   2                  else {
 750   3                      if (curr_error_sum < -CURR_INTEGRAL_SAT_LIMIT)
 751   3                          curr_error_sum = -CURR_INTEGRAL_SAT_LIMIT;
 752   3                  }
 753   2      
 754   2                  // ----- current PID control -----
 755   2      
 756   2                  pwm_input = 0;
 757   2      
 758   2                  // Proportional
 759   2                  if (k_p_c_dl != 0)
 760   2                      pwm_input += (int32)(k_p_c_dl * curr_error) >> 13;
 761   2      
 762   2                  // Integral
 763   2                  if (k_i_c_dl != 0)
 764   2                      pwm_input += (int32)(k_i_c_dl * curr_error_sum) >> 13;
 765   2      
 766   2                  // Derivative
 767   2                  if (k_d_c_dl != 0)
 768   2                      pwm_input += (int32)(k_d_c_dl * (curr_error - prev_curr_err)) >> 13;
 769   2      
 770   2                  // pwm_input saturation
 771   2                  if (pwm_input < -PWM_MAX_VALUE) 
 772   2                      pwm_input = -PWM_MAX_VALUE;
 773   2                  else {
 774   3                      if (pwm_input > PWM_MAX_VALUE)
 775   3                          pwm_input = PWM_MAX_VALUE;
 776   3                  }
 777   2      
 778   2                  // Update previous current
 779   2                  prev_curr_err = curr_error;
 780   2      
 781   2              break;
 782   2      
 783   2              // ============================== POSITION CONTROL =====================
 784   2              case CONTROL_ANGLE:
 785   2                  pos_error = g_ref.pos[0] - g_meas.pos[0];
 786   2      
 787   2                  pos_error_sum += pos_error;
 788   2      
 789   2                  // anti-windup (for integral control)
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 14  

 790   2                  if (pos_error_sum > ANTI_WINDUP)
 791   2                      pos_error_sum = ANTI_WINDUP;
 792   2                  else {
 793   3                                      if (pos_error_sum < -ANTI_WINDUP)
 794   3                              pos_error_sum = -ANTI_WINDUP;
 795   3                  }
 796   2      
 797   2                  // Proportional
 798   2                  if (k_p != 0) 
 799   2                      pwm_input = (int32)(k_p * pos_error) >> 16;
 800   2                  
 801   2      
 802   2                  // Integral
 803   2                  if (k_i != 0) 
 804   2                      pwm_input += (int32)(k_i * pos_error_sum) >> 16;
 805   2                  
 806   2      
 807   2                  // Derivative
 808   2                  if (k_d != 0) 
 809   2                      pwm_input += (int32)(k_d * (pos_error - prev_pos_err)) >> 16;
 810   2                  
 811   2      
 812   2                  // Update measure
 813   2                  prev_pos_err = pos_error;
 814   2      
 815   2                  if (pwm_input > 0)
 816   2                      motor_dir = TRUE;
 817   2                  else
 818   2                      motor_dir = FALSE;
 819   2      
 820   2              break;
 821   2      
 822   2              // ========================== CURRENT CONTROL ==========================
 823   2              case CONTROL_CURRENT:
 824   2                  if(g_ref.onoff && tension_valid) {
 825   3                      
 826   3                      i_ref = g_ref.curr[0];
 827   3      
 828   3                      if (i_ref > c_mem.current_limit) 
 829   3                          i_ref = c_mem.current_limit;
 830   3                      else {
 831   4                          if (i_ref < -c_mem.current_limit)
 832   4                              i_ref = -c_mem.current_limit;
 833   4                      }
 834   3                      
 835   3                      // current error
 836   3                      curr_error = i_ref - g_meas.curr[0];            
 837   3                      curr_error_sum += curr_error;
 838   3                      
 839   3                      if (curr_error_sum > CURR_INTEGRAL_SAT_LIMIT)
 840   3                          curr_error_sum = CURR_INTEGRAL_SAT_LIMIT;
 841   3                      else {
 842   4                          if (curr_error_sum < -CURR_INTEGRAL_SAT_LIMIT) 
 843   4                              curr_error_sum = -CURR_INTEGRAL_SAT_LIMIT;
 844   4                      }
 845   3      
 846   3                      pwm_input = 0;
 847   3      
 848   3                      // Proportional
 849   3                      if (k_p_c != 0)
 850   3                          pwm_input += (int32)(k_p_c * curr_error) >> 16;
 851   3      
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 15  

 852   3                      // Integral
 853   3                      if (k_i_c != 0)
 854   3                          pwm_input += (int32)(k_i_c * curr_error_sum) >> 16;
 855   3      
 856   3                      // Derivative
 857   3                      if (k_d_c != 0)
 858   3                          pwm_input += (int32)(k_d_c * (curr_error - prev_curr_err)) >> 16;
 859   3                      
 860   3                      prev_curr_err = curr_error;
 861   3                      
 862   3                      if (pwm_input >= 0) 
 863   3                          motor_dir = TRUE;
 864   3                      else
 865   3                          motor_dir = FALSE;
 866   3                  }
 867   2              break;
 868   2              
 869   2              // ================= DIRECT PWM CONTROL ================================
 870   2              case CONTROL_PWM:
 871   2      
 872   2                  pwm_input = g_ref.pwm[0];
 873   2      
 874   2                  if (pwm_input > 0) 
 875   2                      motor_dir = TRUE;
 876   2                  else 
 877   2                      motor_dir = FALSE;
 878   2                  
 879   2      
 880   2                  // pwm_input saturation
 881   2                  if (pwm_input < -PWM_MAX_VALUE) 
 882   2                      pwm_input = -PWM_MAX_VALUE;
 883   2                  else {
 884   3                                      if (pwm_input > PWM_MAX_VALUE) 
 885   3                              pwm_input = PWM_MAX_VALUE;
 886   3                      }
 887   2      
 888   2              break;
 889   2          }
 890   1      
 891   1          ////////////////////////////////////////////////////////////////////////////
 892   1      
 893   1          if(pwm_input >  PWM_MAX_VALUE) 
 894   1              pwm_input =  PWM_MAX_VALUE;
 895   1          if(pwm_input < -PWM_MAX_VALUE) 
 896   1              pwm_input = -PWM_MAX_VALUE;
 897   1      
 898   1      
 899   1          if (c_mem.control_mode != CONTROL_PWM) 
 900   1              pwm_input = (((pwm_input << 10) / PWM_MAX_VALUE) * dev_pwm_limit) >> 10;
 901   1          
 902   1      
 903   1          pwm_sign = SIGN(pwm_input);
 904   1      
 905   1          if (motor_dir)
 906   1              MOTOR_DIR_Write(0x01);
 907   1          else
 908   1              MOTOR_DIR_Write(0x00);
 909   1      
 910   1          PWM_MOTORS_WriteCompare1(abs(pwm_input));
 911   1      }
 912          
 913          //==============================================================================
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 16  

 914          //                                                               ENCODER READING
 915          //==============================================================================
 916          
 917          void encoder_reading(const uint8 idx) {
 918   1      
 919   1          uint8 CYDATA index = idx;
 920   1          
 921   1          uint8 jj;
 922   1          
 923   1          uint32 data_encoder;
 924   1          int32 value_encoder;
 925   1          int32 speed_encoder;
 926   1          //int32 accel_encoder;
 927   1          int32 aux;
 928   1          int32 init_rot = 0;
 929   1      
 930   1          static int32 last_value_encoder[NUM_OF_SENSORS];
 931   1      
 932   1          static uint8 error[NUM_OF_SENSORS];
 933   1          
 934   1          static CYBIT only_first_time = TRUE;
 935   1      
 936   1          static uint8 one_time_execute = 0;
 937   1          static CYBIT pos_reconstruct = FALSE;
 938   1      
 939   1          static int32 v_value[NUM_OF_SENSORS];   //last value for velocity
 940   1          static int32 vv_value[NUM_OF_SENSORS];  //last last value for velocity
 941   1          static int32 vvv_value[NUM_OF_SENSORS];  //last last last value for velocity
 942   1          
 943   1          //static int32 a_value[NUM_OF_SENSORS];   //last value for acceleration
 944   1          //static int32 aa_value[NUM_OF_SENSORS];  //last last value for acceleration
 945   1          //static int32 aaa_value[NUM_OF_SENSORS];  //last last last value for acceleration
 946   1      
 947   1          if (index >= NUM_OF_SENSORS)
 948   1              return;
 949   1          
 950   1          if (reset_last_value_flag) {
 951   2              for (jj = NUM_OF_SENSORS; jj--;) 
 952   2                  last_value_encoder[jj] = 0;
 953   2              
 954   2              reset_last_value_flag = 0;
 955   2          }
 956   1      
 957   1          //======================================================     reading sensors
 958   1              // Shift 1 right to erase Dummy bit of chain
 959   1          if (index == 0)
 960   1                  data_encoder = (SHIFTREG_ENC_1_ReadData() >> 1) & 0x3FFFF;  //0x0003FFFF reset first 14 bits
 961   1          else {
 962   2              if (index == 1)
 963   2                  data_encoder = (SHIFTREG_ENC_2_ReadData() >> 1) & 0x3FFFF;  //0x0003FFFF reset first 14 bits
 964   2              else // index == 2
 965   2                  data_encoder = (SHIFTREG_ENC_3_ReadData() >> 1) & 0x3FFFF;  //0x0003FFFF reset first 14 bits
 966   2          }
 967   1             
 968   1      
 969   1          if (check_enc_data(&data_encoder)) {
 970   2      
 971   2              value_encoder = (int16) (((data_encoder & 0x3FFC0) - 0x20000) >> 2 ) + g_mem.m_off[index];
 972   2                                                          // reset last 6 bit 
 973   2                                                          // -> |:|:|id|dim|CMD|CHK|(data---
 974   2                                                          // subtract half of max value
 975   2                                                          // and shift to have 16 bit val
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 17  

 976   2      
 977   2              // Initialize last_value_encoder
 978   2              if (only_first_time) {
 979   3                  last_value_encoder[index] = value_encoder;
 980   3                  if (index == 2)
 981   3                      only_first_time = 0;
 982   3              }
 983   2      
 984   2              // Take care of rotations
 985   2              aux = value_encoder - last_value_encoder[index];
 986   2      
 987   2              // ====================== 1 TURN ======================
 988   2              // -32768                    0                    32767 -32768                   0                
             -     32767
 989   2              // |-------------------------|-------------------------|-------------------------|----------------
             ----------|
 990   2              //              |                         |      |           |      |                         |
 991   2              //           -16384                     16383    |           |   -16384                     16383
 992   2              //                                               |           |
 993   2              //                                           24575           -24576
 994   2              //                                               |___________|
 995   2              //                                                   49152
 996   2      
 997   2              // if we are in the right interval, take care of rotation
 998   2              // and update the variable only if the difference between
 999   2              // one measure and another is less than 1/4 of turn
1000   2      
1001   2              // Considering we are sampling at 1kHz, this means that our shaft needs
1002   2              // to go slower than 1/4 turn every ms -> 1 turn every 4ms
1003   2              // equal to 250 turn/s -> 15000 RPM
1004   2      
1005   2              if (aux > 49152)
1006   2                  g_meas.rot[index]--;
1007   2              else{ 
1008   3                  if (aux < -49152)
1009   3                      g_meas.rot[index]++;
1010   3                  else{
1011   4                      if (abs(aux) > 16384) { // if two measure are too far
1012   5                          error[index]++;
1013   5                          if (error[index] < 10)
1014   5                              // Discard
1015   5                              return;
1016   5                      }
1017   4                  }
1018   3              }
1019   2      
1020   2              error[index] = 0;
1021   2      
1022   2              last_value_encoder[index] = value_encoder;
1023   2      
1024   2              value_encoder += (int32)g_meas.rot[index] << 16;
1025   2      
1026   2              if (c_mem.m_mult[index] != 1.0) {
1027   3                  value_encoder *= c_mem.m_mult[index];
1028   3              }
1029   2      
1030   2              g_meas.pos[index] = value_encoder;
1031   2          }
1032   1          
1033   1          switch(index) {
1034   2              case 0:
1035   2                  speed_encoder = (int16)filter_vel_1((11*value_encoder - 18* v_value[0] + 9 * vv_value[0] -2 * 
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 18  

             -vvv_value[0]));
1036   2              break;
1037   2       
1038   2              case 1:
1039   2                  speed_encoder = (int16)filter_vel_2((11*value_encoder - 18* v_value[1] + 9 * vv_value[1] -2 * 
             -vvv_value[1]));
1040   2              break;
1041   2          
1042   2              case 2:
1043   2                  speed_encoder = (int16)filter_vel_3((11*value_encoder - 18* v_value[2] + 9 * vv_value[2] -2 * 
             -vvv_value[2]));
1044   2              break;
1045   2          }
1046   1          //Update current speed
1047   1          speed_encoder = speed_encoder / (6*cycle_time);
1048   1          g_meas.vel[index] = speed_encoder;
1049   1          
1050   1          /*
1051   1          //Encoder rotational acceleration calculation
1052   1          switch(index) {
1053   1              case 0:
1054   1                  accel_encoder = (int16)filter_acc_1((11*speed_encoder - 18* a_value[0] + 9 * aa_value[0] -2* a
             -aa_value[0] ));
1055   1                  break;
1056   1              
1057   1              case 1:
1058   1                  accel_encoder = (int16)filter_acc_2((11*speed_encoder - 18* a_value[1] + 9 * aa_value[1] -2* a
             -aa_value[1] ));
1059   1                  break;
1060   1              
1061   1              case 2:
1062   1                  accel_encoder = (int16)filter_acc_3((11*speed_encoder - 18* a_value[2] + 9 * aa_value[2] -2* a
             -aa_value[2] ));
1063   1                  break;
1064   1          }
1065   1          //Update current acceleration
1066   1          g_meas.acc[index] = accel_encoder / (6*cycle_time);
1067   1          */
1068   1      
1069   1          // update old velocity and acceleration values
1070   1          vvv_value[index] = vv_value[index];
1071   1          vv_value[index] = v_value[index];
1072   1          v_value[index] = value_encoder;
1073   1      
1074   1          /*
1075   1          aaa_value[index] = aa_value[index];
1076   1          aa_value[index] = a_value[index];
1077   1          a_value[index] = speed_encoder;
1078   1          */
1079   1      
1080   1      
1081   1          // wait at least 3 * max_num_of_error (10) + 5 = 35 cycles to reconstruct the right turn
1082   1          if (pos_reconstruct == FALSE){
1083   2              if (one_time_execute < 34) 
1084   2                  one_time_execute++;
1085   2              else {
1086   3                  //Double encoder translation
1087   3                  if (c_mem.double_encoder_on_off){
1088   4      
1089   4                      init_rot = calc_turns_fcn(g_meas.pos[0],g_meas.pos[1]);
1090   4                      
1091   4                      if (c_mem.m_mult[0] < 0)
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 19  

1092   4                          init_rot = -init_rot;
1093   4                      
1094   4                      g_meas.rot[0] = (int8)init_rot;
1095   4      
1096   4                  }
1097   3      
1098   3                  if (c_mem.m_mult != 1.0)
1099   3                      g_meas.pos[0] /= c_mem.m_mult[0];
1100   3                  
1101   3                  g_meas.pos[0] += (int32)(init_rot << 16);
1102   3                  
1103   3                  if (c_mem.m_mult != 1.0)
1104   3                      g_meas.pos[0] *= c_mem.m_mult[0];
1105   3                          
1106   3                  // If necessary activate motors
1107   3                  g_refNew.pos[0] = g_meas.pos[0];
1108   3      
1109   3                  MOTOR_ON_OFF_Write(g_ref.onoff);
1110   3                  
1111   3                  pos_reconstruct = TRUE;
1112   3              }
1113   2          }
1114   1      }
1115          
1116          //==============================================================================
1117          //                                                           ANALOG MEASUREMENTS
1118          //==============================================================================
1119          
1120          void analog_read_end() {
1121   1      
1122   1          /* =========================================================================
1123   1          /   Ideal formulation to calculate tension and current
1124   1          /
1125   1          /   tension = ((read_value_mV - offset) * 101) / gain -> [mV]
1126   1          /   current = ((read_value_mV - offset) * 375) / (gain * resistor) -> [mA]
1127   1          /
1128   1          /   Definition:
1129   1          /   read_value_mV = counts_read / 0.819 -> conversion from counts to mV
1130   1          /   offset = 2000 -> hardware amplifier bias in mV
1131   1          /   gain = 8.086 -> amplifier gain
1132   1          /   resistor = 18 -> resistor of voltage divider in KOhm 
1133   1          /
1134   1          /   Real formulation: tradeoff in good performance and accurancy, ADC_buf[] 
1135   1          /   and offset unit of measurment is counts, instead dev_tension and
1136   1          /   g_meas.curr[] are converted in properly unit.
1137   1          /  =========================================================================
1138   1          */
1139   1      
1140   1          int32 CYDATA i_aux;                                        
1141   1          
1142   1          static uint16 emg_counter_1 = 0;
1143   1          static uint16 emg_counter_2 = 0;
1144   1              static uint8 first_tension_valid = TRUE;
1145   1          static int32 pow_tension = 12000;       //12000 mV (12 V)
1146   1          static uint16 count = 0;
1147   1          static uint32 count2 = 0;
1148   1      
1149   1      
1150   1          // Wait for conversion end
1151   1          
1152   1          while(!ADC_STATUS_Read()){
1153   2              if (interrupt_flag){
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 20  

1154   3                  interrupt_flag = FALSE;
1155   3                  interrupt_manager();
1156   3              }
1157   2          }
1158   1          
1159   1          // Convert tension read
1160   1          dev_tension = ((int32)(ADC_buf[0] - 1638) * 1952) >> 7;
1161   1          
1162   1          if (interrupt_flag){
1163   2              interrupt_flag = FALSE;
1164   2              interrupt_manager();
1165   2          }
1166   1              if (first_tension_valid && tension_valid) {
1167   2              count = count + 1;
1168   2              
1169   2              if (count == 1000){
1170   3                  if (dev_tension < 9000) {   // 8 V case
1171   4                      pow_tension = 8000;
1172   4                  }
1173   3                  else {      // 12 V - 24 V cases
1174   4                      if (dev_tension < 13000) {
1175   5                          pow_tension = 12000;
1176   5                      }
1177   4                      else
1178   4                          pow_tension = 24000;
1179   4                  }
1180   3      
1181   3                  first_tension_valid = FALSE;
1182   3              }
1183   2          }
1184   1      
1185   1          // Until there is no valid input tension repeat this measurement
1186   1          
1187   1          if (dev_tension > 7000) {       //at least > 7.36 V (92% of 8 V) that is minimum charge of smallest ba
             -ttery
1188   2              // Set tension valid bit to TRUE
1189   2      
1190   2              if (count2 == 1000){
1191   3                  tension_valid = TRUE;   
1192   3              }
1193   2              else {                      // wait for battery voltage stabilization
1194   3                  count2 = count2 + 1;
1195   3                  dev_tension_f = filter_voltage(dev_tension);
1196   3              }
1197   2      
1198   2              if(g_mem.activate_pwm_rescaling)        //pwm rescaling is activated
1199   2                  pwm_limit_search();                 //only for 12V motors
1200   2      
1201   2              // Filter and Set currents
1202   2              g_meas.curr[0] = filter_i1((int16) (((int32)(ADC_buf[1] - 1638) * 25771) >> 13) * pwm_sign);
1203   2              
1204   2                      // Calculate current estimation and put it in the second part of the current measurement array;
1205   2                      g_meas.curr[1] = (int16) filter_curr_diff(((int32) g_meas.curr[0]) - curr_estim(g_meas.pos[0] >> g_mem.r
             -es[0], g_meas.vel[0] >> g_mem.res[0], g_ref.pos[0] >> g_mem.res[0]));
1206   2      
1207   2              // Check Interrupt 
1208   2          
1209   2              if (interrupt_flag){
1210   3                  interrupt_flag = FALSE;
1211   3                  interrupt_manager();
1212   3              }
1213   2      
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 21  

1214   2              // if calibration is not needed go to "normal execution"
1215   2              if (!g_mem.emg_calibration_flag){
1216   3                  emg_1_status = NORMAL; // normal execution
1217   3                  emg_2_status = NORMAL; // normal execution
1218   3              }
1219   2      
1220   2              // EMG 1 calibration state machine
1221   2              
1222   2              // Calibration state machine
1223   2              switch(emg_1_status) {
1224   3                  case NORMAL: // normal execution
1225   3                      i_aux = (int32)ADC_buf[2 + g_mem.switch_emg];
1226   3                      if (i_aux < 0) 
1227   3                          i_aux = 0;
1228   3                      i_aux = filter_ch1(i_aux);
1229   3                      i_aux = (i_aux << 10) / g_mem.emg_max_value[0];
1230   3          
1231   3                      if (interrupt_flag){
1232   4                          interrupt_flag = FALSE;
1233   4                          interrupt_manager();
1234   4                      }
1235   3                      //Saturation
1236   3                      if (i_aux < 0)
1237   3                          i_aux = 0;
1238   3                      else
1239   3                          if (i_aux > 1024) 
1240   3                              i_aux = 1024;
1241   3                      
1242   3                      g_meas.emg[0] = i_aux;
1243   3          
1244   3                      if (interrupt_flag){
1245   4                          interrupt_flag = FALSE;
1246   4                          interrupt_manager();
1247   4                      }
1248   3                      
1249   3                      break;
1250   3      
1251   3                  case RESET: // reset variables
1252   3                      emg_counter_1 = 0;
1253   3                      g_mem.emg_max_value[0] = 0;
1254   3                      emg_1_status = DISCARD; // goto next status
1255   3                      
1256   3                      break;
1257   3      
1258   3                  case DISCARD: // discard first EMG_SAMPLE_TO_DISCARD samples
1259   3                      emg_counter_1++;
1260   3                      if (emg_counter_1 == EMG_SAMPLE_TO_DISCARD) {
1261   4                          emg_counter_1 = 0;          // reset counter
1262   4                          
1263   4                          LED_CTRL_Write(1);
1264   4                          LED_BLINK_EN_Write(0);
1265   4                              
1266   4                          if (interrupt_flag){
1267   5                              interrupt_flag = FALSE;
1268   5                              interrupt_manager();
1269   5                          }
1270   4                          
1271   4                          emg_1_status = SUM_AND_MEAN;           // sum and mean status
1272   4                      }
1273   3                      break;
1274   3      
1275   3                  case SUM_AND_MEAN: // sum first SAMPLES_FOR_EMG_MEAN samples
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 22  

1276   3                      // NOTE max(value)*SAMPLES_FOR_EMG_MEAN must fit in 32bit
1277   3                      emg_counter_1++;
1278   3                      if (ADC_buf[2 + g_mem.switch_emg] < 0) 
1279   3                          ADC_buf[2 + g_mem.switch_emg] = 0;
1280   3                      g_mem.emg_max_value[0] += filter_ch1((int32)ADC_buf[2 + g_mem.switch_emg]);
1281   3                      
1282   3                      if (interrupt_flag){
1283   4                          interrupt_flag = FALSE;
1284   4                          interrupt_manager();
1285   4                      }
1286   3                      
1287   3                      if (emg_counter_1 == SAMPLES_FOR_EMG_MEAN) {
1288   4                          g_mem.emg_max_value[0] = g_mem.emg_max_value[0] / SAMPLES_FOR_EMG_MEAN; // calc mean
1289   4          
1290   4                          if (interrupt_flag){
1291   5                              interrupt_flag = FALSE;
1292   5                              interrupt_manager();
1293   5                          }                    
1294   4                          
1295   4                          LED_CTRL_Write(0);
1296   4                          LED_BLINK_EN_Write(0);
1297   4                          
1298   4                          emg_counter_1 = 0;          // reset counter
1299   4      
1300   4                          emg_1_status = NORMAL;           // goto normal execution
1301   4                      }
1302   3                      break;
1303   3      
1304   3                  default:
1305   3                      break;
1306   3              }
1307   2          
1308   2              if (interrupt_flag){
1309   3                  interrupt_flag = FALSE;
1310   3                  interrupt_manager();
1311   3              }
1312   2              // EMG 2 calibration state machine
1313   2              switch(emg_2_status) {
1314   3                  case NORMAL: // normal execution
1315   3                      i_aux = (int32)ADC_buf[3 - g_mem.switch_emg];
1316   3                      if (i_aux < 0)
1317   3                          i_aux = 0;
1318   3                      i_aux = filter_ch2(i_aux);
1319   3                      i_aux = (i_aux << 10) / g_mem.emg_max_value[1];
1320   3          
1321   3                      if (interrupt_flag){
1322   4                          interrupt_flag = FALSE;
1323   4                          interrupt_manager();
1324   4                      }
1325   3                      
1326   3                      if (i_aux < 0) 
1327   3                          i_aux = 0;
1328   3                      else
1329   3                          if (i_aux > 1024)
1330   3                              i_aux = 1024;
1331   3                      
1332   3                      g_meas.emg[1] = i_aux;
1333   3      
1334   3                      break;
1335   3      
1336   3                  case RESET: // reset variables
1337   3                      emg_counter_2 = 0;
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 23  

1338   3                      g_mem.emg_max_value[1] = 0;
1339   3          
1340   3                      if (interrupt_flag){
1341   4                          interrupt_flag = FALSE;
1342   4                          interrupt_manager();
1343   4                      }
1344   3                      
1345   3                      emg_2_status = WAIT; // wait for EMG 1 calibration
1346   3                      break;
1347   3      
1348   3                  case DISCARD: // discard first EMG_SAMPLE_TO_DISCARD samples
1349   3                      emg_counter_2++;
1350   3                      if (emg_counter_2 == EMG_SAMPLE_TO_DISCARD) {
1351   4                          emg_counter_2 = 0;          // reset counter
1352   4                          
1353   4                          LED_CTRL_Write(1);
1354   4                          LED_BLINK_EN_Write(0);
1355   4          
1356   4                          if (interrupt_flag){
1357   5                              interrupt_flag = FALSE;
1358   5                              interrupt_manager();
1359   5                          }
1360   4                          
1361   4                          emg_2_status = SUM_AND_MEAN;           // sum and mean status
1362   4                      }
1363   3                      break;
1364   3      
1365   3                  case SUM_AND_MEAN: // sum first SAMPLES_FOR_EMG_MEAN samples
1366   3                      // NOTE max(value)*SAMPLES_FOR_EMG_MEAN must fit in 32bit
1367   3                      emg_counter_2++;
1368   3                      if (ADC_buf[3 - g_mem.switch_emg] < 0)
1369   3                          ADC_buf[3 - g_mem.switch_emg] = 0;
1370   3                      g_mem.emg_max_value[1] += filter_ch2((int32)ADC_buf[3 - g_mem.switch_emg]);
1371   3          
1372   3                      if (interrupt_flag){
1373   4                          interrupt_flag = FALSE;
1374   4                          interrupt_manager();
1375   4                      }
1376   3                      
1377   3                      if (emg_counter_2 == SAMPLES_FOR_EMG_MEAN) {
1378   4                          g_mem.emg_max_value[1] = g_mem.emg_max_value[1] / SAMPLES_FOR_EMG_MEAN; // calc mean
1379   4                          
1380   4                          LED_CTRL_Write(0);
1381   4                          LED_BLINK_EN_Write(0);
1382   4                          
1383   4                          emg_counter_2 = 0;          // reset counter
1384   4                      
1385   4                          if (interrupt_flag){
1386   5                              interrupt_flag = FALSE;
1387   5                              interrupt_manager();
1388   5                          }
1389   4                          
1390   4                          emg_2_status = WAIT_EoC;           // goto end of calibration wait
1391   4                      }
1392   3                      break;
1393   3      
1394   3                  case WAIT: // wait for EMG calibration to be done
1395   3                      if (emg_1_status == NORMAL)
1396   3                          emg_2_status = DISCARD;           // goto discard sample
1397   3                      break;
1398   3      
1399   3                  case WAIT_EoC:  // wait for end of calibration procedure (only for LED visibility reasons)
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 24  

1400   3                      emg_counter_2++;
1401   3                      if (emg_counter_2 == EMG_SAMPLE_TO_DISCARD) {
1402   4                          emg_counter_2 = 0;          // reset counter
1403   4      
1404   4                          if (interrupt_flag){
1405   5                              interrupt_flag = FALSE;
1406   5                              interrupt_manager();
1407   5                          }
1408   4                          
1409   4                          // if EMG control mode active, activate motors accordingly with startup value
1410   4                          if ((c_mem.input_mode == INPUT_MODE_EMG_PROPORTIONAL) ||
1411   4                              (c_mem.input_mode == INPUT_MODE_EMG_INTEGRAL) ||
1412   4                              (c_mem.input_mode == INPUT_MODE_EMG_FCFS) ||
1413   4                              (c_mem.input_mode == INPUT_MODE_EMG_FCFS_ADV)) {
1414   5                              if (c_mem.control_mode == CONTROL_ANGLE) {
1415   6                                  g_ref.pos[0] = g_meas.pos[0];
1416   6                                  g_ref.pos[1] = g_meas.pos[1];
1417   6                              }
1418   5                              g_ref.onoff = c_mem.activ;
1419   5                              MOTOR_ON_OFF_Write(g_ref.onoff);
1420   5                          }
1421   4                              
1422   4                          emg_2_status = NORMAL;           // goto normal execution
1423   4                      }
1424   3                      break;
1425   3                      
1426   3                  default:
1427   3                      break;
1428   3              }
1429   2                  
1430   2              if (interrupt_flag){
1431   3                  interrupt_flag = FALSE;
1432   3                  interrupt_manager();
1433   3              }
1434   2          }
1435   1          else {
1436   2      
1437   2              emg_1_status = RESET; 
1438   2              emg_2_status = RESET;
1439   2      
1440   2              tension_valid = FALSE;
1441   2                      //fixed
1442   2              LED_CTRL_Write(1);
1443   2              //PWM Blink Enable
1444   2              LED_BLINK_EN_Write(0);
1445   2                  
1446   2              if (interrupt_flag){
1447   3                  interrupt_flag = FALSE;
1448   3                  interrupt_manager();
1449   3              }
1450   2              
1451   2              if (c_mem.emg_calibration_flag) {
1452   3                  if ((c_mem.input_mode == INPUT_MODE_EMG_PROPORTIONAL) ||
1453   3                      (c_mem.input_mode == INPUT_MODE_EMG_INTEGRAL) ||
1454   3                      (c_mem.input_mode == INPUT_MODE_EMG_FCFS) ||
1455   3                      (c_mem.input_mode == INPUT_MODE_EMG_FCFS_ADV)) {
1456   4                      g_ref.onoff = 0x00;
1457   4                      MOTOR_ON_OFF_Write(g_ref.onoff);
1458   4                  }
1459   3              }
1460   2      
1461   2              // Reset current
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 25  

1462   2              g_meas.curr[0] = 0;
1463   2      
1464   2              // Reset emg
1465   2              g_meas.emg[0] = 0;
1466   2              g_meas.emg[1] = 0;
1467   2      
1468   2          }
1469   1              // The board LED blinks if attached battery is not fully charged
1470   1          if (!first_tension_valid && tension_valid == TRUE && emg_1_status == NORMAL && emg_2_status == NORMAL)
             -{
1471   2              dev_tension_f = filter_voltage(dev_tension);
1472   2              if (dev_tension_f > 0.92 * pow_tension){        // Sometimes pow_tension is not well computed when
             - using power supply
1473   3                  //fixed
1474   3                  LED_CTRL_Write(1);
1475   3                  
1476   3                  //PWM Blink Enable
1477   3                  LED_BLINK_EN_Write(0);
1478   3              }
1479   2              else {
1480   3                  // blink
1481   3                  LED_CTRL_Write(0);
1482   3                  
1483   3                  //PWM Blink Enable
1484   3                  LED_BLINK_EN_Write(1);
1485   3                  
1486   3                  // Disable motors because of not fully charged battery
1487   3                //  g_refNew.onoff = 0x00;
1488   3                //  MOTOR_ON_OFF_Write(g_refNew.onoff); // Deactivate motors
1489   3              }
1490   2          }
1491   1              
1492   1          if (interrupt_flag){
1493   2              interrupt_flag = FALSE;
1494   2              interrupt_manager();
1495   2          }
1496   1      }
1497          
1498          //==============================================================================
1499          //                                                           OVERCURRENT CONTROL
1500          //==============================================================================
1501          
1502          void overcurrent_control() {
1503   1          if (c_mem.current_limit != 0) {
1504   2              // if the current is over the limit
1505   2              if (g_meas.curr[0] > c_mem.current_limit) {
1506   3                  //decrese pwm_limit
1507   3                  dev_pwm_limit--;
1508   3              // if the current is in the safe zone
1509   3              } else if (g_meas.curr[0] < (c_mem.current_limit - CURRENT_HYSTERESIS)) {
1510   3                  //increase pwm_limit
1511   3                  dev_pwm_limit++;
1512   3              }
1513   2      
1514   2              // Bound pwm_limit
1515   2              if (dev_pwm_limit < 0) 
1516   2                  dev_pwm_limit = 0;
1517   2              else 
1518   2                  if (dev_pwm_limit > dev_pwm_sat) 
1519   2                      dev_pwm_limit = dev_pwm_sat;
1520   2          }
1521   1      }
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 26  

1522          
1523          //==============================================================================
1524          //                                                              PWM_LIMIT_SEARCH
1525          //==============================================================================
1526          
1527           void pwm_limit_search() {
1528   1        
1529   1          uint8 CYDATA index;
1530   1          uint16 CYDATA max_tension = 25500;
1531   1          uint16 CYDATA min_tension = 11500;
1532   1           
1533   1          if (dev_tension > max_tension) {
1534   2                dev_pwm_sat = 0;
1535   2          } else if (dev_tension < min_tension) {
1536   2                dev_pwm_sat = 100;
1537   2          } else {
1538   2              index = (uint8)((dev_tension - min_tension) >> 9);
1539   2              dev_pwm_sat = pwm_preload_values[index];
1540   2          }
1541   1      }
1542          
1543          
1544          //==============================================================================
1545          //                                                         CYCLES COUNTER UPDATE
1546          //==============================================================================
1547          
1548          void cycles_counter_update() {
1549   1          static uint8 pos_cycle_status = STATE_INACTIVE;
1550   1          static uint8 emg_cycle_status[2] = {STATE_INACTIVE, STATE_INACTIVE};
1551   1          static uint8 rest_cycle_status = STATE_INACTIVE;
1552   1          static int32 bin_threshold = 250;
1553   1          static int32 thr_pos, max_pos;
1554   1          uint8 i, bin_st, bin_max;
1555   1          int32 curr_pos;
1556   1          int32 step;
1557   1          static uint32 timer_value_s, timer_value_e;
1558   1          
1559   1          curr_pos = (int32)(g_meas.pos[0] >> g_mem.res[0]);
1560   1          
1561   1          // State machine - Evaluate position counter update
1562   1          switch (pos_cycle_status){
1563   2              case STATE_INACTIVE:
1564   2                  if (pwm_sign == 1){
1565   3                      thr_pos = curr_pos; 
1566   3                      g_mem.wire_disp = g_mem.wire_disp + abs(max_pos - thr_pos);     //sum opening track
1567   3                      pos_cycle_status = STATE_ACTIVE;
1568   3                  }
1569   2                  break;
1570   2              case STATE_ACTIVE:
1571   2                  if (pwm_sign == -1){
1572   3                      max_pos = curr_pos;
1573   3                      g_mem.wire_disp = g_mem.wire_disp + abs(max_pos - thr_pos);     //sum closure track
1574   3                      pos_cycle_status = COUNTER_INC;
1575   3                  }
1576   2                  break;
1577   2              case COUNTER_INC:
1578   2                  if (abs(max_pos - thr_pos) > bin_threshold){
1579   3                      //update position histogram
1580   3                      step = ((int32)(g_mem.pos_lim_sup[0] >> g_mem.res[0]) / 10);
1581   3                      bin_st  = (uint8)(thr_pos/step);
1582   3                      bin_max = (uint8)(max_pos/step);
1583   3                      for (i=bin_st; i<= bin_max; i++){
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 27  

1584   4                          //position_hist counts how many times the SoftHand stays in bin while closing
1585   4                          g_mem.position_hist[i] = g_mem.position_hist[i] + 1;
1586   4                      }
1587   3                      
1588   3                      //update current histogram
1589   3                      step = ((int32)(g_mem.current_limit) / 4);
1590   3                      if (g_meas.curr[0] > g_mem.current_limit)
1591   3                          g_mem.current_hist[3] = g_mem.current_hist[3] + 1; 
1592   3                      else
1593   3                          g_mem.current_hist[(uint8)(g_meas.curr[0]/step)] = g_mem.current_hist[(uint8)(g_meas.c
             -urr[0]/step)] + 1;
1594   3                  }
1595   2                  pos_cycle_status = STATE_INACTIVE;
1596   2                  break;
1597   2          }
1598   1          
1599   1          // State machine - Evaluate EMG counter update
1600   1          for (i=0; i<2 && emg_1_status == NORMAL && emg_2_status == NORMAL; i++){
1601   2              switch (emg_cycle_status[i]){
1602   3                  case STATE_INACTIVE:
1603   3                      if (g_meas.emg[i] > g_mem.emg_threshold[i]){
1604   4                          emg_cycle_status[i] = STATE_ACTIVE;
1605   4                      }
1606   3                      break;
1607   3                  case STATE_ACTIVE:
1608   3                      if (g_meas.emg[i] < 10){
1609   4                          emg_cycle_status[i] = COUNTER_INC;
1610   4                      }
1611   3                      break;
1612   3                  case COUNTER_INC:
1613   3                      g_mem.emg_counter[i] = g_mem.emg_counter[i] + 1;
1614   3                      emg_cycle_status[i] = STATE_INACTIVE;
1615   3                      break;
1616   3              }
1617   2          }
1618   1          
1619   1          // State machine - Evaluate rest counter update
1620   1          switch (rest_cycle_status){
1621   2              case STATE_INACTIVE:
1622   2                  if (rest_enabled){
1623   3                      timer_value_s = (uint32)CYCLES_TIMER_ReadCounter();
1624   3                      rest_cycle_status = STATE_ACTIVE;
1625   3                  }
1626   2                  break;
1627   2              case STATE_ACTIVE:
1628   2                  if (!rest_enabled){
1629   3                      timer_value_e = (uint32)CYCLES_TIMER_ReadCounter();
1630   3                      if (timer_value_s < timer_value_e) {
1631   4                          timer_value_s = timer_value_s + (uint32)1200;
1632   4                      }
1633   3                      rest_cycle_status = COUNTER_INC;
1634   3                  }
1635   2                  break;
1636   2              case COUNTER_INC: 
1637   2                  g_mem.total_time_rest = g_mem.total_time_rest + (uint32)((timer_value_s - timer_value_e)/10);
1638   2                  g_mem.rest_counter = g_mem.rest_counter + 1;
1639   2                  rest_cycle_status = STATE_INACTIVE;
1640   2                  break;
1641   2          }
1642   1                  
1643   1          // This function writes rows [row_start, row_end] on EEPROM
1644   1          save_cycles_eeprom();
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 28  

1645   1      }
1646          
1647          //==============================================================================
1648          //                                                            SAVE CYCLES EEPROM
1649          //==============================================================================
1650          
1651          void save_cycles_eeprom() {
1652   1      
1653   1          cystatus status;
1654   1          static uint8 row_number;
1655   1          uint8 row_start = 11;
1656   1          uint8* addr_start   = &g_mem.emg_counter[0];    //Data at beginning of the row 11
1657   1          uint8* addr_start_c = &c_mem.emg_counter[0];
1658   1          uint8 row_end   = row_start + EEPROM_COUNTERS_ROWS - 1;
1659   1          static uint8* m_addr = NULL;
1660   1      
1661   1          // This part of code writes rows [row_start, row_end] on EEPROM    
1662   1          switch(cycles_status) {
1663   2              case PREPARE_DATA:
1664   2                  // Store data in c_mem structure to have consistent counters
1665   2                  memcpy( addr_start_c, addr_start, EEPROM_BYTES_ROW*EEPROM_COUNTERS_ROWS );            
1666   2                  m_addr = addr_start;
1667   2                  row_number = row_start;
1668   2                  cycles_status = WRITE_CYCLES;
1669   2                  break;
1670   2                  
1671   2              case WRITE_CYCLES:
1672   2                  EEPROM_UpdateTemperature();     //Check temperature of chip before writing
1673   2                  status = EEPROM_StartWrite((uint8*) m_addr, row_number);           
1674   2                  if(status == CYRET_STARTED || status == CYRET_SUCCESS) {
1675   3                      cycles_status = WAIT_QUERY;
1676   3                      can_write = FALSE;
1677   3                  }
1678   2                  break;
1679   2                  
1680   2              case WAIT_QUERY:
1681   2                  status = EEPROM_Query();
1682   2                  if(status == CYRET_SUCCESS) {
1683   3                      if (row_number < row_end) {
1684   4                          m_addr = m_addr + EEPROM_BYTES_ROW;
1685   4                          row_number = row_number + 1;
1686   4                          cycles_status = WRITE_CYCLES;
1687   4                      }
1688   3                      else {
1689   4                          cycles_status = WRITE_END;
1690   4                      }
1691   3                  }
1692   2                  break;
1693   2                 
1694   2              case WRITE_END:
1695   2                  can_write = TRUE;            
1696   2                  cycles_status = NONE;
1697   2                  
1698   2                  // Restore data saved in c_mem structure
1699   2                  memcpy( addr_start, addr_start_c, EEPROM_BYTES_ROW*EEPROM_COUNTERS_ROWS );
1700   2                  break;
1701   2                  
1702   2              case NONE:
1703   2                  break;
1704   2          }
1705   1      }
1706          /* [] END OF FILE */
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 29  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION ISR_WATCHDOG_Handler (BEGIN)
                                           ; SOURCE LINE # 133
                                           ; SOURCE LINE # 137
0000 D200        E     SETB    watchdog_flag
                                           ; SOURCE LINE # 139
0002 32                RETI    
             ; FUNCTION ISR_WATCHDOG_Handler (END)

             ; FUNCTION ISR_RS485_RX_ExInterrupt (BEGIN)
                                           ; SOURCE LINE # 145
                                           ; SOURCE LINE # 149
0000 D200        E     SETB    interrupt_flag
                                           ; SOURCE LINE # 151
0002 32                RETI    
             ; FUNCTION ISR_RS485_RX_ExInterrupt (END)

             ; FUNCTION ISR_CYCLES_Handler (BEGIN)
0000 C0E0              PUSH    ACC
0002 C083              PUSH    DPH
0004 C082              PUSH    DPL
0006 C085              PUSH    DPH1
0008 C084              PUSH    DPL1
000A C086              PUSH    DPS
000C 758600            MOV     DPS,#00H
000F C000        E     PUSH    ?C?XPAGE1SFR
0011 750000      E     MOV     ?C?XPAGE1SFR,#?C?XPAGE1RST
0014 C0D0              PUSH    PSW
0016 75D000            MOV     PSW,#00H
0019 C007              PUSH    AR7
                                           ; SOURCE LINE # 156
                                           ; SOURCE LINE # 160
001B D200        E     SETB    cycles_interrupt_flag
                                           ; SOURCE LINE # 162
001D 906568            MOV     DPTR,#06568H
0020 E0                MOVX    A,@DPTR
0021 FF                MOV     R7,A
                                           ; SOURCE LINE # 164
0022 D007              POP     AR7
0024 D0D0              POP     PSW
0026 D000        E     POP     ?C?XPAGE1SFR
0028 D086              POP     DPS
002A D084              POP     DPL1
002C D085              POP     DPH1
002E D082              POP     DPL
0030 D083              POP     DPH
0032 D0E0              POP     ACC
0034 32                RETI    
             ; FUNCTION ISR_CYCLES_Handler (END)

             ; FUNCTION interrupt_manager (BEGIN)
                                           ; SOURCE LINE # 181
                                           ; SOURCE LINE # 197
0000 E4                CLR     A
0001 F500        R     MOV     package_count,A
0003         ?C0004:
                                           ; SOURCE LINE # 203
0003 120000      E     LCALL   UART_RS485_GetRxBufferSize
0006 EF                MOV     A,R7
0007 7003              JNZ     $ + 5H
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 30  

0009 020000      R     LJMP    ?C0027
000C E500        R     MOV     A,package_count
000E C3                CLR     C
000F 9406              SUBB    A,#06H
0011 4003              JC      $ + 5H
0013 020000      R     LJMP    ?C0027
                                           ; SOURCE LINE # 207
0016 120000      E     LCALL   UART_RS485_GetChar
0019 8F00        R     MOV     rx_data,R7
                                           ; SOURCE LINE # 209
001B E500        R     MOV     A,state
001D 14                DEC     A
001E 6049              JZ      ?C0011
0020 14                DEC     A
0021 6060              JZ      ?C0015
0023 14                DEC     A
0024 7003              JNZ     $ + 5H
0026 020000      R     LJMP    ?C0022
0029 14                DEC     A
002A 7003              JNZ     $ + 5H
002C 020000      R     LJMP    ?C0025
002F 2404              ADD     A,#04H
0031 70D0              JNZ     ?C0004
                                           ; SOURCE LINE # 211
0033         ?C0007:
                                           ; SOURCE LINE # 213
0033 850000      R     MOV     rx_queue,rx_queue+01H
                                           ; SOURCE LINE # 214
0036 850000      R     MOV     rx_queue+01H,rx_queue+02H
                                           ; SOURCE LINE # 215
0039 850000      R     MOV     rx_queue+02H,rx_data
                                           ; SOURCE LINE # 218
003C E500        R     MOV     A,rx_queue+01H
003E B43A11            CJNE    A,#03AH,?C0008
0041 E500        R     MOV     A,rx_queue+02H
0043 B43A0C            CJNE    A,#03AH,?C0008
                                           ; SOURCE LINE # 219
0046 E4                CLR     A
0047 F500        R     MOV     rx_queue,A
                                           ; SOURCE LINE # 220
0049 F500        R     MOV     rx_queue+01H,A
                                           ; SOURCE LINE # 221
004B F500        R     MOV     rx_queue+02H,A
                                           ; SOURCE LINE # 222
004D 750001      R     MOV     state,#01H
                                           ; SOURCE LINE # 223
0050 80B1              SJMP    ?C0004
0052         ?C0008:
                                           ; SOURCE LINE # 224
0052 E500        R     MOV     A,rx_queue
0054 B43FAC            CJNE    A,#03FH,?C0004
0057 E500        R     MOV     A,rx_queue+01H
0059 B40DA7            CJNE    A,#0DH,?C0004
005C E500        R     MOV     A,rx_queue+02H
005E 640A              XRL     A,#0AH
0060 70A1              JNZ     ?C0004
                                           ; SOURCE LINE # 227
0062 FF                MOV     R7,A
0063 FE                MOV     R6,A
0064 120000      E     LCALL   _infoGet
                                           ; SOURCE LINE # 228
0067 809A              SJMP    ?C0004
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 31  

                                           ; SOURCE LINE # 231
0069         ?C0011:
                                           ; SOURCE LINE # 234
0069 900000      E     MOV     DPTR,#c_mem+01H
006C E0                MOVX    A,@DPTR
006D 6500        R     XRL     A,rx_data
006F 6004              JZ      ?C0013
0071 E500        R     MOV     A,rx_data
0073 7004              JNZ     ?C0012
0075         ?C0013:
                                           ; SOURCE LINE # 235
0075 C200        R     CLR     rx_data_type
0077 8002              SJMP    ?C0014
0079         ?C0012:
                                           ; SOURCE LINE # 237
0079 D200        R     SETB    rx_data_type
007B         ?C0014:
                                           ; SOURCE LINE # 239
007B E4                CLR     A
007C F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 240
007E 750002      R     MOV     state,#02H
                                           ; SOURCE LINE # 241
0081 8080              SJMP    ?C0004
                                           ; SOURCE LINE # 244
0083         ?C0015:
                                           ; SOURCE LINE # 247
0083 850000      R     MOV     data_packet_length,rx_data
                                           ; SOURCE LINE # 249
0086 E500        R     MOV     A,data_packet_length
0088 D3                SETB    C
0089 9401              SUBB    A,#01H
008B 5008              JNC     ?C0016
                                           ; SOURCE LINE # 250
008D E4                CLR     A
008E F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 251
0090 F500        R     MOV     state,A
                                           ; SOURCE LINE # 252
0092 020000      R     LJMP    ?C0004
0095         ?C0016:
0095 E500        R     MOV     A,data_packet_length
0097 D3                SETB    C
0098 9480              SUBB    A,#080H
009A 4008              JC      ?C0018
                                           ; SOURCE LINE # 253
009C E4                CLR     A
009D F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 254
009F F500        R     MOV     state,A
                                           ; SOURCE LINE # 255
00A1 020000      R     LJMP    ?C0004
00A4         ?C0018:
                                           ; SOURCE LINE # 256
00A4 E4                CLR     A
00A5 F500        R     MOV     data_packet_index,A
                                           ; SOURCE LINE # 258
00A7 200006            JB      rx_data_type,?C0020
                                           ; SOURCE LINE # 259
00AA 750003      R     MOV     state,#03H
00AD 020000      R     LJMP    ?C0004
00B0         ?C0020:
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 32  

                                           ; SOURCE LINE # 261
00B0 750004      R     MOV     state,#04H
                                           ; SOURCE LINE # 262
                                           ; SOURCE LINE # 263
00B3 020000      R     LJMP    ?C0004
                                           ; SOURCE LINE # 266
00B6         ?C0022:
                                           ; SOURCE LINE # 268
00B6 7400        R     MOV     A,#LOW data_packet_buffer
00B8 2500        R     ADD     A,data_packet_index
00BA F582              MOV     DPL,A
00BC E4                CLR     A
00BD 3400        R     ADDC    A,#HIGH data_packet_buffer
00BF F583              MOV     DPH,A
00C1 E500        R     MOV     A,rx_data
00C3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 269
00C4 0500        R     INC     data_packet_index
                                           ; SOURCE LINE # 272
00C6 E500        R     MOV     A,data_packet_index
00C8 C3                CLR     C
00C9 9500        R     SUBB    A,data_packet_length
00CB 5003              JNC     $ + 5H
00CD 020000      R     LJMP    ?C0004
                                           ; SOURCE LINE # 274
00D0 200025            JB      rx_data_type,?C0024
                                           ; SOURCE LINE # 276
00D3 AF00        R     MOV     R7,data_packet_length
00D5 7E00              MOV     R6,#00H
00D7 7800        E     MOV     R0,#LOW g_rx
00D9 7C00        E     MOV     R4,#HIGH g_rx
00DB 7D01              MOV     R5,#01H
00DD 7B01              MOV     R3,#01H
00DF 7A00        R     MOV     R2,#HIGH data_packet_buffer
00E1 7900        R     MOV     R1,#LOW data_packet_buffer
00E3 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 277
00E6 900000      E     MOV     DPTR,#g_rx+080H
00E9 E4                CLR     A
00EA F0                MOVX    @DPTR,A
00EB A3                INC     DPTR
00EC E500        R     MOV     A,data_packet_length
00EE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 278
00EF 900000      E     MOV     DPTR,#g_rx+084H
00F2 7401              MOV     A,#01H
00F4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 279
00F5 120000      E     LCALL   commProcess
                                           ; SOURCE LINE # 280
00F8         ?C0024:
                                           ; SOURCE LINE # 282
00F8 E4                CLR     A
00F9 F500        R     MOV     data_packet_index,A
                                           ; SOURCE LINE # 283
00FB F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 284
00FD F500        R     MOV     state,A
                                           ; SOURCE LINE # 285
00FF 0500        R     INC     package_count
                                           ; SOURCE LINE # 287
                                           ; SOURCE LINE # 288
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 33  

0101 020000      R     LJMP    ?C0004
                                           ; SOURCE LINE # 291
0104         ?C0025:
                                           ; SOURCE LINE # 292
0104 1500        R     DEC     data_packet_length
0106 E500        R     MOV     A,data_packet_length
0108 6003              JZ      $ + 5H
010A 020000      R     LJMP    ?C0004
                                           ; SOURCE LINE # 293
010D F500        R     MOV     data_packet_index,A
                                           ; SOURCE LINE # 294
010F F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 295
0111 7F01              MOV     R7,#01H
0113 120000      E     LCALL   _RS485_CTS_Write
                                           ; SOURCE LINE # 296
0116 E4                CLR     A
0117 FF                MOV     R7,A
0118 120000      E     LCALL   _RS485_CTS_Write
                                           ; SOURCE LINE # 297
011B E4                CLR     A
011C F500        R     MOV     state,A
                                           ; SOURCE LINE # 298
011E 0500        R     INC     package_count
                                           ; SOURCE LINE # 299
                                           ; SOURCE LINE # 300
0120 020000      R     LJMP    ?C0004
                                           ; SOURCE LINE # 301
                                           ; SOURCE LINE # 302
0123 020000      R     LJMP    ?C0004
                                           ; SOURCE LINE # 303
0126         ?C0027:
0126 22                RET     
             ; FUNCTION interrupt_manager (END)

             ; FUNCTION function_scheduler (BEGIN)
                                           ; SOURCE LINE # 312
                                           ; SOURCE LINE # 315
0000 C200        R     CLR     write_cycles
                                           ; SOURCE LINE # 316
0002 120000      E     LCALL   MY_TIMER_ReadCounter
0005 900000      E     MOV     DPTR,#timer_value0
0008 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 320
000B 7F01              MOV     R7,#01H
000D 120000      E     LCALL   _ADC_SOC_Write
                                           ; SOURCE LINE # 324
0010 300007            JNB     interrupt_flag,?C0028
                                           ; SOURCE LINE # 325
0013 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 326
0015 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 327
0018 D200        R     SETB    write_cycles
                                           ; SOURCE LINE # 328
001A         ?C0028:
                                           ; SOURCE LINE # 332
001A E4                CLR     A
001B FF                MOV     R7,A
001C 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 336
001F 300007            JNB     interrupt_flag,?C0029
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 34  

                                           ; SOURCE LINE # 337
0022 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 338
0024 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 339
0027 D200        R     SETB    write_cycles
                                           ; SOURCE LINE # 340
0029         ?C0029:
                                           ; SOURCE LINE # 342
0029 7F01              MOV     R7,#01H
002B 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 346
002E 300007            JNB     interrupt_flag,?C0030
                                           ; SOURCE LINE # 347
0031 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 348
0033 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 349
0036 D200        R     SETB    write_cycles
                                           ; SOURCE LINE # 350
0038         ?C0030:
                                           ; SOURCE LINE # 352
0038 7F02              MOV     R7,#02H
003A 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 356
003D 300007            JNB     interrupt_flag,?C0031
                                           ; SOURCE LINE # 357
0040 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 358
0042 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 359
0045 D200        R     SETB    write_cycles
                                           ; SOURCE LINE # 360
0047         ?C0031:
                                           ; SOURCE LINE # 364
0047 120000      R     LCALL   motor_control
                                           ; SOURCE LINE # 368
004A 300007            JNB     interrupt_flag,?C0032
                                           ; SOURCE LINE # 369
004D C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 370
004F 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 371
0052 D200        R     SETB    write_cycles
                                           ; SOURCE LINE # 372
0054         ?C0032:
                                           ; SOURCE LINE # 376
0054 120000      R     LCALL   analog_read_end
                                           ; SOURCE LINE # 378
0057 300007            JNB     interrupt_flag,?C0033
                                           ; SOURCE LINE # 379
005A C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 380
005C 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 381
005F D200        R     SETB    write_cycles
                                           ; SOURCE LINE # 382
0061         ?C0033:
                                           ; SOURCE LINE # 386
0061 120000      R     LCALL   overcurrent_control
                                           ; SOURCE LINE # 390
0064 300007            JNB     interrupt_flag,?C0034
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 35  

                                           ; SOURCE LINE # 391
0067 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 392
0069 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 393
006C D200        R     SETB    write_cycles
                                           ; SOURCE LINE # 394
006E         ?C0034:
                                           ; SOURCE LINE # 399
006E 900000      E     MOV     DPTR,#calib
0071 E0                MOVX    A,@DPTR
0072 B40124            CJNE    A,#01H,?C0035
                                           ; SOURCE LINE # 400
0075 900000      R     MOV     DPTR,#counter_calibration
0078 E0                MOVX    A,@DPTR
0079 7004              JNZ     ?C0308
007B A3                INC     DPTR
007C E0                MOVX    A,@DPTR
007D 640A              XRL     A,#0AH
007F         ?C0308:
007F 700A              JNZ     ?C0036
                                           ; SOURCE LINE # 401
0081 120000      E     LCALL   calibration
                                           ; SOURCE LINE # 402
0084 E4                CLR     A
0085 900000      R     MOV     DPTR,#counter_calibration
0088 F0                MOVX    @DPTR,A
0089 A3                INC     DPTR
008A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 403
008B         ?C0036:
                                           ; SOURCE LINE # 404
008B 900000      R     MOV     DPTR,#counter_calibration+01H
008E E0                MOVX    A,@DPTR
008F 04                INC     A
0090 F0                MOVX    @DPTR,A
0091 7006              JNZ     ?C0309
0093 900000      R     MOV     DPTR,#counter_calibration
0096 E0                MOVX    A,@DPTR
0097 04                INC     A
0098 F0                MOVX    @DPTR,A
0099         ?C0309:
                                           ; SOURCE LINE # 405
0099         ?C0035:
                                           ; SOURCE LINE # 409
0099 300007            JNB     interrupt_flag,?C0037
                                           ; SOURCE LINE # 410
009C C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 411
009E 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 412
00A1 D200        R     SETB    write_cycles
                                           ; SOURCE LINE # 413
00A3         ?C0037:
                                           ; SOURCE LINE # 418
00A3 900000      E     MOV     DPTR,#c_mem+0A6H
00A6 E0                MOVX    A,@DPTR
00A7 B4012E            CJNE    A,#01H,?C0038
                                           ; SOURCE LINE # 419
00AA 900000      R     MOV     DPTR,#counter_calibration
00AD E0                MOVX    A,@DPTR
00AE 7004              JNZ     ?C0310
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 36  

00B0 A3                INC     DPTR
00B1 E0                MOVX    A,@DPTR
00B2 640A              XRL     A,#0AH
00B4         ?C0310:
00B4 700A              JNZ     ?C0039
                                           ; SOURCE LINE # 420
00B6 120000      E     LCALL   check_rest_position
                                           ; SOURCE LINE # 421
00B9 E4                CLR     A
00BA 900000      R     MOV     DPTR,#counter_calibration
00BD F0                MOVX    @DPTR,A
00BE A3                INC     DPTR
00BF F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 422
00C0         ?C0039:
                                           ; SOURCE LINE # 423
00C0 900000      R     MOV     DPTR,#counter_calibration+01H
00C3 E0                MOVX    A,@DPTR
00C4 04                INC     A
00C5 F0                MOVX    @DPTR,A
00C6 7006              JNZ     ?C0311
00C8 900000      R     MOV     DPTR,#counter_calibration
00CB E0                MOVX    A,@DPTR
00CC 04                INC     A
00CD F0                MOVX    @DPTR,A
00CE         ?C0311:
                                           ; SOURCE LINE # 426
00CE 300007            JNB     interrupt_flag,?C0038
                                           ; SOURCE LINE # 427
00D1 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 428
00D3 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 429
00D6 D200        R     SETB    write_cycles
                                           ; SOURCE LINE # 430
                                           ; SOURCE LINE # 431
00D8         ?C0038:
                                           ; SOURCE LINE # 435
00D8 120000      R     LCALL   cycles_counter_update
                                           ; SOURCE LINE # 439
00DB 300027            JNB     cycles_interrupt_flag,?C0041
                                           ; SOURCE LINE # 440
00DE C200        E     CLR     cycles_interrupt_flag
                                           ; SOURCE LINE # 444
00E0 300022            JNB     can_write,?C0041
                                           ; SOURCE LINE # 445
00E3 E4                CLR     A
00E4 F500        E     MOV     cycles_status,A
                                           ; SOURCE LINE # 448
00E6 900000      E     MOV     DPTR,#g_mem+0F8H
00E9 E0                MOVX    A,@DPTR
00EA FC                MOV     R4,A
00EB A3                INC     DPTR
00EC E0                MOVX    A,@DPTR
00ED FD                MOV     R5,A
00EE A3                INC     DPTR
00EF E0                MOVX    A,@DPTR
00F0 FE                MOV     R6,A
00F1 A3                INC     DPTR
00F2 E0                MOVX    A,@DPTR
00F3 2478              ADD     A,#078H
00F5 FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 37  

00F6 E4                CLR     A
00F7 3E                ADDC    A,R6
00F8 FE                MOV     R6,A
00F9 E4                CLR     A
00FA 3D                ADDC    A,R5
00FB FD                MOV     R5,A
00FC E4                CLR     A
00FD 3C                ADDC    A,R4
00FE FC                MOV     R4,A
00FF 900000      E     MOV     DPTR,#g_mem+0F8H
0102 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 449
                                           ; SOURCE LINE # 450
0105         ?C0041:
                                           ; SOURCE LINE # 454
0105 300005            JNB     interrupt_flag,?C0043
                                           ; SOURCE LINE # 455
0108 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 456
010A 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 457
010D         ?C0043:
                                           ; SOURCE LINE # 462
010D 7800        E     MOV     R0,#LOW g_measOld
010F 7C00        E     MOV     R4,#HIGH g_measOld
0111 7D01              MOV     R5,#01H
0113 7B01              MOV     R3,#01H
0115 7A00        E     MOV     R2,#HIGH g_meas
0117 7900        E     MOV     R1,#LOW g_meas
0119 7E00              MOV     R6,#00H
011B 7F37              MOV     R7,#037H
011D 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 463
0120 7800        E     MOV     R0,#LOW g_refOld
0122 7C00        E     MOV     R4,#HIGH g_refOld
0124 7D01              MOV     R5,#01H
0126 7B01              MOV     R3,#01H
0128 7A00        E     MOV     R2,#HIGH g_ref
012A 7900        E     MOV     R1,#LOW g_ref
012C 7E00              MOV     R6,#00H
012E 7F1D              MOV     R7,#01DH
0130 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 466
0133 7800        E     MOV     R0,#LOW g_ref
0135 7C00        E     MOV     R4,#HIGH g_ref
0137 7D01              MOV     R5,#01H
0139 7B01              MOV     R3,#01H
013B 7A00        E     MOV     R2,#HIGH g_refNew
013D 7900        E     MOV     R1,#LOW g_refNew
013F 7E00              MOV     R6,#00H
0141 7F1D              MOV     R7,#01DH
0143 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 468
0146 300007            JNB     interrupt_flag,?C0044
                                           ; SOURCE LINE # 469
0149 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 470
014B 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 471
014E D200        R     SETB    write_cycles
                                           ; SOURCE LINE # 472
0150         ?C0044:
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 38  

                                           ; SOURCE LINE # 474
0150 120000      E     LCALL   MY_TIMER_ReadCounter
0153 900000      E     MOV     DPTR,#timer_value
0156 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 475
0159 900000      E     MOV     DPTR,#timer_value
015C E0                MOVX    A,@DPTR
015D F8                MOV     R0,A
015E A3                INC     DPTR
015F E0                MOVX    A,@DPTR
0160 F9                MOV     R1,A
0161 A3                INC     DPTR
0162 E0                MOVX    A,@DPTR
0163 FA                MOV     R2,A
0164 A3                INC     DPTR
0165 E0                MOVX    A,@DPTR
0166 FB                MOV     R3,A
0167 900000      E     MOV     DPTR,#timer_value0
016A E0                MOVX    A,@DPTR
016B FC                MOV     R4,A
016C A3                INC     DPTR
016D E0                MOVX    A,@DPTR
016E FD                MOV     R5,A
016F A3                INC     DPTR
0170 E0                MOVX    A,@DPTR
0171 FE                MOV     R6,A
0172 A3                INC     DPTR
0173 E0                MOVX    A,@DPTR
0174 C3                CLR     C
0175 9B                SUBB    A,R3
0176 FF                MOV     R7,A
0177 EE                MOV     A,R6
0178 9A                SUBB    A,R2
0179 FE                MOV     R6,A
017A ED                MOV     A,R5
017B 99                SUBB    A,R1
017C FD                MOV     R5,A
017D EC                MOV     A,R4
017E 98                SUBB    A,R0
017F FC                MOV     R4,A
0180 E4                CLR     A
0181 120000      E     LCALL   ?C?FCASTL
0184 7B00              MOV     R3,#00H
0186 7A24              MOV     R2,#024H
0188 7974              MOV     R1,#074H
018A 7849              MOV     R0,#049H
018C 120000      E     LCALL   ?C?FPDIV
018F 900000      E     MOV     DPTR,#cycle_time
0192 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 476
0195 7F40              MOV     R7,#040H
0197 7E4B              MOV     R6,#04BH
0199 7D4C              MOV     R5,#04CH
019B 7C00              MOV     R4,#00H
019D 120000      E     LCALL   _MY_TIMER_WriteCounter
                                           ; SOURCE LINE # 478
01A0 22                RET     
             ; FUNCTION function_scheduler (END)

             ; FUNCTION motor_control (BEGIN)
                                           ; SOURCE LINE # 484
                                           ; SOURCE LINE # 486
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 39  

0000 E4                CLR     A
0001 F500        R     MOV     pwm_input+03H,A
0003 F500        R     MOV     pwm_input+02H,A
0005 F500        R     MOV     pwm_input+01H,A
0007 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 496
0009 900000      E     MOV     DPTR,#c_mem+02H
000C E0                MOVX    A,@DPTR
000D FC                MOV     R4,A
000E A3                INC     DPTR
000F E0                MOVX    A,@DPTR
0010 FD                MOV     R5,A
0011 A3                INC     DPTR
0012 E0                MOVX    A,@DPTR
0013 FE                MOV     R6,A
0014 A3                INC     DPTR
0015 E0                MOVX    A,@DPTR
0016 F500        R     MOV     k_p+03H,A
0018 8E00        R     MOV     k_p+02H,R6
001A 8D00        R     MOV     k_p+01H,R5
001C 8C00        R     MOV     k_p,R4
                                           ; SOURCE LINE # 497
001E A3                INC     DPTR
001F E0                MOVX    A,@DPTR
0020 FC                MOV     R4,A
0021 A3                INC     DPTR
0022 E0                MOVX    A,@DPTR
0023 FD                MOV     R5,A
0024 A3                INC     DPTR
0025 E0                MOVX    A,@DPTR
0026 FE                MOV     R6,A
0027 A3                INC     DPTR
0028 E0                MOVX    A,@DPTR
0029 F500        R     MOV     k_i+03H,A
002B 8E00        R     MOV     k_i+02H,R6
002D 8D00        R     MOV     k_i+01H,R5
002F 8C00        R     MOV     k_i,R4
                                           ; SOURCE LINE # 498
0031 A3                INC     DPTR
0032 E0                MOVX    A,@DPTR
0033 FC                MOV     R4,A
0034 A3                INC     DPTR
0035 E0                MOVX    A,@DPTR
0036 FD                MOV     R5,A
0037 A3                INC     DPTR
0038 E0                MOVX    A,@DPTR
0039 FE                MOV     R6,A
003A A3                INC     DPTR
003B E0                MOVX    A,@DPTR
003C F500        R     MOV     k_d+03H,A
003E 8E00        R     MOV     k_d+02H,R6
0040 8D00        R     MOV     k_d+01H,R5
0042 8C00        R     MOV     k_d,R4
                                           ; SOURCE LINE # 500
0044 A3                INC     DPTR
0045 E0                MOVX    A,@DPTR
0046 FC                MOV     R4,A
0047 A3                INC     DPTR
0048 E0                MOVX    A,@DPTR
0049 FD                MOV     R5,A
004A A3                INC     DPTR
004B E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 40  

004C FE                MOV     R6,A
004D A3                INC     DPTR
004E E0                MOVX    A,@DPTR
004F F500        R     MOV     k_p_c+03H,A
0051 8E00        R     MOV     k_p_c+02H,R6
0053 8D00        R     MOV     k_p_c+01H,R5
0055 8C00        R     MOV     k_p_c,R4
                                           ; SOURCE LINE # 501
0057 A3                INC     DPTR
0058 E0                MOVX    A,@DPTR
0059 FC                MOV     R4,A
005A A3                INC     DPTR
005B E0                MOVX    A,@DPTR
005C FD                MOV     R5,A
005D A3                INC     DPTR
005E E0                MOVX    A,@DPTR
005F FE                MOV     R6,A
0060 A3                INC     DPTR
0061 E0                MOVX    A,@DPTR
0062 F500        R     MOV     k_i_c+03H,A
0064 8E00        R     MOV     k_i_c+02H,R6
0066 8D00        R     MOV     k_i_c+01H,R5
0068 8C00        R     MOV     k_i_c,R4
                                           ; SOURCE LINE # 502
006A A3                INC     DPTR
006B E0                MOVX    A,@DPTR
006C FC                MOV     R4,A
006D A3                INC     DPTR
006E E0                MOVX    A,@DPTR
006F FD                MOV     R5,A
0070 A3                INC     DPTR
0071 E0                MOVX    A,@DPTR
0072 FE                MOV     R6,A
0073 A3                INC     DPTR
0074 E0                MOVX    A,@DPTR
0075 F500        R     MOV     k_d_c+03H,A
0077 8E00        R     MOV     k_d_c+02H,R6
0079 8D00        R     MOV     k_d_c+01H,R5
007B 8C00        R     MOV     k_d_c,R4
                                           ; SOURCE LINE # 504
007D A3                INC     DPTR
007E E0                MOVX    A,@DPTR
007F FC                MOV     R4,A
0080 A3                INC     DPTR
0081 E0                MOVX    A,@DPTR
0082 FD                MOV     R5,A
0083 A3                INC     DPTR
0084 E0                MOVX    A,@DPTR
0085 FE                MOV     R6,A
0086 A3                INC     DPTR
0087 E0                MOVX    A,@DPTR
0088 F500        R     MOV     k_p_dl+03H,A
008A 8E00        R     MOV     k_p_dl+02H,R6
008C 8D00        R     MOV     k_p_dl+01H,R5
008E 8C00        R     MOV     k_p_dl,R4
                                           ; SOURCE LINE # 505
0090 A3                INC     DPTR
0091 E0                MOVX    A,@DPTR
0092 FC                MOV     R4,A
0093 A3                INC     DPTR
0094 E0                MOVX    A,@DPTR
0095 FD                MOV     R5,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 41  

0096 A3                INC     DPTR
0097 E0                MOVX    A,@DPTR
0098 FE                MOV     R6,A
0099 A3                INC     DPTR
009A E0                MOVX    A,@DPTR
009B F500        R     MOV     k_i_dl+03H,A
009D 8E00        R     MOV     k_i_dl+02H,R6
009F 8D00        R     MOV     k_i_dl+01H,R5
00A1 8C00        R     MOV     k_i_dl,R4
                                           ; SOURCE LINE # 506
00A3 A3                INC     DPTR
00A4 E0                MOVX    A,@DPTR
00A5 FC                MOV     R4,A
00A6 A3                INC     DPTR
00A7 E0                MOVX    A,@DPTR
00A8 FD                MOV     R5,A
00A9 A3                INC     DPTR
00AA E0                MOVX    A,@DPTR
00AB FE                MOV     R6,A
00AC A3                INC     DPTR
00AD E0                MOVX    A,@DPTR
00AE F500        R     MOV     k_d_dl+03H,A
00B0 8E00        R     MOV     k_d_dl+02H,R6
00B2 8D00        R     MOV     k_d_dl+01H,R5
00B4 8C00        R     MOV     k_d_dl,R4
                                           ; SOURCE LINE # 507
00B6 900000      E     MOV     DPTR,#c_mem+069H
00B9 E0                MOVX    A,@DPTR
00BA FE                MOV     R6,A
00BB A3                INC     DPTR
00BC E0                MOVX    A,@DPTR
00BD FF                MOV     R7,A
00BE EE                MOV     A,R6
00BF 33                RLC     A
00C0 95E0              SUBB    A,ACC
00C2 FD                MOV     R5,A
00C3 FC                MOV     R4,A
00C4 780D              MOV     R0,#0DH
00C6 120000      E     LCALL   ?C?LSHL
00C9 AB00        R     MOV     R3,k_p_dl+03H
00CB AA00        R     MOV     R2,k_p_dl+02H
00CD A900        R     MOV     R1,k_p_dl+01H
00CF A800        R     MOV     R0,k_p_dl
00D1 120000      E     LCALL   ?C?SLDIV
00D4 8F00        R     MOV     pos_error_max+03H,R7
00D6 8E00        R     MOV     pos_error_max+02H,R6
00D8 8D00        R     MOV     pos_error_max+01H,R5
00DA 8C00        R     MOV     pos_error_max,R4
                                           ; SOURCE LINE # 509
00DC 900000      E     MOV     DPTR,#c_mem+026H
00DF E0                MOVX    A,@DPTR
00E0 FC                MOV     R4,A
00E1 A3                INC     DPTR
00E2 E0                MOVX    A,@DPTR
00E3 FD                MOV     R5,A
00E4 A3                INC     DPTR
00E5 E0                MOVX    A,@DPTR
00E6 FE                MOV     R6,A
00E7 A3                INC     DPTR
00E8 E0                MOVX    A,@DPTR
00E9 F500        R     MOV     k_p_c_dl+03H,A
00EB 8E00        R     MOV     k_p_c_dl+02H,R6
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 42  

00ED 8D00        R     MOV     k_p_c_dl+01H,R5
00EF 8C00        R     MOV     k_p_c_dl,R4
                                           ; SOURCE LINE # 510
00F1 A3                INC     DPTR
00F2 E0                MOVX    A,@DPTR
00F3 FC                MOV     R4,A
00F4 A3                INC     DPTR
00F5 E0                MOVX    A,@DPTR
00F6 FD                MOV     R5,A
00F7 A3                INC     DPTR
00F8 E0                MOVX    A,@DPTR
00F9 FE                MOV     R6,A
00FA A3                INC     DPTR
00FB E0                MOVX    A,@DPTR
00FC F500        R     MOV     k_i_c_dl+03H,A
00FE 8E00        R     MOV     k_i_c_dl+02H,R6
0100 8D00        R     MOV     k_i_c_dl+01H,R5
0102 8C00        R     MOV     k_i_c_dl,R4
                                           ; SOURCE LINE # 511
0104 A3                INC     DPTR
0105 E0                MOVX    A,@DPTR
0106 FC                MOV     R4,A
0107 A3                INC     DPTR
0108 E0                MOVX    A,@DPTR
0109 FD                MOV     R5,A
010A A3                INC     DPTR
010B E0                MOVX    A,@DPTR
010C FE                MOV     R6,A
010D A3                INC     DPTR
010E E0                MOVX    A,@DPTR
010F F500        R     MOV     k_d_c_dl+03H,A
0111 8E00        R     MOV     k_d_c_dl+02H,R6
0113 8D00        R     MOV     k_d_c_dl+01H,R5
0115 8C00        R     MOV     k_d_c_dl,R4
                                           ; SOURCE LINE # 528
0117 900000      E     MOV     DPTR,#c_mem+06BH
011A E0                MOVX    A,@DPTR
011B FE                MOV     R6,A
011C A3                INC     DPTR
011D E0                MOVX    A,@DPTR
011E FF                MOV     R7,A
011F FB                MOV     R3,A
0120 AA06              MOV     R2,AR6
0122 E4                CLR     A
0123 900000      E     MOV     DPTR,#g_meas+017H
0126 E0                MOVX    A,@DPTR
0127 FC                MOV     R4,A
0128 A3                INC     DPTR
0129 E0                MOVX    A,@DPTR
012A FD                MOV     R5,A
012B A3                INC     DPTR
012C E0                MOVX    A,@DPTR
012D FE                MOV     R6,A
012E A3                INC     DPTR
012F E0                MOVX    A,@DPTR
0130 C3                CLR     C
0131 9B                SUBB    A,R3
0132 F500        R     MOV     err_emg_1+03H,A
0134 EE                MOV     A,R6
0135 9A                SUBB    A,R2
0136 F500        R     MOV     err_emg_1+02H,A
0138 ED                MOV     A,R5
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 43  

0139 9400              SUBB    A,#00H
013B F500        R     MOV     err_emg_1+01H,A
013D EC                MOV     A,R4
013E 9400              SUBB    A,#00H
0140 F500        R     MOV     err_emg_1,A
                                           ; SOURCE LINE # 529
0142 900000      E     MOV     DPTR,#c_mem+06DH
0145 E0                MOVX    A,@DPTR
0146 FE                MOV     R6,A
0147 A3                INC     DPTR
0148 E0                MOVX    A,@DPTR
0149 FF                MOV     R7,A
014A FB                MOV     R3,A
014B AA06              MOV     R2,AR6
014D E4                CLR     A
014E 900000      E     MOV     DPTR,#g_meas+01BH
0151 E0                MOVX    A,@DPTR
0152 FC                MOV     R4,A
0153 A3                INC     DPTR
0154 E0                MOVX    A,@DPTR
0155 FD                MOV     R5,A
0156 A3                INC     DPTR
0157 E0                MOVX    A,@DPTR
0158 FE                MOV     R6,A
0159 A3                INC     DPTR
015A E0                MOVX    A,@DPTR
015B C3                CLR     C
015C 9B                SUBB    A,R3
015D F500        R     MOV     err_emg_2+03H,A
015F EE                MOV     A,R6
0160 9A                SUBB    A,R2
0161 F500        R     MOV     err_emg_2+02H,A
0163 ED                MOV     A,R5
0164 9400              SUBB    A,#00H
0166 F500        R     MOV     err_emg_2+01H,A
0168 EC                MOV     A,R4
0169 9400              SUBB    A,#00H
016B F500        R     MOV     err_emg_2,A
                                           ; SOURCE LINE # 532
016D 900000      E     MOV     DPTR,#c_mem+033H
0170 E0                MOVX    A,@DPTR
0171 24FE              ADD     A,#0FEH
0173 7003              JNZ     $ + 5H
0175 020000      R     LJMP    ?C0054
0178 14                DEC     A
0179 7003              JNZ     $ + 5H
017B 020000      R     LJMP    ?C0057
017E 14                DEC     A
017F 7003              JNZ     $ + 5H
0181 020000      R     LJMP    ?C0060
0184 14                DEC     A
0185 7003              JNZ     $ + 5H
0187 020000      R     LJMP    ?C0070
018A 2404              ADD     A,#04H
018C 6003              JZ      $ + 5H
018E 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 534
0191         ?C0047:
                                           ; SOURCE LINE # 538
0191 900000      E     MOV     DPTR,#c_mem+079H
0194 E0                MOVX    A,@DPTR
0195 6024              JZ      ?C0048
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 44  

                                           ; SOURCE LINE # 539
0197 A3                INC     DPTR
0198 E0                MOVX    A,@DPTR
0199 FF                MOV     R7,A
019A 33                RLC     A
019B 95E0              SUBB    A,ACC
019D FE                MOV     R6,A
019E FD                MOV     R5,A
019F FC                MOV     R4,A
01A0 900000      E     MOV     DPTR,#g_meas+08H
01A3 E0                MOVX    A,@DPTR
01A4 F8                MOV     R0,A
01A5 A3                INC     DPTR
01A6 E0                MOVX    A,@DPTR
01A7 F9                MOV     R1,A
01A8 A3                INC     DPTR
01A9 E0                MOVX    A,@DPTR
01AA FA                MOV     R2,A
01AB A3                INC     DPTR
01AC E0                MOVX    A,@DPTR
01AD FB                MOV     R3,A
01AE 120000      E     LCALL   ?C?LMUL
01B1 8F00        R     MOV     handle_value+03H,R7
01B3 8E00        R     MOV     handle_value+02H,R6
01B5 8D00        R     MOV     handle_value+01H,R5
01B7 8C00        R     MOV     handle_value,R4
01B9 8024              SJMP    ?C0049
01BB         ?C0048:
                                           ; SOURCE LINE # 541
01BB 900000      E     MOV     DPTR,#c_mem+07AH
01BE E0                MOVX    A,@DPTR
01BF FF                MOV     R7,A
01C0 33                RLC     A
01C1 95E0              SUBB    A,ACC
01C3 FE                MOV     R6,A
01C4 FD                MOV     R5,A
01C5 FC                MOV     R4,A
01C6 900000      E     MOV     DPTR,#g_meas+04H
01C9 E0                MOVX    A,@DPTR
01CA F8                MOV     R0,A
01CB A3                INC     DPTR
01CC E0                MOVX    A,@DPTR
01CD F9                MOV     R1,A
01CE A3                INC     DPTR
01CF E0                MOVX    A,@DPTR
01D0 FA                MOV     R2,A
01D1 A3                INC     DPTR
01D2 E0                MOVX    A,@DPTR
01D3 FB                MOV     R3,A
01D4 120000      E     LCALL   ?C?LMUL
01D7 8F00        R     MOV     handle_value+03H,R7
01D9 8E00        R     MOV     handle_value+02H,R6
01DB 8D00        R     MOV     handle_value+01H,R5
01DD 8C00        R     MOV     handle_value,R4
01DF         ?C0049:
                                           ; SOURCE LINE # 545
01DF 900000      E     MOV     DPTR,#g_ref
01E2 E0                MOVX    A,@DPTR
01E3 F8                MOV     R0,A
01E4 A3                INC     DPTR
01E5 E0                MOVX    A,@DPTR
01E6 F9                MOV     R1,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 45  

01E7 A3                INC     DPTR
01E8 E0                MOVX    A,@DPTR
01E9 FA                MOV     R2,A
01EA A3                INC     DPTR
01EB E0                MOVX    A,@DPTR
01EC FB                MOV     R3,A
01ED C3                CLR     C
01EE E500        R     MOV     A,handle_value+03H
01F0 9B                SUBB    A,R3
01F1 FF                MOV     R7,A
01F2 E500        R     MOV     A,handle_value+02H
01F4 9A                SUBB    A,R2
01F5 FE                MOV     R6,A
01F6 E500        R     MOV     A,handle_value+01H
01F8 99                SUBB    A,R1
01F9 FD                MOV     R5,A
01FA E500        R     MOV     A,handle_value
01FC 98                SUBB    A,R0
01FD FC                MOV     R4,A
01FE 900000      E     MOV     DPTR,#c_mem+061H
0201 E0                MOVX    A,@DPTR
0202 F8                MOV     R0,A
0203 A3                INC     DPTR
0204 E0                MOVX    A,@DPTR
0205 F9                MOV     R1,A
0206 A3                INC     DPTR
0207 E0                MOVX    A,@DPTR
0208 FA                MOV     R2,A
0209 A3                INC     DPTR
020A E0                MOVX    A,@DPTR
020B FB                MOV     R3,A
020C C3                CLR     C
020D 120000      E     LCALL   ?C?SLCMP
0210 5044              JNC     ?C0050
0212 E4                CLR     A
0213 FF                MOV     R7,A
0214 FE                MOV     R6,A
0215 FD                MOV     R5,A
0216 FC                MOV     R4,A
0217 900000      E     MOV     DPTR,#c_mem+061H
021A E0                MOVX    A,@DPTR
021B F8                MOV     R0,A
021C A3                INC     DPTR
021D E0                MOVX    A,@DPTR
021E A3                INC     DPTR
021F E0                MOVX    A,@DPTR
0220 A3                INC     DPTR
0221 E0                MOVX    A,@DPTR
0222 C3                CLR     C
0223 120000      E     LCALL   ?C?SLCMP
0226 602E              JZ      ?C0050
                                           ; SOURCE LINE # 546
0228 900000      E     MOV     DPTR,#g_ref
022B E0                MOVX    A,@DPTR
022C FC                MOV     R4,A
022D A3                INC     DPTR
022E E0                MOVX    A,@DPTR
022F FD                MOV     R5,A
0230 A3                INC     DPTR
0231 E0                MOVX    A,@DPTR
0232 FE                MOV     R6,A
0233 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 46  

0234 E0                MOVX    A,@DPTR
0235 FF                MOV     R7,A
0236 900000      E     MOV     DPTR,#c_mem+061H
0239 E0                MOVX    A,@DPTR
023A F8                MOV     R0,A
023B A3                INC     DPTR
023C E0                MOVX    A,@DPTR
023D A3                INC     DPTR
023E E0                MOVX    A,@DPTR
023F A3                INC     DPTR
0240 E0                MOVX    A,@DPTR
0241 EF                MOV     A,R7
0242 2B                ADD     A,R3
0243 FF                MOV     R7,A
0244 EE                MOV     A,R6
0245 3A                ADDC    A,R2
0246 FE                MOV     R6,A
0247 ED                MOV     A,R5
0248 39                ADDC    A,R1
0249 FD                MOV     R5,A
024A EC                MOV     A,R4
024B 38                ADDC    A,R0
024C FC                MOV     R4,A
024D 900000      E     MOV     DPTR,#g_ref
0250 120000      E     LCALL   ?C?LSTXDATA
0253 020000      R     LJMP    ?C0046
0256         ?C0050:
                                           ; SOURCE LINE # 547
                                           ; SOURCE LINE # 548
0256 900000      E     MOV     DPTR,#g_ref
0259 E0                MOVX    A,@DPTR
025A F8                MOV     R0,A
025B A3                INC     DPTR
025C E0                MOVX    A,@DPTR
025D F9                MOV     R1,A
025E A3                INC     DPTR
025F E0                MOVX    A,@DPTR
0260 FA                MOV     R2,A
0261 A3                INC     DPTR
0262 E0                MOVX    A,@DPTR
0263 FB                MOV     R3,A
0264 C3                CLR     C
0265 E500        R     MOV     A,handle_value+03H
0267 9B                SUBB    A,R3
0268 FF                MOV     R7,A
0269 E500        R     MOV     A,handle_value+02H
026B 9A                SUBB    A,R2
026C FE                MOV     R6,A
026D E500        R     MOV     A,handle_value+01H
026F 99                SUBB    A,R1
0270 FD                MOV     R5,A
0271 E500        R     MOV     A,handle_value
0273 98                SUBB    A,R0
0274 FC                MOV     R4,A
0275 900000      E     MOV     DPTR,#c_mem+065H
0278 E0                MOVX    A,@DPTR
0279 F8                MOV     R0,A
027A A3                INC     DPTR
027B E0                MOVX    A,@DPTR
027C F9                MOV     R1,A
027D A3                INC     DPTR
027E E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 47  

027F FA                MOV     R2,A
0280 A3                INC     DPTR
0281 E0                MOVX    A,@DPTR
0282 FB                MOV     R3,A
0283 D3                SETB    C
0284 120000      E     LCALL   ?C?SLCMP
0287 4043              JC      ?C0052
0289 E4                CLR     A
028A FF                MOV     R7,A
028B FE                MOV     R6,A
028C FD                MOV     R5,A
028D FC                MOV     R4,A
028E 900000      E     MOV     DPTR,#c_mem+065H
0291 E0                MOVX    A,@DPTR
0292 F8                MOV     R0,A
0293 A3                INC     DPTR
0294 E0                MOVX    A,@DPTR
0295 A3                INC     DPTR
0296 E0                MOVX    A,@DPTR
0297 A3                INC     DPTR
0298 E0                MOVX    A,@DPTR
0299 120000      E     LCALL   ?C?SLCMP
029C 602E              JZ      ?C0052
                                           ; SOURCE LINE # 549
029E 900000      E     MOV     DPTR,#g_ref
02A1 E0                MOVX    A,@DPTR
02A2 FC                MOV     R4,A
02A3 A3                INC     DPTR
02A4 E0                MOVX    A,@DPTR
02A5 FD                MOV     R5,A
02A6 A3                INC     DPTR
02A7 E0                MOVX    A,@DPTR
02A8 FE                MOV     R6,A
02A9 A3                INC     DPTR
02AA E0                MOVX    A,@DPTR
02AB FF                MOV     R7,A
02AC 900000      E     MOV     DPTR,#c_mem+065H
02AF E0                MOVX    A,@DPTR
02B0 F8                MOV     R0,A
02B1 A3                INC     DPTR
02B2 E0                MOVX    A,@DPTR
02B3 A3                INC     DPTR
02B4 E0                MOVX    A,@DPTR
02B5 A3                INC     DPTR
02B6 E0                MOVX    A,@DPTR
02B7 EF                MOV     A,R7
02B8 2B                ADD     A,R3
02B9 FF                MOV     R7,A
02BA EE                MOV     A,R6
02BB 3A                ADDC    A,R2
02BC FE                MOV     R6,A
02BD ED                MOV     A,R5
02BE 39                ADDC    A,R1
02BF FD                MOV     R5,A
02C0 EC                MOV     A,R4
02C1 38                ADDC    A,R0
02C2 FC                MOV     R4,A
02C3 900000      E     MOV     DPTR,#g_ref
02C6 120000      E     LCALL   ?C?LSTXDATA
02C9 020000      R     LJMP    ?C0046
02CC         ?C0052:
                                           ; SOURCE LINE # 551
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 48  

02CC AF00        R     MOV     R7,handle_value+03H
02CE AE00        R     MOV     R6,handle_value+02H
02D0 AD00        R     MOV     R5,handle_value+01H
02D2 AC00        R     MOV     R4,handle_value
02D4 900000      E     MOV     DPTR,#g_ref
02D7 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 552
                                           ; SOURCE LINE # 553
02DA 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 555
02DD         ?C0054:
                                           ; SOURCE LINE # 556
02DD E4                CLR     A
02DE FF                MOV     R7,A
02DF FE                MOV     R6,A
02E0 FD                MOV     R5,A
02E1 FC                MOV     R4,A
02E2 AB00        R     MOV     R3,err_emg_1+03H
02E4 AA00        R     MOV     R2,err_emg_1+02H
02E6 A900        R     MOV     R1,err_emg_1+01H
02E8 A800        R     MOV     R0,err_emg_1
02EA D3                SETB    C
02EB 120000      E     LCALL   ?C?SLCMP
02EE 403D              JC      ?C0055
                                           ; SOURCE LINE # 557
02F0 900000      E     MOV     DPTR,#g_mem+059H
02F3 E0                MOVX    A,@DPTR
02F4 FC                MOV     R4,A
02F5 A3                INC     DPTR
02F6 E0                MOVX    A,@DPTR
02F7 FD                MOV     R5,A
02F8 A3                INC     DPTR
02F9 E0                MOVX    A,@DPTR
02FA FE                MOV     R6,A
02FB A3                INC     DPTR
02FC E0                MOVX    A,@DPTR
02FD FF                MOV     R7,A
02FE A800        R     MOV     R0,err_emg_1
0300 120000      E     LCALL   ?C?LMUL
0303 C006              PUSH    AR6
0305 C007              PUSH    AR7
0307 900000      E     MOV     DPTR,#c_mem+06BH
030A E0                MOVX    A,@DPTR
030B FE                MOV     R6,A
030C A3                INC     DPTR
030D E0                MOVX    A,@DPTR
030E FF                MOV     R7,A
030F C3                CLR     C
0310 E4                CLR     A
0311 9F                SUBB    A,R7
0312 FF                MOV     R7,A
0313 7404              MOV     A,#04H
0315 9E                SUBB    A,R6
0316 FE                MOV     R6,A
0317 AB07              MOV     R3,AR7
0319 FA                MOV     R2,A
031A E4                CLR     A
031B F9                MOV     R1,A
031C F8                MOV     R0,A
031D D007              POP     AR7
031F D006              POP     AR6
0321 120000      E     LCALL   ?C?SLDIV
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 49  

0324 900000      E     MOV     DPTR,#g_ref
0327 120000      E     LCALL   ?C?LSTXDATA
032A 020000      R     LJMP    ?C0046
032D         ?C0055:
                                           ; SOURCE LINE # 559
032D E4                CLR     A
032E FF                MOV     R7,A
032F FE                MOV     R6,A
0330 FD                MOV     R5,A
0331 FC                MOV     R4,A
0332 900000      E     MOV     DPTR,#g_ref
0335 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 560
0338 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 562
033B         ?C0057:
                                           ; SOURCE LINE # 563
033B 900000      E     MOV     DPTR,#g_refOld
033E E0                MOVX    A,@DPTR
033F FC                MOV     R4,A
0340 A3                INC     DPTR
0341 E0                MOVX    A,@DPTR
0342 FD                MOV     R5,A
0343 A3                INC     DPTR
0344 E0                MOVX    A,@DPTR
0345 FE                MOV     R6,A
0346 A3                INC     DPTR
0347 E0                MOVX    A,@DPTR
0348 FF                MOV     R7,A
0349 900000      E     MOV     DPTR,#g_ref
034C 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 564
034F E4                CLR     A
0350 FF                MOV     R7,A
0351 FE                MOV     R6,A
0352 FD                MOV     R5,A
0353 FC                MOV     R4,A
0354 AB00        R     MOV     R3,err_emg_1+03H
0356 AA00        R     MOV     R2,err_emg_1+02H
0358 A900        R     MOV     R1,err_emg_1+01H
035A A800        R     MOV     R0,err_emg_1
035C D3                SETB    C
035D 120000      E     LCALL   ?C?SLCMP
0360 4056              JC      ?C0058
                                           ; SOURCE LINE # 565
0362 900000      E     MOV     DPTR,#g_mem+078H
0365 E0                MOVX    A,@DPTR
0366 FF                MOV     R7,A
0367 E4                CLR     A
0368 FC                MOV     R4,A
0369 FD                MOV     R5,A
036A FE                MOV     R6,A
036B A800        R     MOV     R0,err_emg_1
036D 120000      E     LCALL   ?C?LMUL
0370 E4                CLR     A
0371 7B02              MOV     R3,#02H
0373 FA                MOV     R2,A
0374 F9                MOV     R1,A
0375 F8                MOV     R0,A
0376 120000      E     LCALL   ?C?LMUL
0379 C006              PUSH    AR6
037B C007              PUSH    AR7
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 50  

037D 900000      E     MOV     DPTR,#c_mem+06BH
0380 E0                MOVX    A,@DPTR
0381 FE                MOV     R6,A
0382 A3                INC     DPTR
0383 E0                MOVX    A,@DPTR
0384 FF                MOV     R7,A
0385 C3                CLR     C
0386 E4                CLR     A
0387 9F                SUBB    A,R7
0388 FF                MOV     R7,A
0389 7404              MOV     A,#04H
038B 9E                SUBB    A,R6
038C FE                MOV     R6,A
038D AB07              MOV     R3,AR7
038F FA                MOV     R2,A
0390 E4                CLR     A
0391 F9                MOV     R1,A
0392 F8                MOV     R0,A
0393 D007              POP     AR7
0395 D006              POP     AR6
0397 120000      E     LCALL   ?C?SLDIV
039A 900000      E     MOV     DPTR,#g_refOld
039D E0                MOVX    A,@DPTR
039E F8                MOV     R0,A
039F A3                INC     DPTR
03A0 E0                MOVX    A,@DPTR
03A1 F9                MOV     R1,A
03A2 A3                INC     DPTR
03A3 E0                MOVX    A,@DPTR
03A4 FA                MOV     R2,A
03A5 A3                INC     DPTR
03A6 E0                MOVX    A,@DPTR
03A7 2F                ADD     A,R7
03A8 FF                MOV     R7,A
03A9 EA                MOV     A,R2
03AA 3E                ADDC    A,R6
03AB FE                MOV     R6,A
03AC E9                MOV     A,R1
03AD 3D                ADDC    A,R5
03AE FD                MOV     R5,A
03AF E8                MOV     A,R0
03B0 3C                ADDC    A,R4
03B1 FC                MOV     R4,A
03B2 900000      E     MOV     DPTR,#g_ref
03B5 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 566
03B8         ?C0058:
                                           ; SOURCE LINE # 567
03B8 E4                CLR     A
03B9 FF                MOV     R7,A
03BA FE                MOV     R6,A
03BB FD                MOV     R5,A
03BC FC                MOV     R4,A
03BD AB00        R     MOV     R3,err_emg_2+03H
03BF AA00        R     MOV     R2,err_emg_2+02H
03C1 A900        R     MOV     R1,err_emg_2+01H
03C3 A800        R     MOV     R0,err_emg_2
03C5 D3                SETB    C
03C6 120000      E     LCALL   ?C?SLCMP
03C9 5003              JNC     $ + 5H
03CB 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 568
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 51  

03CE 900000      E     MOV     DPTR,#g_mem+078H
03D1 E0                MOVX    A,@DPTR
03D2 FF                MOV     R7,A
03D3 E4                CLR     A
03D4 FC                MOV     R4,A
03D5 FD                MOV     R5,A
03D6 FE                MOV     R6,A
03D7 A800        R     MOV     R0,err_emg_2
03D9 120000      E     LCALL   ?C?LMUL
03DC E4                CLR     A
03DD 7B02              MOV     R3,#02H
03DF FA                MOV     R2,A
03E0 F9                MOV     R1,A
03E1 F8                MOV     R0,A
03E2 120000      E     LCALL   ?C?LMUL
03E5 C006              PUSH    AR6
03E7 C007              PUSH    AR7
03E9 900000      E     MOV     DPTR,#c_mem+06DH
03EC E0                MOVX    A,@DPTR
03ED FE                MOV     R6,A
03EE A3                INC     DPTR
03EF E0                MOVX    A,@DPTR
03F0 FF                MOV     R7,A
03F1 C3                CLR     C
03F2 E4                CLR     A
03F3 9F                SUBB    A,R7
03F4 FF                MOV     R7,A
03F5 7404              MOV     A,#04H
03F7 9E                SUBB    A,R6
03F8 FE                MOV     R6,A
03F9 AB07              MOV     R3,AR7
03FB FA                MOV     R2,A
03FC E4                CLR     A
03FD F9                MOV     R1,A
03FE F8                MOV     R0,A
03FF D007              POP     AR7
0401 D006              POP     AR6
0403 120000      E     LCALL   ?C?SLDIV
0406 A804              MOV     R0,AR4
0408 A905              MOV     R1,AR5
040A AA06              MOV     R2,AR6
040C AB07              MOV     R3,AR7
040E 900000      E     MOV     DPTR,#g_refOld
0411 E0                MOVX    A,@DPTR
0412 FC                MOV     R4,A
0413 A3                INC     DPTR
0414 E0                MOVX    A,@DPTR
0415 FD                MOV     R5,A
0416 A3                INC     DPTR
0417 E0                MOVX    A,@DPTR
0418 FE                MOV     R6,A
0419 A3                INC     DPTR
041A E0                MOVX    A,@DPTR
041B C3                CLR     C
041C 9B                SUBB    A,R3
041D FF                MOV     R7,A
041E EE                MOV     A,R6
041F 9A                SUBB    A,R2
0420 FE                MOV     R6,A
0421 ED                MOV     A,R5
0422 99                SUBB    A,R1
0423 FD                MOV     R5,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 52  

0424 EC                MOV     A,R4
0425 98                SUBB    A,R0
0426 FC                MOV     R4,A
0427 900000      E     MOV     DPTR,#g_ref
042A 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 569
                                           ; SOURCE LINE # 570
042D 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 572
0430         ?C0060:
                                           ; SOURCE LINE # 573
0430 900000      E     MOV     DPTR,#g_refOld
0433 E0                MOVX    A,@DPTR
0434 FC                MOV     R4,A
0435 A3                INC     DPTR
0436 E0                MOVX    A,@DPTR
0437 FD                MOV     R5,A
0438 A3                INC     DPTR
0439 E0                MOVX    A,@DPTR
043A FE                MOV     R6,A
043B A3                INC     DPTR
043C E0                MOVX    A,@DPTR
043D FF                MOV     R7,A
043E 900000      E     MOV     DPTR,#g_ref
0441 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 574
0444 900000      R     MOV     DPTR,#current_emg
0447 E0                MOVX    A,@DPTR
0448 14                DEC     A
0449 6048              JZ      ?C0065
044B 14                DEC     A
044C 7003              JNZ     $ + 5H
044E 020000      R     LJMP    ?C0067
0451 2402              ADD     A,#02H
0453 6003              JZ      $ + 5H
0455 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 575
0458         ?C0062:
                                           ; SOURCE LINE # 577
0458 E4                CLR     A
0459 FF                MOV     R7,A
045A FE                MOV     R6,A
045B FD                MOV     R5,A
045C FC                MOV     R4,A
045D AB00        R     MOV     R3,err_emg_1+03H
045F AA00        R     MOV     R2,err_emg_1+02H
0461 A900        R     MOV     R1,err_emg_1+01H
0463 A800        R     MOV     R0,err_emg_1
0465 D3                SETB    C
0466 120000      E     LCALL   ?C?SLCMP
0469 4009              JC      ?C0063
                                           ; SOURCE LINE # 578
046B 900000      R     MOV     DPTR,#current_emg
046E 7401              MOV     A,#01H
0470 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 579
0471 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 580
0474         ?C0063:
                                           ; SOURCE LINE # 581
0474 E4                CLR     A
0475 FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 53  

0476 FE                MOV     R6,A
0477 FD                MOV     R5,A
0478 FC                MOV     R4,A
0479 AB00        R     MOV     R3,err_emg_2+03H
047B AA00        R     MOV     R2,err_emg_2+02H
047D A900        R     MOV     R1,err_emg_2+01H
047F A800        R     MOV     R0,err_emg_2
0481 D3                SETB    C
0482 120000      E     LCALL   ?C?SLCMP
0485 5003              JNC     $ + 5H
0487 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 582
048A 900000      R     MOV     DPTR,#current_emg
048D 7402              MOV     A,#02H
048F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 583
0490 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 584
                                           ; SOURCE LINE # 585
                                           ; SOURCE LINE # 587
0493         ?C0065:
                                           ; SOURCE LINE # 589
0493 E4                CLR     A
0494 FF                MOV     R7,A
0495 FE                MOV     R6,A
0496 FD                MOV     R5,A
0497 FC                MOV     R4,A
0498 AB00        R     MOV     R3,err_emg_1+03H
049A AA00        R     MOV     R2,err_emg_1+02H
049C A900        R     MOV     R1,err_emg_1+01H
049E A800        R     MOV     R0,err_emg_1
04A0 C3                CLR     C
04A1 120000      E     LCALL   ?C?SLCMP
04A4 5008              JNC     ?C0066
                                           ; SOURCE LINE # 590
04A6 E4                CLR     A
04A7 900000      R     MOV     DPTR,#current_emg
04AA F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 591
04AB 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 592
04AE         ?C0066:
                                           ; SOURCE LINE # 593
04AE 900000      E     MOV     DPTR,#g_mem+078H
04B1 E0                MOVX    A,@DPTR
04B2 FF                MOV     R7,A
04B3 E4                CLR     A
04B4 FC                MOV     R4,A
04B5 FD                MOV     R5,A
04B6 FE                MOV     R6,A
04B7 AB00        R     MOV     R3,err_emg_1+03H
04B9 AA00        R     MOV     R2,err_emg_1+02H
04BB A900        R     MOV     R1,err_emg_1+01H
04BD A800        R     MOV     R0,err_emg_1
04BF 120000      E     LCALL   ?C?LMUL
04C2 E4                CLR     A
04C3 7B02              MOV     R3,#02H
04C5 FA                MOV     R2,A
04C6 F9                MOV     R1,A
04C7 F8                MOV     R0,A
04C8 120000      E     LCALL   ?C?LMUL
04CB C006              PUSH    AR6
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 54  

04CD C007              PUSH    AR7
04CF 900000      E     MOV     DPTR,#c_mem+06BH
04D2 E0                MOVX    A,@DPTR
04D3 FE                MOV     R6,A
04D4 A3                INC     DPTR
04D5 E0                MOVX    A,@DPTR
04D6 FF                MOV     R7,A
04D7 C3                CLR     C
04D8 E4                CLR     A
04D9 9F                SUBB    A,R7
04DA FF                MOV     R7,A
04DB 7404              MOV     A,#04H
04DD 9E                SUBB    A,R6
04DE FE                MOV     R6,A
04DF AB07              MOV     R3,AR7
04E1 FA                MOV     R2,A
04E2 E4                CLR     A
04E3 F9                MOV     R1,A
04E4 F8                MOV     R0,A
04E5 D007              POP     AR7
04E7 D006              POP     AR6
04E9 120000      E     LCALL   ?C?SLDIV
04EC 900000      E     MOV     DPTR,#g_refOld
04EF E0                MOVX    A,@DPTR
04F0 F8                MOV     R0,A
04F1 A3                INC     DPTR
04F2 E0                MOVX    A,@DPTR
04F3 F9                MOV     R1,A
04F4 A3                INC     DPTR
04F5 E0                MOVX    A,@DPTR
04F6 FA                MOV     R2,A
04F7 A3                INC     DPTR
04F8 E0                MOVX    A,@DPTR
04F9 2F                ADD     A,R7
04FA FF                MOV     R7,A
04FB EA                MOV     A,R2
04FC 3E                ADDC    A,R6
04FD FE                MOV     R6,A
04FE E9                MOV     A,R1
04FF 3D                ADDC    A,R5
0500 FD                MOV     R5,A
0501 E8                MOV     A,R0
0502 3C                ADDC    A,R4
0503 FC                MOV     R4,A
0504 900000      E     MOV     DPTR,#g_ref
0507 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 594
050A 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 596
050D         ?C0067:
                                           ; SOURCE LINE # 598
050D E4                CLR     A
050E FF                MOV     R7,A
050F FE                MOV     R6,A
0510 FD                MOV     R5,A
0511 FC                MOV     R4,A
0512 AB00        R     MOV     R3,err_emg_2+03H
0514 AA00        R     MOV     R2,err_emg_2+02H
0516 A900        R     MOV     R1,err_emg_2+01H
0518 A800        R     MOV     R0,err_emg_2
051A C3                CLR     C
051B 120000      E     LCALL   ?C?SLCMP
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 55  

051E 5008              JNC     ?C0068
                                           ; SOURCE LINE # 599
0520 E4                CLR     A
0521 900000      R     MOV     DPTR,#current_emg
0524 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 600
0525 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 601
0528         ?C0068:
                                           ; SOURCE LINE # 602
0528 900000      E     MOV     DPTR,#g_mem+078H
052B E0                MOVX    A,@DPTR
052C FF                MOV     R7,A
052D E4                CLR     A
052E FC                MOV     R4,A
052F FD                MOV     R5,A
0530 FE                MOV     R6,A
0531 AB00        R     MOV     R3,err_emg_2+03H
0533 AA00        R     MOV     R2,err_emg_2+02H
0535 A900        R     MOV     R1,err_emg_2+01H
0537 A800        R     MOV     R0,err_emg_2
0539 120000      E     LCALL   ?C?LMUL
053C E4                CLR     A
053D 7B02              MOV     R3,#02H
053F FA                MOV     R2,A
0540 F9                MOV     R1,A
0541 F8                MOV     R0,A
0542 120000      E     LCALL   ?C?LMUL
0545 C006              PUSH    AR6
0547 C007              PUSH    AR7
0549 900000      E     MOV     DPTR,#c_mem+06DH
054C E0                MOVX    A,@DPTR
054D FE                MOV     R6,A
054E A3                INC     DPTR
054F E0                MOVX    A,@DPTR
0550 FF                MOV     R7,A
0551 C3                CLR     C
0552 E4                CLR     A
0553 9F                SUBB    A,R7
0554 FF                MOV     R7,A
0555 7404              MOV     A,#04H
0557 9E                SUBB    A,R6
0558 FE                MOV     R6,A
0559 AB07              MOV     R3,AR7
055B FA                MOV     R2,A
055C E4                CLR     A
055D F9                MOV     R1,A
055E F8                MOV     R0,A
055F D007              POP     AR7
0561 D006              POP     AR6
0563 120000      E     LCALL   ?C?SLDIV
0566 A804              MOV     R0,AR4
0568 A905              MOV     R1,AR5
056A AA06              MOV     R2,AR6
056C AB07              MOV     R3,AR7
056E 900000      E     MOV     DPTR,#g_refOld
0571 E0                MOVX    A,@DPTR
0572 FC                MOV     R4,A
0573 A3                INC     DPTR
0574 E0                MOVX    A,@DPTR
0575 FD                MOV     R5,A
0576 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 56  

0577 E0                MOVX    A,@DPTR
0578 FE                MOV     R6,A
0579 A3                INC     DPTR
057A E0                MOVX    A,@DPTR
057B C3                CLR     C
057C 9B                SUBB    A,R3
057D FF                MOV     R7,A
057E EE                MOV     A,R6
057F 9A                SUBB    A,R2
0580 FE                MOV     R6,A
0581 ED                MOV     A,R5
0582 99                SUBB    A,R1
0583 FD                MOV     R5,A
0584 EC                MOV     A,R4
0585 98                SUBB    A,R0
0586 FC                MOV     R4,A
0587 900000      E     MOV     DPTR,#g_ref
058A 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 603
058D 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 605
                                           ; SOURCE LINE # 606
                                           ; SOURCE LINE # 607
                                           ; SOURCE LINE # 609
0590 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 611
0593         ?C0070:
                                           ; SOURCE LINE # 612
0593 900000      E     MOV     DPTR,#g_refOld
0596 E0                MOVX    A,@DPTR
0597 FC                MOV     R4,A
0598 A3                INC     DPTR
0599 E0                MOVX    A,@DPTR
059A FD                MOV     R5,A
059B A3                INC     DPTR
059C E0                MOVX    A,@DPTR
059D FE                MOV     R6,A
059E A3                INC     DPTR
059F E0                MOVX    A,@DPTR
05A0 FF                MOV     R7,A
05A1 900000      E     MOV     DPTR,#g_ref
05A4 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 613
05A7 900000      R     MOV     DPTR,#current_emg
05AA E0                MOVX    A,@DPTR
05AB 14                DEC     A
05AC 6048              JZ      ?C0075
05AE 14                DEC     A
05AF 7003              JNZ     $ + 5H
05B1 020000      R     LJMP    ?C0078
05B4 2402              ADD     A,#02H
05B6 6003              JZ      $ + 5H
05B8 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 615
05BB         ?C0072:
                                           ; SOURCE LINE # 616
05BB E4                CLR     A
05BC FF                MOV     R7,A
05BD FE                MOV     R6,A
05BE FD                MOV     R5,A
05BF FC                MOV     R4,A
05C0 AB00        R     MOV     R3,err_emg_1+03H
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 57  

05C2 AA00        R     MOV     R2,err_emg_1+02H
05C4 A900        R     MOV     R1,err_emg_1+01H
05C6 A800        R     MOV     R0,err_emg_1
05C8 D3                SETB    C
05C9 120000      E     LCALL   ?C?SLCMP
05CC 4009              JC      ?C0073
                                           ; SOURCE LINE # 617
05CE 900000      R     MOV     DPTR,#current_emg
05D1 7401              MOV     A,#01H
05D3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 618
05D4 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 619
05D7         ?C0073:
                                           ; SOURCE LINE # 620
05D7 E4                CLR     A
05D8 FF                MOV     R7,A
05D9 FE                MOV     R6,A
05DA FD                MOV     R5,A
05DB FC                MOV     R4,A
05DC AB00        R     MOV     R3,err_emg_2+03H
05DE AA00        R     MOV     R2,err_emg_2+02H
05E0 A900        R     MOV     R1,err_emg_2+01H
05E2 A800        R     MOV     R0,err_emg_2
05E4 D3                SETB    C
05E5 120000      E     LCALL   ?C?SLCMP
05E8 5003              JNC     $ + 5H
05EA 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 621
05ED 900000      R     MOV     DPTR,#current_emg
05F0 7402              MOV     A,#02H
05F2 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 622
05F3 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 623
                                           ; SOURCE LINE # 624
                                           ; SOURCE LINE # 627
05F6         ?C0075:
                                           ; SOURCE LINE # 629
05F6 E4                CLR     A
05F7 FF                MOV     R7,A
05F8 FE                MOV     R6,A
05F9 FD                MOV     R5,A
05FA FC                MOV     R4,A
05FB AB00        R     MOV     R3,err_emg_1+03H
05FD AA00        R     MOV     R2,err_emg_1+02H
05FF A900        R     MOV     R1,err_emg_1+01H
0601 A800        R     MOV     R0,err_emg_1
0603 C3                CLR     C
0604 120000      E     LCALL   ?C?SLCMP
0607 501B              JNC     ?C0076
0609 E4                CLR     A
060A FF                MOV     R7,A
060B FE                MOV     R6,A
060C FD                MOV     R5,A
060D FC                MOV     R4,A
060E AB00        R     MOV     R3,err_emg_2+03H
0610 AA00        R     MOV     R2,err_emg_2+02H
0612 A900        R     MOV     R1,err_emg_2+01H
0614 A800        R     MOV     R0,err_emg_2
0616 C3                CLR     C
0617 120000      E     LCALL   ?C?SLCMP
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 58  

061A 5008              JNC     ?C0076
                                           ; SOURCE LINE # 630
061C E4                CLR     A
061D 900000      R     MOV     DPTR,#current_emg
0620 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 631
0621 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 632
0624         ?C0076:
                                           ; SOURCE LINE # 634
0624 E4                CLR     A
0625 FF                MOV     R7,A
0626 FE                MOV     R6,A
0627 FD                MOV     R5,A
0628 FC                MOV     R4,A
0629 AB00        R     MOV     R3,err_emg_1+03H
062B AA00        R     MOV     R2,err_emg_1+02H
062D A900        R     MOV     R1,err_emg_1+01H
062F A800        R     MOV     R0,err_emg_1
0631 D3                SETB    C
0632 120000      E     LCALL   ?C?SLCMP
0635 5003              JNC     $ + 5H
0637 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 635
063A 900000      E     MOV     DPTR,#g_mem+078H
063D E0                MOVX    A,@DPTR
063E FF                MOV     R7,A
063F E4                CLR     A
0640 FC                MOV     R4,A
0641 FD                MOV     R5,A
0642 FE                MOV     R6,A
0643 A800        R     MOV     R0,err_emg_1
0645 120000      E     LCALL   ?C?LMUL
0648 7802              MOV     R0,#02H
064A 120000      E     LCALL   ?C?LSHL
064D C006              PUSH    AR6
064F C007              PUSH    AR7
0651 900000      E     MOV     DPTR,#c_mem+06BH
0654 E0                MOVX    A,@DPTR
0655 FE                MOV     R6,A
0656 A3                INC     DPTR
0657 E0                MOVX    A,@DPTR
0658 FF                MOV     R7,A
0659 C3                CLR     C
065A E4                CLR     A
065B 9F                SUBB    A,R7
065C FF                MOV     R7,A
065D 7404              MOV     A,#04H
065F 9E                SUBB    A,R6
0660 FE                MOV     R6,A
0661 AB07              MOV     R3,AR7
0663 FA                MOV     R2,A
0664 E4                CLR     A
0665 F9                MOV     R1,A
0666 F8                MOV     R0,A
0667 D007              POP     AR7
0669 D006              POP     AR6
066B 120000      E     LCALL   ?C?SLDIV
066E 900000      E     MOV     DPTR,#g_refOld
0671 E0                MOVX    A,@DPTR
0672 F8                MOV     R0,A
0673 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 59  

0674 E0                MOVX    A,@DPTR
0675 F9                MOV     R1,A
0676 A3                INC     DPTR
0677 E0                MOVX    A,@DPTR
0678 FA                MOV     R2,A
0679 A3                INC     DPTR
067A E0                MOVX    A,@DPTR
067B 2F                ADD     A,R7
067C FF                MOV     R7,A
067D EA                MOV     A,R2
067E 3E                ADDC    A,R6
067F FE                MOV     R6,A
0680 E9                MOV     A,R1
0681 3D                ADDC    A,R5
0682 FD                MOV     R5,A
0683 E8                MOV     A,R0
0684 3C                ADDC    A,R4
0685 FC                MOV     R4,A
0686 900000      E     MOV     DPTR,#g_ref
0689 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 637
068C 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 640
068F         ?C0078:
                                           ; SOURCE LINE # 642
068F E4                CLR     A
0690 FF                MOV     R7,A
0691 FE                MOV     R6,A
0692 FD                MOV     R5,A
0693 FC                MOV     R4,A
0694 AB00        R     MOV     R3,err_emg_1+03H
0696 AA00        R     MOV     R2,err_emg_1+02H
0698 A900        R     MOV     R1,err_emg_1+01H
069A A800        R     MOV     R0,err_emg_1
069C C3                CLR     C
069D 120000      E     LCALL   ?C?SLCMP
06A0 501A              JNC     ?C0079
06A2 E4                CLR     A
06A3 FF                MOV     R7,A
06A4 FE                MOV     R6,A
06A5 FD                MOV     R5,A
06A6 FC                MOV     R4,A
06A7 AB00        R     MOV     R3,err_emg_2+03H
06A9 AA00        R     MOV     R2,err_emg_2+02H
06AB A900        R     MOV     R1,err_emg_2+01H
06AD A800        R     MOV     R0,err_emg_2
06AF C3                CLR     C
06B0 120000      E     LCALL   ?C?SLCMP
06B3 5007              JNC     ?C0079
                                           ; SOURCE LINE # 643
06B5 E4                CLR     A
06B6 900000      R     MOV     DPTR,#current_emg
06B9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 644
06BA 806E              SJMP    ?C0046
                                           ; SOURCE LINE # 645
06BC         ?C0079:
                                           ; SOURCE LINE # 647
06BC E4                CLR     A
06BD FF                MOV     R7,A
06BE FE                MOV     R6,A
06BF FD                MOV     R5,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 60  

06C0 FC                MOV     R4,A
06C1 AB00        R     MOV     R3,err_emg_2+03H
06C3 AA00        R     MOV     R2,err_emg_2+02H
06C5 A900        R     MOV     R1,err_emg_2+01H
06C7 A800        R     MOV     R0,err_emg_2
06C9 D3                SETB    C
06CA 120000      E     LCALL   ?C?SLCMP
06CD 405B              JC      ?C0046
                                           ; SOURCE LINE # 648
06CF 900000      E     MOV     DPTR,#c_mem+078H
06D2 E0                MOVX    A,@DPTR
06D3 FF                MOV     R7,A
06D4 E4                CLR     A
06D5 FC                MOV     R4,A
06D6 FD                MOV     R5,A
06D7 FE                MOV     R6,A
06D8 A800        R     MOV     R0,err_emg_2
06DA 120000      E     LCALL   ?C?LMUL
06DD 7802              MOV     R0,#02H
06DF 120000      E     LCALL   ?C?LSHL
06E2 C006              PUSH    AR6
06E4 C007              PUSH    AR7
06E6 900000      E     MOV     DPTR,#c_mem+06DH
06E9 E0                MOVX    A,@DPTR
06EA FE                MOV     R6,A
06EB A3                INC     DPTR
06EC E0                MOVX    A,@DPTR
06ED FF                MOV     R7,A
06EE C3                CLR     C
06EF E4                CLR     A
06F0 9F                SUBB    A,R7
06F1 FF                MOV     R7,A
06F2 7404              MOV     A,#04H
06F4 9E                SUBB    A,R6
06F5 FE                MOV     R6,A
06F6 AB07              MOV     R3,AR7
06F8 FA                MOV     R2,A
06F9 E4                CLR     A
06FA F9                MOV     R1,A
06FB F8                MOV     R0,A
06FC D007              POP     AR7
06FE D006              POP     AR6
0700 120000      E     LCALL   ?C?SLDIV
0703 A804              MOV     R0,AR4
0705 A905              MOV     R1,AR5
0707 AA06              MOV     R2,AR6
0709 AB07              MOV     R3,AR7
070B 900000      E     MOV     DPTR,#g_refOld
070E E0                MOVX    A,@DPTR
070F FC                MOV     R4,A
0710 A3                INC     DPTR
0711 E0                MOVX    A,@DPTR
0712 FD                MOV     R5,A
0713 A3                INC     DPTR
0714 E0                MOVX    A,@DPTR
0715 FE                MOV     R6,A
0716 A3                INC     DPTR
0717 E0                MOVX    A,@DPTR
0718 C3                CLR     C
0719 9B                SUBB    A,R3
071A FF                MOV     R7,A
071B EE                MOV     A,R6
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 61  

071C 9A                SUBB    A,R2
071D FE                MOV     R6,A
071E ED                MOV     A,R5
071F 99                SUBB    A,R1
0720 FD                MOV     R5,A
0721 EC                MOV     A,R4
0722 98                SUBB    A,R0
0723 FC                MOV     R4,A
0724 900000      E     MOV     DPTR,#g_ref
0727 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 649
                                           ; SOURCE LINE # 650
                                           ; SOURCE LINE # 652
                                           ; SOURCE LINE # 653
                                           ; SOURCE LINE # 654
                                           ; SOURCE LINE # 656
                                           ; SOURCE LINE # 657
                                           ; SOURCE LINE # 658
072A         ?C0046:
                                           ; SOURCE LINE # 661
072A 900000      E     MOV     DPTR,#c_mem+050H
072D E0                MOVX    A,@DPTR
072E 606A              JZ      ?C0083
                                           ; SOURCE LINE # 662
0730 A3                INC     DPTR
0731 E0                MOVX    A,@DPTR
0732 FC                MOV     R4,A
0733 A3                INC     DPTR
0734 E0                MOVX    A,@DPTR
0735 FD                MOV     R5,A
0736 A3                INC     DPTR
0737 E0                MOVX    A,@DPTR
0738 FE                MOV     R6,A
0739 A3                INC     DPTR
073A E0                MOVX    A,@DPTR
073B FF                MOV     R7,A
073C 900000      E     MOV     DPTR,#g_ref
073F E0                MOVX    A,@DPTR
0740 F8                MOV     R0,A
0741 A3                INC     DPTR
0742 E0                MOVX    A,@DPTR
0743 F9                MOV     R1,A
0744 A3                INC     DPTR
0745 E0                MOVX    A,@DPTR
0746 FA                MOV     R2,A
0747 A3                INC     DPTR
0748 E0                MOVX    A,@DPTR
0749 FB                MOV     R3,A
074A C3                CLR     C
074B 120000      E     LCALL   ?C?SLCMP
074E 5014              JNC     ?C0084
                                           ; SOURCE LINE # 663
0750 900000      E     MOV     DPTR,#c_mem+051H
0753 E0                MOVX    A,@DPTR
0754 FC                MOV     R4,A
0755 A3                INC     DPTR
0756 E0                MOVX    A,@DPTR
0757 FD                MOV     R5,A
0758 A3                INC     DPTR
0759 E0                MOVX    A,@DPTR
075A FE                MOV     R6,A
075B A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 62  

075C E0                MOVX    A,@DPTR
075D FF                MOV     R7,A
075E 900000      E     MOV     DPTR,#g_ref
0761 120000      E     LCALL   ?C?LSTXDATA
0764         ?C0084:
                                           ; SOURCE LINE # 664
0764 900000      E     MOV     DPTR,#c_mem+059H
0767 E0                MOVX    A,@DPTR
0768 FC                MOV     R4,A
0769 A3                INC     DPTR
076A E0                MOVX    A,@DPTR
076B FD                MOV     R5,A
076C A3                INC     DPTR
076D E0                MOVX    A,@DPTR
076E FE                MOV     R6,A
076F A3                INC     DPTR
0770 E0                MOVX    A,@DPTR
0771 FF                MOV     R7,A
0772 900000      E     MOV     DPTR,#g_ref
0775 E0                MOVX    A,@DPTR
0776 F8                MOV     R0,A
0777 A3                INC     DPTR
0778 E0                MOVX    A,@DPTR
0779 F9                MOV     R1,A
077A A3                INC     DPTR
077B E0                MOVX    A,@DPTR
077C FA                MOV     R2,A
077D A3                INC     DPTR
077E E0                MOVX    A,@DPTR
077F FB                MOV     R3,A
0780 D3                SETB    C
0781 120000      E     LCALL   ?C?SLCMP
0784 4014              JC      ?C0083
                                           ; SOURCE LINE # 665
0786 900000      E     MOV     DPTR,#c_mem+059H
0789 E0                MOVX    A,@DPTR
078A FC                MOV     R4,A
078B A3                INC     DPTR
078C E0                MOVX    A,@DPTR
078D FD                MOV     R5,A
078E A3                INC     DPTR
078F E0                MOVX    A,@DPTR
0790 FE                MOV     R6,A
0791 A3                INC     DPTR
0792 E0                MOVX    A,@DPTR
0793 FF                MOV     R7,A
0794 900000      E     MOV     DPTR,#g_ref
0797 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 666
079A         ?C0083:
                                           ; SOURCE LINE # 668
079A 900000      E     MOV     DPTR,#c_mem+0A6H
079D E0                MOVX    A,@DPTR
079E 6401              XRL     A,#01H
07A0 6003              JZ      $ + 5H
07A2 020000      R     LJMP    ?C0086
                                           ; SOURCE LINE # 669
07A5 900000      E     MOV     DPTR,#rest_enabled
07A8 E0                MOVX    A,@DPTR
07A9 B40114            CJNE    A,#01H,?C0087
                                           ; SOURCE LINE # 671
07AC 900000      E     MOV     DPTR,#rest_pos_curr_ref
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 63  

07AF E0                MOVX    A,@DPTR
07B0 FC                MOV     R4,A
07B1 A3                INC     DPTR
07B2 E0                MOVX    A,@DPTR
07B3 FD                MOV     R5,A
07B4 A3                INC     DPTR
07B5 E0                MOVX    A,@DPTR
07B6 FE                MOV     R6,A
07B7 A3                INC     DPTR
07B8 E0                MOVX    A,@DPTR
07B9 FF                MOV     R7,A
07BA 900000      E     MOV     DPTR,#g_ref
07BD 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 672
07C0         ?C0087:
                                           ; SOURCE LINE # 674
07C0 900000      E     MOV     DPTR,#forced_open
07C3 E0                MOVX    A,@DPTR
07C4 6401              XRL     A,#01H
07C6 6003              JZ      $ + 5H
07C8 020000      R     LJMP    ?C0086
                                           ; SOURCE LINE # 676
07CB FF                MOV     R7,A
07CC FE                MOV     R6,A
07CD FD                MOV     R5,A
07CE FC                MOV     R4,A
07CF AB00        R     MOV     R3,err_emg_2+03H
07D1 AA00        R     MOV     R2,err_emg_2+02H
07D3 A900        R     MOV     R1,err_emg_2+01H
07D5 A800        R     MOV     R0,err_emg_2
07D7 D3                SETB    C
07D8 120000      E     LCALL   ?C?SLCMP
07DB 405D              JC      ?C0089
                                           ; SOURCE LINE # 677
07DD 900000      E     MOV     DPTR,#g_mem+096H
07E0 E0                MOVX    A,@DPTR
07E1 FC                MOV     R4,A
07E2 A3                INC     DPTR
07E3 E0                MOVX    A,@DPTR
07E4 FD                MOV     R5,A
07E5 A3                INC     DPTR
07E6 E0                MOVX    A,@DPTR
07E7 FE                MOV     R6,A
07E8 A3                INC     DPTR
07E9 E0                MOVX    A,@DPTR
07EA FF                MOV     R7,A
07EB A800        R     MOV     R0,err_emg_2
07ED 120000      E     LCALL   ?C?LMUL
07F0 C006              PUSH    AR6
07F2 C007              PUSH    AR7
07F4 900000      E     MOV     DPTR,#c_mem+06DH
07F7 E0                MOVX    A,@DPTR
07F8 FE                MOV     R6,A
07F9 A3                INC     DPTR
07FA E0                MOVX    A,@DPTR
07FB FF                MOV     R7,A
07FC C3                CLR     C
07FD E4                CLR     A
07FE 9F                SUBB    A,R7
07FF FF                MOV     R7,A
0800 7404              MOV     A,#04H
0802 9E                SUBB    A,R6
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 64  

0803 FE                MOV     R6,A
0804 AB07              MOV     R3,AR7
0806 FA                MOV     R2,A
0807 E4                CLR     A
0808 F9                MOV     R1,A
0809 F8                MOV     R0,A
080A D007              POP     AR7
080C D006              POP     AR6
080E 120000      E     LCALL   ?C?SLDIV
0811 A804              MOV     R0,AR4
0813 A905              MOV     R1,AR5
0815 AA06              MOV     R2,AR6
0817 AB07              MOV     R3,AR7
0819 900000      E     MOV     DPTR,#g_mem+096H
081C E0                MOVX    A,@DPTR
081D FC                MOV     R4,A
081E A3                INC     DPTR
081F E0                MOVX    A,@DPTR
0820 FD                MOV     R5,A
0821 A3                INC     DPTR
0822 E0                MOVX    A,@DPTR
0823 FE                MOV     R6,A
0824 A3                INC     DPTR
0825 E0                MOVX    A,@DPTR
0826 C3                CLR     C
0827 9B                SUBB    A,R3
0828 FF                MOV     R7,A
0829 EE                MOV     A,R6
082A 9A                SUBB    A,R2
082B FE                MOV     R6,A
082C ED                MOV     A,R5
082D 99                SUBB    A,R1
082E FD                MOV     R5,A
082F EC                MOV     A,R4
0830 98                SUBB    A,R0
0831 FC                MOV     R4,A
0832 900000      E     MOV     DPTR,#g_ref
0835 120000      E     LCALL   ?C?LSTXDATA
0838 8019              SJMP    ?C0086
083A         ?C0089:
                                           ; SOURCE LINE # 678
                                           ; SOURCE LINE # 679
083A 900000      E     MOV     DPTR,#g_mem+096H
083D E0                MOVX    A,@DPTR
083E FC                MOV     R4,A
083F A3                INC     DPTR
0840 E0                MOVX    A,@DPTR
0841 FD                MOV     R5,A
0842 A3                INC     DPTR
0843 E0                MOVX    A,@DPTR
0844 FE                MOV     R6,A
0845 A3                INC     DPTR
0846 E0                MOVX    A,@DPTR
0847 FF                MOV     R7,A
0848 900000      E     MOV     DPTR,#g_ref
084B 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 680
084E E4                CLR     A
084F 900000      E     MOV     DPTR,#forced_open
0852 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 681
                                           ; SOURCE LINE # 682
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 65  

                                           ; SOURCE LINE # 683
0853         ?C0086:
                                           ; SOURCE LINE # 685
0853 900000      E     MOV     DPTR,#c_mem+034H
0856 E0                MOVX    A,@DPTR
0857 7003              JNZ     $ + 5H
0859 020000      R     LJMP    ?C0116
085C 14                DEC     A
085D 7003              JNZ     $ + 5H
085F 020000      R     LJMP    ?C0138
0862 14                DEC     A
0863 7003              JNZ     $ + 5H
0865 020000      R     LJMP    ?C0125
0868 14                DEC     A
0869 6003              JZ      $ + 5H
086B 020000      R     LJMP    ?C0091
                                           ; SOURCE LINE # 687
086E         ?C0092:
                                           ; SOURCE LINE # 688
086E 900000      E     MOV     DPTR,#g_meas
0871 E0                MOVX    A,@DPTR
0872 F8                MOV     R0,A
0873 A3                INC     DPTR
0874 E0                MOVX    A,@DPTR
0875 F9                MOV     R1,A
0876 A3                INC     DPTR
0877 E0                MOVX    A,@DPTR
0878 FA                MOV     R2,A
0879 A3                INC     DPTR
087A E0                MOVX    A,@DPTR
087B FB                MOV     R3,A
087C 900000      E     MOV     DPTR,#g_ref
087F E0                MOVX    A,@DPTR
0880 FC                MOV     R4,A
0881 A3                INC     DPTR
0882 E0                MOVX    A,@DPTR
0883 FD                MOV     R5,A
0884 A3                INC     DPTR
0885 E0                MOVX    A,@DPTR
0886 FE                MOV     R6,A
0887 A3                INC     DPTR
0888 E0                MOVX    A,@DPTR
0889 C3                CLR     C
088A 9B                SUBB    A,R3
088B F500        R     MOV     pos_error+03H,A
088D EE                MOV     A,R6
088E 9A                SUBB    A,R2
088F F500        R     MOV     pos_error+02H,A
0891 ED                MOV     A,R5
0892 99                SUBB    A,R1
0893 F500        R     MOV     pos_error+01H,A
0895 EC                MOV     A,R4
0896 98                SUBB    A,R0
0897 F500        R     MOV     pos_error,A
                                           ; SOURCE LINE # 690
0899 900000      R     MOV     DPTR,#pos_error_sum
089C E0                MOVX    A,@DPTR
089D FC                MOV     R4,A
089E A3                INC     DPTR
089F E0                MOVX    A,@DPTR
08A0 FD                MOV     R5,A
08A1 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 66  

08A2 E0                MOVX    A,@DPTR
08A3 FE                MOV     R6,A
08A4 A3                INC     DPTR
08A5 E0                MOVX    A,@DPTR
08A6 2500        R     ADD     A,pos_error+03H
08A8 FF                MOV     R7,A
08A9 EE                MOV     A,R6
08AA 3500        R     ADDC    A,pos_error+02H
08AC FE                MOV     R6,A
08AD ED                MOV     A,R5
08AE 3500        R     ADDC    A,pos_error+01H
08B0 FD                MOV     R5,A
08B1 EC                MOV     A,R4
08B2 3500        R     ADDC    A,pos_error
08B4 FC                MOV     R4,A
08B5 900000      R     MOV     DPTR,#pos_error_sum
08B8 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 693
08BB AF00        R     MOV     R7,pos_error_max+03H
08BD AE00        R     MOV     R6,pos_error_max+02H
08BF AD00        R     MOV     R5,pos_error_max+01H
08C1 AC00        R     MOV     R4,pos_error_max
08C3 AB00        R     MOV     R3,pos_error+03H
08C5 AA00        R     MOV     R2,pos_error+02H
08C7 A900        R     MOV     R1,pos_error+01H
08C9 A800        R     MOV     R0,pos_error
08CB D3                SETB    C
08CC 120000      E     LCALL   ?C?SLCMP
08CF 400E              JC      ?C0093
                                           ; SOURCE LINE # 694
08D1 850000      R     MOV     pos_error+03H,pos_error_max+03H
08D4 850000      R     MOV     pos_error+02H,pos_error_max+02H
08D7 850000      R     MOV     pos_error+01H,pos_error_max+01H
08DA 850000      R     MOV     pos_error,pos_error_max
08DD 802C              SJMP    ?C0094
08DF         ?C0093:
                                           ; SOURCE LINE # 695
                                           ; SOURCE LINE # 696
08DF AF00        R     MOV     R7,pos_error_max+03H
08E1 AE00        R     MOV     R6,pos_error_max+02H
08E3 AD00        R     MOV     R5,pos_error_max+01H
08E5 AC00        R     MOV     R4,pos_error_max
08E7 120000      E     LCALL   ?C?LNEG
08EA AB00        R     MOV     R3,pos_error+03H
08EC AA00        R     MOV     R2,pos_error+02H
08EE A900        R     MOV     R1,pos_error+01H
08F0 A800        R     MOV     R0,pos_error
08F2 C3                CLR     C
08F3 120000      E     LCALL   ?C?SLCMP
08F6 5013              JNC     ?C0094
                                           ; SOURCE LINE # 697
08F8 AF00        R     MOV     R7,pos_error_max+03H
08FA AE00        R     MOV     R6,pos_error_max+02H
08FC AD00        R     MOV     R5,pos_error_max+01H
08FE AC00        R     MOV     R4,pos_error_max
0900 120000      E     LCALL   ?C?LNEG
0903 8F00        R     MOV     pos_error+03H,R7
0905 8E00        R     MOV     pos_error+02H,R6
0907 8D00        R     MOV     pos_error+01H,R5
0909 8C00        R     MOV     pos_error,R4
                                           ; SOURCE LINE # 698
090B         ?C0094:
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 67  

                                           ; SOURCE LINE # 701
090B 7F80              MOV     R7,#080H
090D 7EF0              MOV     R6,#0F0H
090F 7DFA              MOV     R5,#0FAH
0911 7C02              MOV     R4,#02H
0913 900000      R     MOV     DPTR,#pos_error_sum
0916 E0                MOVX    A,@DPTR
0917 F8                MOV     R0,A
0918 A3                INC     DPTR
0919 E0                MOVX    A,@DPTR
091A F9                MOV     R1,A
091B A3                INC     DPTR
091C E0                MOVX    A,@DPTR
091D FA                MOV     R2,A
091E A3                INC     DPTR
091F E0                MOVX    A,@DPTR
0920 FB                MOV     R3,A
0921 D3                SETB    C
0922 120000      E     LCALL   ?C?SLCMP
0925 4010              JC      ?C0096
                                           ; SOURCE LINE # 702
0927 7F80              MOV     R7,#080H
0929 7EF0              MOV     R6,#0F0H
092B 7DFA              MOV     R5,#0FAH
092D 7C02              MOV     R4,#02H
092F 900000      R     MOV     DPTR,#pos_error_sum
0932 120000      E     LCALL   ?C?LSTXDATA
0935 802A              SJMP    ?C0097
0937         ?C0096:
                                           ; SOURCE LINE # 703
                                           ; SOURCE LINE # 704
0937 7F80              MOV     R7,#080H
0939 7E0F              MOV     R6,#0FH
093B 7D05              MOV     R5,#05H
093D 7CFD              MOV     R4,#0FDH
093F 900000      R     MOV     DPTR,#pos_error_sum
0942 E0                MOVX    A,@DPTR
0943 F8                MOV     R0,A
0944 A3                INC     DPTR
0945 E0                MOVX    A,@DPTR
0946 F9                MOV     R1,A
0947 A3                INC     DPTR
0948 E0                MOVX    A,@DPTR
0949 FA                MOV     R2,A
094A A3                INC     DPTR
094B E0                MOVX    A,@DPTR
094C FB                MOV     R3,A
094D C3                CLR     C
094E 120000      E     LCALL   ?C?SLCMP
0951 500E              JNC     ?C0097
                                           ; SOURCE LINE # 705
0953 7F80              MOV     R7,#080H
0955 7E0F              MOV     R6,#0FH
0957 7D05              MOV     R5,#05H
0959 7CFD              MOV     R4,#0FDH
095B 900000      R     MOV     DPTR,#pos_error_sum
095E 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 706
0961         ?C0097:
                                           ; SOURCE LINE # 710
0961 E4                CLR     A
0962 F500        R     MOV     i_ref+03H,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 68  

0964 F500        R     MOV     i_ref+02H,A
0966 F500        R     MOV     i_ref+01H,A
0968 F500        R     MOV     i_ref,A
                                           ; SOURCE LINE # 713
096A FF                MOV     R7,A
096B FE                MOV     R6,A
096C FD                MOV     R5,A
096D FC                MOV     R4,A
096E AB00        R     MOV     R3,k_p_dl+03H
0970 AA00        R     MOV     R2,k_p_dl+02H
0972 A900        R     MOV     R1,k_p_dl+01H
0974 A800        R     MOV     R0,k_p_dl
0976 C3                CLR     C
0977 120000      E     LCALL   ?C?SLCMP
097A 6026              JZ      ?C0099
                                           ; SOURCE LINE # 714
097C AF00        R     MOV     R7,pos_error+03H
097E AE00        R     MOV     R6,pos_error+02H
0980 AD00        R     MOV     R5,pos_error+01H
0982 AC00        R     MOV     R4,pos_error
0984 A800        R     MOV     R0,k_p_dl
0986 120000      E     LCALL   ?C?LMUL
0989 780D              MOV     R0,#0DH
098B 120000      E     LCALL   ?C?SLSHR
098E E500        R     MOV     A,i_ref+03H
0990 2F                ADD     A,R7
0991 F500        R     MOV     i_ref+03H,A
0993 E500        R     MOV     A,i_ref+02H
0995 3E                ADDC    A,R6
0996 F500        R     MOV     i_ref+02H,A
0998 E500        R     MOV     A,i_ref+01H
099A 3D                ADDC    A,R5
099B F500        R     MOV     i_ref+01H,A
099D E500        R     MOV     A,i_ref
099F 3C                ADDC    A,R4
09A0 F500        R     MOV     i_ref,A
09A2         ?C0099:
                                           ; SOURCE LINE # 717
09A2 E4                CLR     A
09A3 FF                MOV     R7,A
09A4 FE                MOV     R6,A
09A5 FD                MOV     R5,A
09A6 FC                MOV     R4,A
09A7 AB00        R     MOV     R3,k_i_dl+03H
09A9 AA00        R     MOV     R2,k_i_dl+02H
09AB A900        R     MOV     R1,k_i_dl+01H
09AD A800        R     MOV     R0,k_i_dl
09AF C3                CLR     C
09B0 120000      E     LCALL   ?C?SLCMP
09B3 602C              JZ      ?C0100
                                           ; SOURCE LINE # 718
09B5 900000      R     MOV     DPTR,#pos_error_sum
09B8 E0                MOVX    A,@DPTR
09B9 FC                MOV     R4,A
09BA A3                INC     DPTR
09BB E0                MOVX    A,@DPTR
09BC FD                MOV     R5,A
09BD A3                INC     DPTR
09BE E0                MOVX    A,@DPTR
09BF FE                MOV     R6,A
09C0 A3                INC     DPTR
09C1 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 69  

09C2 FF                MOV     R7,A
09C3 A800        R     MOV     R0,k_i_dl
09C5 120000      E     LCALL   ?C?LMUL
09C8 780D              MOV     R0,#0DH
09CA 120000      E     LCALL   ?C?SLSHR
09CD E500        R     MOV     A,i_ref+03H
09CF 2F                ADD     A,R7
09D0 F500        R     MOV     i_ref+03H,A
09D2 E500        R     MOV     A,i_ref+02H
09D4 3E                ADDC    A,R6
09D5 F500        R     MOV     i_ref+02H,A
09D7 E500        R     MOV     A,i_ref+01H
09D9 3D                ADDC    A,R5
09DA F500        R     MOV     i_ref+01H,A
09DC E500        R     MOV     A,i_ref
09DE 3C                ADDC    A,R4
09DF F500        R     MOV     i_ref,A
09E1         ?C0100:
                                           ; SOURCE LINE # 721
09E1 E4                CLR     A
09E2 FF                MOV     R7,A
09E3 FE                MOV     R6,A
09E4 FD                MOV     R5,A
09E5 FC                MOV     R4,A
09E6 AB00        R     MOV     R3,k_d_dl+03H
09E8 AA00        R     MOV     R2,k_d_dl+02H
09EA A900        R     MOV     R1,k_d_dl+01H
09EC A800        R     MOV     R0,k_d_dl
09EE C3                CLR     C
09EF 120000      E     LCALL   ?C?SLCMP
09F2 6043              JZ      ?C0101
                                           ; SOURCE LINE # 722
09F4 900000      R     MOV     DPTR,#prev_pos_err
09F7 E0                MOVX    A,@DPTR
09F8 F8                MOV     R0,A
09F9 A3                INC     DPTR
09FA E0                MOVX    A,@DPTR
09FB F9                MOV     R1,A
09FC A3                INC     DPTR
09FD E0                MOVX    A,@DPTR
09FE FA                MOV     R2,A
09FF A3                INC     DPTR
0A00 E0                MOVX    A,@DPTR
0A01 FB                MOV     R3,A
0A02 C3                CLR     C
0A03 E500        R     MOV     A,pos_error+03H
0A05 9B                SUBB    A,R3
0A06 FF                MOV     R7,A
0A07 E500        R     MOV     A,pos_error+02H
0A09 9A                SUBB    A,R2
0A0A FE                MOV     R6,A
0A0B E500        R     MOV     A,pos_error+01H
0A0D 99                SUBB    A,R1
0A0E FD                MOV     R5,A
0A0F E500        R     MOV     A,pos_error
0A11 98                SUBB    A,R0
0A12 FC                MOV     R4,A
0A13 AB00        R     MOV     R3,k_d_dl+03H
0A15 AA00        R     MOV     R2,k_d_dl+02H
0A17 A900        R     MOV     R1,k_d_dl+01H
0A19 A800        R     MOV     R0,k_d_dl
0A1B 120000      E     LCALL   ?C?LMUL
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 70  

0A1E 780D              MOV     R0,#0DH
0A20 120000      E     LCALL   ?C?SLSHR
0A23 E500        R     MOV     A,i_ref+03H
0A25 2F                ADD     A,R7
0A26 F500        R     MOV     i_ref+03H,A
0A28 E500        R     MOV     A,i_ref+02H
0A2A 3E                ADDC    A,R6
0A2B F500        R     MOV     i_ref+02H,A
0A2D E500        R     MOV     A,i_ref+01H
0A2F 3D                ADDC    A,R5
0A30 F500        R     MOV     i_ref+01H,A
0A32 E500        R     MOV     A,i_ref
0A34 3C                ADDC    A,R4
0A35 F500        R     MOV     i_ref,A
0A37         ?C0101:
                                           ; SOURCE LINE # 725
0A37 AF00        R     MOV     R7,pos_error+03H
0A39 AE00        R     MOV     R6,pos_error+02H
0A3B AD00        R     MOV     R5,pos_error+01H
0A3D AC00        R     MOV     R4,pos_error
0A3F 900000      R     MOV     DPTR,#prev_pos_err
0A42 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 727
0A45 900000      E     MOV     DPTR,#g_ref+019H
0A48 E0                MOVX    A,@DPTR
0A49 FC                MOV     R4,A
0A4A A3                INC     DPTR
0A4B E0                MOVX    A,@DPTR
0A4C FD                MOV     R5,A
0A4D A3                INC     DPTR
0A4E E0                MOVX    A,@DPTR
0A4F FE                MOV     R6,A
0A50 A3                INC     DPTR
0A51 E0                MOVX    A,@DPTR
0A52 2500        R     ADD     A,i_ref+03H
0A54 F500        R     MOV     i_ref+03H,A
0A56 EE                MOV     A,R6
0A57 3500        R     ADDC    A,i_ref+02H
0A59 F500        R     MOV     i_ref+02H,A
0A5B ED                MOV     A,R5
0A5C 3500        R     ADDC    A,i_ref+01H
0A5E F500        R     MOV     i_ref+01H,A
0A60 EC                MOV     A,R4
0A61 3500        R     ADDC    A,i_ref
0A63 F500        R     MOV     i_ref,A
                                           ; SOURCE LINE # 730
0A65 E4                CLR     A
0A66 FF                MOV     R7,A
0A67 FE                MOV     R6,A
0A68 FD                MOV     R5,A
0A69 FC                MOV     R4,A
0A6A AB00        R     MOV     R3,i_ref+03H
0A6C AA00        R     MOV     R2,i_ref+02H
0A6E A900        R     MOV     R1,i_ref+01H
0A70 A800        R     MOV     R0,i_ref
0A72 C3                CLR     C
0A73 120000      E     LCALL   ?C?SLCMP
0A76 4004              JC      ?C0102
                                           ; SOURCE LINE # 731
0A78 D200        R     SETB    motor_dir
0A7A 8002              SJMP    ?C0103
0A7C         ?C0102:
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 71  

                                           ; SOURCE LINE # 733
0A7C C200        R     CLR     motor_dir
0A7E         ?C0103:
                                           ; SOURCE LINE # 736
0A7E 900000      E     MOV     DPTR,#c_mem+069H
0A81 E0                MOVX    A,@DPTR
0A82 FE                MOV     R6,A
0A83 A3                INC     DPTR
0A84 E0                MOVX    A,@DPTR
0A85 FF                MOV     R7,A
0A86 EE                MOV     A,R6
0A87 33                RLC     A
0A88 95E0              SUBB    A,ACC
0A8A FD                MOV     R5,A
0A8B FC                MOV     R4,A
0A8C AB00        R     MOV     R3,i_ref+03H
0A8E AA00        R     MOV     R2,i_ref+02H
0A90 A900        R     MOV     R1,i_ref+01H
0A92 A800        R     MOV     R0,i_ref
0A94 D3                SETB    C
0A95 120000      E     LCALL   ?C?SLCMP
0A98 4016              JC      ?C0104
                                           ; SOURCE LINE # 737
0A9A 900000      E     MOV     DPTR,#c_mem+069H
0A9D E0                MOVX    A,@DPTR
0A9E FE                MOV     R6,A
0A9F A3                INC     DPTR
0AA0 E0                MOVX    A,@DPTR
0AA1 FF                MOV     R7,A
0AA2 EE                MOV     A,R6
0AA3 33                RLC     A
0AA4 95E0              SUBB    A,ACC
0AA6 8F00        R     MOV     i_ref+03H,R7
0AA8 8E00        R     MOV     i_ref+02H,R6
0AAA F500        R     MOV     i_ref+01H,A
0AAC F500        R     MOV     i_ref,A
0AAE 803C              SJMP    ?C0105
0AB0         ?C0104:
                                           ; SOURCE LINE # 738
                                           ; SOURCE LINE # 739
0AB0 900000      E     MOV     DPTR,#c_mem+069H
0AB3 E0                MOVX    A,@DPTR
0AB4 FE                MOV     R6,A
0AB5 A3                INC     DPTR
0AB6 E0                MOVX    A,@DPTR
0AB7 FF                MOV     R7,A
0AB8 C3                CLR     C
0AB9 E4                CLR     A
0ABA 9F                SUBB    A,R7
0ABB FF                MOV     R7,A
0ABC E4                CLR     A
0ABD 9E                SUBB    A,R6
0ABE FE                MOV     R6,A
0ABF 33                RLC     A
0AC0 95E0              SUBB    A,ACC
0AC2 FD                MOV     R5,A
0AC3 FC                MOV     R4,A
0AC4 AB00        R     MOV     R3,i_ref+03H
0AC6 AA00        R     MOV     R2,i_ref+02H
0AC8 A900        R     MOV     R1,i_ref+01H
0ACA A800        R     MOV     R0,i_ref
0ACC C3                CLR     C
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 72  

0ACD 120000      E     LCALL   ?C?SLCMP
0AD0 501A              JNC     ?C0105
                                           ; SOURCE LINE # 740
0AD2 900000      E     MOV     DPTR,#c_mem+069H
0AD5 E0                MOVX    A,@DPTR
0AD6 FE                MOV     R6,A
0AD7 A3                INC     DPTR
0AD8 E0                MOVX    A,@DPTR
0AD9 FF                MOV     R7,A
0ADA C3                CLR     C
0ADB E4                CLR     A
0ADC 9F                SUBB    A,R7
0ADD FF                MOV     R7,A
0ADE E4                CLR     A
0ADF 9E                SUBB    A,R6
0AE0 FE                MOV     R6,A
0AE1 33                RLC     A
0AE2 95E0              SUBB    A,ACC
0AE4 8F00        R     MOV     i_ref+03H,R7
0AE6 8E00        R     MOV     i_ref+02H,R6
0AE8 F500        R     MOV     i_ref+01H,A
0AEA F500        R     MOV     i_ref,A
                                           ; SOURCE LINE # 741
0AEC         ?C0105:
                                           ; SOURCE LINE # 744
0AEC 900000      E     MOV     DPTR,#g_meas+0CH
0AEF E0                MOVX    A,@DPTR
0AF0 F8                MOV     R0,A
0AF1 A3                INC     DPTR
0AF2 E0                MOVX    A,@DPTR
0AF3 F9                MOV     R1,A
0AF4 A3                INC     DPTR
0AF5 E0                MOVX    A,@DPTR
0AF6 FA                MOV     R2,A
0AF7 A3                INC     DPTR
0AF8 E0                MOVX    A,@DPTR
0AF9 FB                MOV     R3,A
0AFA C3                CLR     C
0AFB E500        R     MOV     A,i_ref+03H
0AFD 9B                SUBB    A,R3
0AFE F500        R     MOV     curr_error+03H,A
0B00 E500        R     MOV     A,i_ref+02H
0B02 9A                SUBB    A,R2
0B03 F500        R     MOV     curr_error+02H,A
0B05 E500        R     MOV     A,i_ref+01H
0B07 99                SUBB    A,R1
0B08 F500        R     MOV     curr_error+01H,A
0B0A E500        R     MOV     A,i_ref
0B0C 98                SUBB    A,R0
0B0D F500        R     MOV     curr_error,A
                                           ; SOURCE LINE # 745
0B0F 900000      R     MOV     DPTR,#curr_error_sum
0B12 E0                MOVX    A,@DPTR
0B13 FC                MOV     R4,A
0B14 A3                INC     DPTR
0B15 E0                MOVX    A,@DPTR
0B16 FD                MOV     R5,A
0B17 A3                INC     DPTR
0B18 E0                MOVX    A,@DPTR
0B19 FE                MOV     R6,A
0B1A A3                INC     DPTR
0B1B E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 73  

0B1C 2500        R     ADD     A,curr_error+03H
0B1E FF                MOV     R7,A
0B1F EE                MOV     A,R6
0B20 3500        R     ADDC    A,curr_error+02H
0B22 FE                MOV     R6,A
0B23 ED                MOV     A,R5
0B24 3500        R     ADDC    A,curr_error+01H
0B26 FD                MOV     R5,A
0B27 EC                MOV     A,R4
0B28 3500        R     ADDC    A,curr_error
0B2A FC                MOV     R4,A
0B2B 900000      R     MOV     DPTR,#curr_error_sum
0B2E 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 747
0B31 7FA0              MOV     R7,#0A0H
0B33 7E86              MOV     R6,#086H
0B35 7D01              MOV     R5,#01H
0B37 7C00              MOV     R4,#00H
0B39 900000      R     MOV     DPTR,#curr_error_sum
0B3C E0                MOVX    A,@DPTR
0B3D F8                MOV     R0,A
0B3E A3                INC     DPTR
0B3F E0                MOVX    A,@DPTR
0B40 F9                MOV     R1,A
0B41 A3                INC     DPTR
0B42 E0                MOVX    A,@DPTR
0B43 FA                MOV     R2,A
0B44 A3                INC     DPTR
0B45 E0                MOVX    A,@DPTR
0B46 FB                MOV     R3,A
0B47 D3                SETB    C
0B48 120000      E     LCALL   ?C?SLCMP
0B4B 4010              JC      ?C0107
                                           ; SOURCE LINE # 748
0B4D 7FA0              MOV     R7,#0A0H
0B4F 7E86              MOV     R6,#086H
0B51 7D01              MOV     R5,#01H
0B53 7C00              MOV     R4,#00H
0B55 900000      R     MOV     DPTR,#curr_error_sum
0B58 120000      E     LCALL   ?C?LSTXDATA
0B5B 802A              SJMP    ?C0108
0B5D         ?C0107:
                                           ; SOURCE LINE # 749
                                           ; SOURCE LINE # 750
0B5D 7F60              MOV     R7,#060H
0B5F 7E79              MOV     R6,#079H
0B61 7DFE              MOV     R5,#0FEH
0B63 7CFF              MOV     R4,#0FFH
0B65 900000      R     MOV     DPTR,#curr_error_sum
0B68 E0                MOVX    A,@DPTR
0B69 F8                MOV     R0,A
0B6A A3                INC     DPTR
0B6B E0                MOVX    A,@DPTR
0B6C F9                MOV     R1,A
0B6D A3                INC     DPTR
0B6E E0                MOVX    A,@DPTR
0B6F FA                MOV     R2,A
0B70 A3                INC     DPTR
0B71 E0                MOVX    A,@DPTR
0B72 FB                MOV     R3,A
0B73 C3                CLR     C
0B74 120000      E     LCALL   ?C?SLCMP
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 74  

0B77 500E              JNC     ?C0108
                                           ; SOURCE LINE # 751
0B79 7F60              MOV     R7,#060H
0B7B 7E79              MOV     R6,#079H
0B7D 7DFE              MOV     R5,#0FEH
0B7F 7CFF              MOV     R4,#0FFH
0B81 900000      R     MOV     DPTR,#curr_error_sum
0B84 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 752
0B87         ?C0108:
                                           ; SOURCE LINE # 756
0B87 E4                CLR     A
0B88 F500        R     MOV     pwm_input+03H,A
0B8A F500        R     MOV     pwm_input+02H,A
0B8C F500        R     MOV     pwm_input+01H,A
0B8E F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 759
0B90 FF                MOV     R7,A
0B91 FE                MOV     R6,A
0B92 FD                MOV     R5,A
0B93 FC                MOV     R4,A
0B94 AB00        R     MOV     R3,k_p_c_dl+03H
0B96 AA00        R     MOV     R2,k_p_c_dl+02H
0B98 A900        R     MOV     R1,k_p_c_dl+01H
0B9A A800        R     MOV     R0,k_p_c_dl
0B9C C3                CLR     C
0B9D 120000      E     LCALL   ?C?SLCMP
0BA0 6026              JZ      ?C0110
                                           ; SOURCE LINE # 760
0BA2 AF00        R     MOV     R7,curr_error+03H
0BA4 AE00        R     MOV     R6,curr_error+02H
0BA6 AD00        R     MOV     R5,curr_error+01H
0BA8 AC00        R     MOV     R4,curr_error
0BAA A800        R     MOV     R0,k_p_c_dl
0BAC 120000      E     LCALL   ?C?LMUL
0BAF 780D              MOV     R0,#0DH
0BB1 120000      E     LCALL   ?C?SLSHR
0BB4 E500        R     MOV     A,pwm_input+03H
0BB6 2F                ADD     A,R7
0BB7 F500        R     MOV     pwm_input+03H,A
0BB9 E500        R     MOV     A,pwm_input+02H
0BBB 3E                ADDC    A,R6
0BBC F500        R     MOV     pwm_input+02H,A
0BBE E500        R     MOV     A,pwm_input+01H
0BC0 3D                ADDC    A,R5
0BC1 F500        R     MOV     pwm_input+01H,A
0BC3 E500        R     MOV     A,pwm_input
0BC5 3C                ADDC    A,R4
0BC6 F500        R     MOV     pwm_input,A
0BC8         ?C0110:
                                           ; SOURCE LINE # 763
0BC8 E4                CLR     A
0BC9 FF                MOV     R7,A
0BCA FE                MOV     R6,A
0BCB FD                MOV     R5,A
0BCC FC                MOV     R4,A
0BCD AB00        R     MOV     R3,k_i_c_dl+03H
0BCF AA00        R     MOV     R2,k_i_c_dl+02H
0BD1 A900        R     MOV     R1,k_i_c_dl+01H
0BD3 A800        R     MOV     R0,k_i_c_dl
0BD5 C3                CLR     C
0BD6 120000      E     LCALL   ?C?SLCMP
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 75  

0BD9 602C              JZ      ?C0111
                                           ; SOURCE LINE # 764
0BDB 900000      R     MOV     DPTR,#curr_error_sum
0BDE E0                MOVX    A,@DPTR
0BDF FC                MOV     R4,A
0BE0 A3                INC     DPTR
0BE1 E0                MOVX    A,@DPTR
0BE2 FD                MOV     R5,A
0BE3 A3                INC     DPTR
0BE4 E0                MOVX    A,@DPTR
0BE5 FE                MOV     R6,A
0BE6 A3                INC     DPTR
0BE7 E0                MOVX    A,@DPTR
0BE8 FF                MOV     R7,A
0BE9 A800        R     MOV     R0,k_i_c_dl
0BEB 120000      E     LCALL   ?C?LMUL
0BEE 780D              MOV     R0,#0DH
0BF0 120000      E     LCALL   ?C?SLSHR
0BF3 E500        R     MOV     A,pwm_input+03H
0BF5 2F                ADD     A,R7
0BF6 F500        R     MOV     pwm_input+03H,A
0BF8 E500        R     MOV     A,pwm_input+02H
0BFA 3E                ADDC    A,R6
0BFB F500        R     MOV     pwm_input+02H,A
0BFD E500        R     MOV     A,pwm_input+01H
0BFF 3D                ADDC    A,R5
0C00 F500        R     MOV     pwm_input+01H,A
0C02 E500        R     MOV     A,pwm_input
0C04 3C                ADDC    A,R4
0C05 F500        R     MOV     pwm_input,A
0C07         ?C0111:
                                           ; SOURCE LINE # 767
0C07 E4                CLR     A
0C08 FF                MOV     R7,A
0C09 FE                MOV     R6,A
0C0A FD                MOV     R5,A
0C0B FC                MOV     R4,A
0C0C AB00        R     MOV     R3,k_d_c_dl+03H
0C0E AA00        R     MOV     R2,k_d_c_dl+02H
0C10 A900        R     MOV     R1,k_d_c_dl+01H
0C12 A800        R     MOV     R0,k_d_c_dl
0C14 C3                CLR     C
0C15 120000      E     LCALL   ?C?SLCMP
0C18 6043              JZ      ?C0112
                                           ; SOURCE LINE # 768
0C1A 900000      R     MOV     DPTR,#prev_curr_err
0C1D E0                MOVX    A,@DPTR
0C1E F8                MOV     R0,A
0C1F A3                INC     DPTR
0C20 E0                MOVX    A,@DPTR
0C21 F9                MOV     R1,A
0C22 A3                INC     DPTR
0C23 E0                MOVX    A,@DPTR
0C24 FA                MOV     R2,A
0C25 A3                INC     DPTR
0C26 E0                MOVX    A,@DPTR
0C27 FB                MOV     R3,A
0C28 C3                CLR     C
0C29 E500        R     MOV     A,curr_error+03H
0C2B 9B                SUBB    A,R3
0C2C FF                MOV     R7,A
0C2D E500        R     MOV     A,curr_error+02H
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 76  

0C2F 9A                SUBB    A,R2
0C30 FE                MOV     R6,A
0C31 E500        R     MOV     A,curr_error+01H
0C33 99                SUBB    A,R1
0C34 FD                MOV     R5,A
0C35 E500        R     MOV     A,curr_error
0C37 98                SUBB    A,R0
0C38 FC                MOV     R4,A
0C39 AB00        R     MOV     R3,k_d_c_dl+03H
0C3B AA00        R     MOV     R2,k_d_c_dl+02H
0C3D A900        R     MOV     R1,k_d_c_dl+01H
0C3F A800        R     MOV     R0,k_d_c_dl
0C41 120000      E     LCALL   ?C?LMUL
0C44 780D              MOV     R0,#0DH
0C46 120000      E     LCALL   ?C?SLSHR
0C49 E500        R     MOV     A,pwm_input+03H
0C4B 2F                ADD     A,R7
0C4C F500        R     MOV     pwm_input+03H,A
0C4E E500        R     MOV     A,pwm_input+02H
0C50 3E                ADDC    A,R6
0C51 F500        R     MOV     pwm_input+02H,A
0C53 E500        R     MOV     A,pwm_input+01H
0C55 3D                ADDC    A,R5
0C56 F500        R     MOV     pwm_input+01H,A
0C58 E500        R     MOV     A,pwm_input
0C5A 3C                ADDC    A,R4
0C5B F500        R     MOV     pwm_input,A
0C5D         ?C0112:
                                           ; SOURCE LINE # 771
0C5D 74FF              MOV     A,#0FFH
0C5F 7F9C              MOV     R7,#09CH
0C61 FE                MOV     R6,A
0C62 FD                MOV     R5,A
0C63 FC                MOV     R4,A
0C64 AB00        R     MOV     R3,pwm_input+03H
0C66 AA00        R     MOV     R2,pwm_input+02H
0C68 A900        R     MOV     R1,pwm_input+01H
0C6A A800        R     MOV     R0,pwm_input
0C6C C3                CLR     C
0C6D 120000      E     LCALL   ?C?SLCMP
0C70 500D              JNC     ?C0113
                                           ; SOURCE LINE # 772
0C72 74FF              MOV     A,#0FFH
0C74 75009C      R     MOV     pwm_input+03H,#09CH
0C77 F500        R     MOV     pwm_input+02H,A
0C79 F500        R     MOV     pwm_input+01H,A
0C7B F500        R     MOV     pwm_input,A
0C7D 801E              SJMP    ?C0114
0C7F         ?C0113:
                                           ; SOURCE LINE # 773
                                           ; SOURCE LINE # 774
0C7F E4                CLR     A
0C80 7F64              MOV     R7,#064H
0C82 FE                MOV     R6,A
0C83 FD                MOV     R5,A
0C84 FC                MOV     R4,A
0C85 AB00        R     MOV     R3,pwm_input+03H
0C87 AA00        R     MOV     R2,pwm_input+02H
0C89 A900        R     MOV     R1,pwm_input+01H
0C8B A800        R     MOV     R0,pwm_input
0C8D D3                SETB    C
0C8E 120000      E     LCALL   ?C?SLCMP
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 77  

0C91 400A              JC      ?C0114
                                           ; SOURCE LINE # 775
0C93 E4                CLR     A
0C94 750064      R     MOV     pwm_input+03H,#064H
0C97 F500        R     MOV     pwm_input+02H,A
0C99 F500        R     MOV     pwm_input+01H,A
0C9B F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 776
0C9D         ?C0114:
                                           ; SOURCE LINE # 779
0C9D AF00        R     MOV     R7,curr_error+03H
0C9F AE00        R     MOV     R6,curr_error+02H
0CA1 AD00        R     MOV     R5,curr_error+01H
0CA3 AC00        R     MOV     R4,curr_error
0CA5 900000      R     MOV     DPTR,#prev_curr_err
0CA8 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 781
0CAB 020000      R     LJMP    ?C0091
                                           ; SOURCE LINE # 784
0CAE         ?C0116:
                                           ; SOURCE LINE # 785
0CAE 900000      E     MOV     DPTR,#g_meas
0CB1 E0                MOVX    A,@DPTR
0CB2 F8                MOV     R0,A
0CB3 A3                INC     DPTR
0CB4 E0                MOVX    A,@DPTR
0CB5 F9                MOV     R1,A
0CB6 A3                INC     DPTR
0CB7 E0                MOVX    A,@DPTR
0CB8 FA                MOV     R2,A
0CB9 A3                INC     DPTR
0CBA E0                MOVX    A,@DPTR
0CBB FB                MOV     R3,A
0CBC 900000      E     MOV     DPTR,#g_ref
0CBF E0                MOVX    A,@DPTR
0CC0 FC                MOV     R4,A
0CC1 A3                INC     DPTR
0CC2 E0                MOVX    A,@DPTR
0CC3 FD                MOV     R5,A
0CC4 A3                INC     DPTR
0CC5 E0                MOVX    A,@DPTR
0CC6 FE                MOV     R6,A
0CC7 A3                INC     DPTR
0CC8 E0                MOVX    A,@DPTR
0CC9 C3                CLR     C
0CCA 9B                SUBB    A,R3
0CCB F500        R     MOV     pos_error+03H,A
0CCD EE                MOV     A,R6
0CCE 9A                SUBB    A,R2
0CCF F500        R     MOV     pos_error+02H,A
0CD1 ED                MOV     A,R5
0CD2 99                SUBB    A,R1
0CD3 F500        R     MOV     pos_error+01H,A
0CD5 EC                MOV     A,R4
0CD6 98                SUBB    A,R0
0CD7 F500        R     MOV     pos_error,A
                                           ; SOURCE LINE # 787
0CD9 900000      R     MOV     DPTR,#pos_error_sum
0CDC E0                MOVX    A,@DPTR
0CDD FC                MOV     R4,A
0CDE A3                INC     DPTR
0CDF E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 78  

0CE0 FD                MOV     R5,A
0CE1 A3                INC     DPTR
0CE2 E0                MOVX    A,@DPTR
0CE3 FE                MOV     R6,A
0CE4 A3                INC     DPTR
0CE5 E0                MOVX    A,@DPTR
0CE6 2500        R     ADD     A,pos_error+03H
0CE8 FF                MOV     R7,A
0CE9 EE                MOV     A,R6
0CEA 3500        R     ADDC    A,pos_error+02H
0CEC FE                MOV     R6,A
0CED ED                MOV     A,R5
0CEE 3500        R     ADDC    A,pos_error+01H
0CF0 FD                MOV     R5,A
0CF1 EC                MOV     A,R4
0CF2 3500        R     ADDC    A,pos_error
0CF4 FC                MOV     R4,A
0CF5 900000      R     MOV     DPTR,#pos_error_sum
0CF8 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 790
0CFB E4                CLR     A
0CFC 7FE8              MOV     R7,#0E8H
0CFE 7E03              MOV     R6,#03H
0D00 FD                MOV     R5,A
0D01 FC                MOV     R4,A
0D02 900000      R     MOV     DPTR,#pos_error_sum
0D05 E0                MOVX    A,@DPTR
0D06 F8                MOV     R0,A
0D07 A3                INC     DPTR
0D08 E0                MOVX    A,@DPTR
0D09 F9                MOV     R1,A
0D0A A3                INC     DPTR
0D0B E0                MOVX    A,@DPTR
0D0C FA                MOV     R2,A
0D0D A3                INC     DPTR
0D0E E0                MOVX    A,@DPTR
0D0F FB                MOV     R3,A
0D10 D3                SETB    C
0D11 120000      E     LCALL   ?C?SLCMP
0D14 400F              JC      ?C0117
                                           ; SOURCE LINE # 791
0D16 E4                CLR     A
0D17 7FE8              MOV     R7,#0E8H
0D19 7E03              MOV     R6,#03H
0D1B FD                MOV     R5,A
0D1C FC                MOV     R4,A
0D1D 900000      R     MOV     DPTR,#pos_error_sum
0D20 120000      E     LCALL   ?C?LSTXDATA
0D23 802A              SJMP    ?C0118
0D25         ?C0117:
                                           ; SOURCE LINE # 792
                                           ; SOURCE LINE # 793
0D25 7F18              MOV     R7,#018H
0D27 7EFC              MOV     R6,#0FCH
0D29 7DFF              MOV     R5,#0FFH
0D2B 7CFF              MOV     R4,#0FFH
0D2D 900000      R     MOV     DPTR,#pos_error_sum
0D30 E0                MOVX    A,@DPTR
0D31 F8                MOV     R0,A
0D32 A3                INC     DPTR
0D33 E0                MOVX    A,@DPTR
0D34 F9                MOV     R1,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 79  

0D35 A3                INC     DPTR
0D36 E0                MOVX    A,@DPTR
0D37 FA                MOV     R2,A
0D38 A3                INC     DPTR
0D39 E0                MOVX    A,@DPTR
0D3A FB                MOV     R3,A
0D3B C3                CLR     C
0D3C 120000      E     LCALL   ?C?SLCMP
0D3F 500E              JNC     ?C0118
                                           ; SOURCE LINE # 794
0D41 7F18              MOV     R7,#018H
0D43 7EFC              MOV     R6,#0FCH
0D45 7DFF              MOV     R5,#0FFH
0D47 7CFF              MOV     R4,#0FFH
0D49 900000      R     MOV     DPTR,#pos_error_sum
0D4C 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 795
0D4F         ?C0118:
                                           ; SOURCE LINE # 798
0D4F E4                CLR     A
0D50 FF                MOV     R7,A
0D51 FE                MOV     R6,A
0D52 FD                MOV     R5,A
0D53 FC                MOV     R4,A
0D54 AB00        R     MOV     R3,k_p+03H
0D56 AA00        R     MOV     R2,k_p+02H
0D58 A900        R     MOV     R1,k_p+01H
0D5A A800        R     MOV     R0,k_p
0D5C C3                CLR     C
0D5D 120000      E     LCALL   ?C?SLCMP
0D60 601A              JZ      ?C0120
                                           ; SOURCE LINE # 799
0D62 AF00        R     MOV     R7,pos_error+03H
0D64 AE00        R     MOV     R6,pos_error+02H
0D66 AD00        R     MOV     R5,pos_error+01H
0D68 AC00        R     MOV     R4,pos_error
0D6A A800        R     MOV     R0,k_p
0D6C 120000      E     LCALL   ?C?LMUL
0D6F 7810              MOV     R0,#010H
0D71 120000      E     LCALL   ?C?SLSHR
0D74 8F00        R     MOV     pwm_input+03H,R7
0D76 8E00        R     MOV     pwm_input+02H,R6
0D78 8D00        R     MOV     pwm_input+01H,R5
0D7A 8C00        R     MOV     pwm_input,R4
0D7C         ?C0120:
                                           ; SOURCE LINE # 803
0D7C E4                CLR     A
0D7D FF                MOV     R7,A
0D7E FE                MOV     R6,A
0D7F FD                MOV     R5,A
0D80 FC                MOV     R4,A
0D81 AB00        R     MOV     R3,k_i+03H
0D83 AA00        R     MOV     R2,k_i+02H
0D85 A900        R     MOV     R1,k_i+01H
0D87 A800        R     MOV     R0,k_i
0D89 C3                CLR     C
0D8A 120000      E     LCALL   ?C?SLCMP
0D8D 602C              JZ      ?C0121
                                           ; SOURCE LINE # 804
0D8F 900000      R     MOV     DPTR,#pos_error_sum
0D92 E0                MOVX    A,@DPTR
0D93 FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 80  

0D94 A3                INC     DPTR
0D95 E0                MOVX    A,@DPTR
0D96 FD                MOV     R5,A
0D97 A3                INC     DPTR
0D98 E0                MOVX    A,@DPTR
0D99 FE                MOV     R6,A
0D9A A3                INC     DPTR
0D9B E0                MOVX    A,@DPTR
0D9C FF                MOV     R7,A
0D9D A800        R     MOV     R0,k_i
0D9F 120000      E     LCALL   ?C?LMUL
0DA2 7810              MOV     R0,#010H
0DA4 120000      E     LCALL   ?C?SLSHR
0DA7 E500        R     MOV     A,pwm_input+03H
0DA9 2F                ADD     A,R7
0DAA F500        R     MOV     pwm_input+03H,A
0DAC E500        R     MOV     A,pwm_input+02H
0DAE 3E                ADDC    A,R6
0DAF F500        R     MOV     pwm_input+02H,A
0DB1 E500        R     MOV     A,pwm_input+01H
0DB3 3D                ADDC    A,R5
0DB4 F500        R     MOV     pwm_input+01H,A
0DB6 E500        R     MOV     A,pwm_input
0DB8 3C                ADDC    A,R4
0DB9 F500        R     MOV     pwm_input,A
0DBB         ?C0121:
                                           ; SOURCE LINE # 808
0DBB E4                CLR     A
0DBC FF                MOV     R7,A
0DBD FE                MOV     R6,A
0DBE FD                MOV     R5,A
0DBF FC                MOV     R4,A
0DC0 AB00        R     MOV     R3,k_d+03H
0DC2 AA00        R     MOV     R2,k_d+02H
0DC4 A900        R     MOV     R1,k_d+01H
0DC6 A800        R     MOV     R0,k_d
0DC8 C3                CLR     C
0DC9 120000      E     LCALL   ?C?SLCMP
0DCC 6043              JZ      ?C0122
                                           ; SOURCE LINE # 809
0DCE 900000      R     MOV     DPTR,#prev_pos_err
0DD1 E0                MOVX    A,@DPTR
0DD2 F8                MOV     R0,A
0DD3 A3                INC     DPTR
0DD4 E0                MOVX    A,@DPTR
0DD5 F9                MOV     R1,A
0DD6 A3                INC     DPTR
0DD7 E0                MOVX    A,@DPTR
0DD8 FA                MOV     R2,A
0DD9 A3                INC     DPTR
0DDA E0                MOVX    A,@DPTR
0DDB FB                MOV     R3,A
0DDC C3                CLR     C
0DDD E500        R     MOV     A,pos_error+03H
0DDF 9B                SUBB    A,R3
0DE0 FF                MOV     R7,A
0DE1 E500        R     MOV     A,pos_error+02H
0DE3 9A                SUBB    A,R2
0DE4 FE                MOV     R6,A
0DE5 E500        R     MOV     A,pos_error+01H
0DE7 99                SUBB    A,R1
0DE8 FD                MOV     R5,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 81  

0DE9 E500        R     MOV     A,pos_error
0DEB 98                SUBB    A,R0
0DEC FC                MOV     R4,A
0DED AB00        R     MOV     R3,k_d+03H
0DEF AA00        R     MOV     R2,k_d+02H
0DF1 A900        R     MOV     R1,k_d+01H
0DF3 A800        R     MOV     R0,k_d
0DF5 120000      E     LCALL   ?C?LMUL
0DF8 7810              MOV     R0,#010H
0DFA 120000      E     LCALL   ?C?SLSHR
0DFD E500        R     MOV     A,pwm_input+03H
0DFF 2F                ADD     A,R7
0E00 F500        R     MOV     pwm_input+03H,A
0E02 E500        R     MOV     A,pwm_input+02H
0E04 3E                ADDC    A,R6
0E05 F500        R     MOV     pwm_input+02H,A
0E07 E500        R     MOV     A,pwm_input+01H
0E09 3D                ADDC    A,R5
0E0A F500        R     MOV     pwm_input+01H,A
0E0C E500        R     MOV     A,pwm_input
0E0E 3C                ADDC    A,R4
0E0F F500        R     MOV     pwm_input,A
0E11         ?C0122:
                                           ; SOURCE LINE # 813
0E11 AF00        R     MOV     R7,pos_error+03H
0E13 AE00        R     MOV     R6,pos_error+02H
0E15 AD00        R     MOV     R5,pos_error+01H
0E17 AC00        R     MOV     R4,pos_error
0E19 900000      R     MOV     DPTR,#prev_pos_err
0E1C 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 815
0E1F E4                CLR     A
0E20 FF                MOV     R7,A
0E21 FE                MOV     R6,A
0E22 FD                MOV     R5,A
0E23 FC                MOV     R4,A
0E24 AB00        R     MOV     R3,pwm_input+03H
0E26 AA00        R     MOV     R2,pwm_input+02H
0E28 A900        R     MOV     R1,pwm_input+01H
0E2A A800        R     MOV     R0,pwm_input
0E2C D3                SETB    C
0E2D 120000      E     LCALL   ?C?SLCMP
0E30 4005              JC      ?C0123
                                           ; SOURCE LINE # 816
0E32 D200        R     SETB    motor_dir
0E34 020000      R     LJMP    ?C0091
0E37         ?C0123:
                                           ; SOURCE LINE # 818
0E37 C200        R     CLR     motor_dir
                                           ; SOURCE LINE # 820
0E39 020000      R     LJMP    ?C0091
                                           ; SOURCE LINE # 823
0E3C         ?C0125:
                                           ; SOURCE LINE # 824
0E3C 900000      E     MOV     DPTR,#g_ref+018H
0E3F E0                MOVX    A,@DPTR
0E40 7003              JNZ     $ + 5H
0E42 020000      R     LJMP    ?C0091
0E45 200003      E     JB      tension_valid,$ + 6H
0E48 020000      R     LJMP    ?C0091
                                           ; SOURCE LINE # 826
0E4B 900000      E     MOV     DPTR,#g_ref+08H
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 82  

0E4E E0                MOVX    A,@DPTR
0E4F FC                MOV     R4,A
0E50 A3                INC     DPTR
0E51 E0                MOVX    A,@DPTR
0E52 FD                MOV     R5,A
0E53 A3                INC     DPTR
0E54 E0                MOVX    A,@DPTR
0E55 FE                MOV     R6,A
0E56 A3                INC     DPTR
0E57 E0                MOVX    A,@DPTR
0E58 F500        R     MOV     i_ref+03H,A
0E5A 8E00        R     MOV     i_ref+02H,R6
0E5C 8D00        R     MOV     i_ref+01H,R5
0E5E 8C00        R     MOV     i_ref,R4
                                           ; SOURCE LINE # 828
0E60 900000      E     MOV     DPTR,#c_mem+069H
0E63 E0                MOVX    A,@DPTR
0E64 FE                MOV     R6,A
0E65 A3                INC     DPTR
0E66 E0                MOVX    A,@DPTR
0E67 FF                MOV     R7,A
0E68 EE                MOV     A,R6
0E69 33                RLC     A
0E6A 95E0              SUBB    A,ACC
0E6C FD                MOV     R5,A
0E6D FC                MOV     R4,A
0E6E AB00        R     MOV     R3,i_ref+03H
0E70 AA00        R     MOV     R2,i_ref+02H
0E72 A900        R     MOV     R1,i_ref+01H
0E74 A800        R     MOV     R0,i_ref
0E76 D3                SETB    C
0E77 120000      E     LCALL   ?C?SLCMP
0E7A 4016              JC      ?C0127
                                           ; SOURCE LINE # 829
0E7C 900000      E     MOV     DPTR,#c_mem+069H
0E7F E0                MOVX    A,@DPTR
0E80 FE                MOV     R6,A
0E81 A3                INC     DPTR
0E82 E0                MOVX    A,@DPTR
0E83 FF                MOV     R7,A
0E84 EE                MOV     A,R6
0E85 33                RLC     A
0E86 95E0              SUBB    A,ACC
0E88 8F00        R     MOV     i_ref+03H,R7
0E8A 8E00        R     MOV     i_ref+02H,R6
0E8C F500        R     MOV     i_ref+01H,A
0E8E F500        R     MOV     i_ref,A
0E90 803C              SJMP    ?C0128
0E92         ?C0127:
                                           ; SOURCE LINE # 830
                                           ; SOURCE LINE # 831
0E92 900000      E     MOV     DPTR,#c_mem+069H
0E95 E0                MOVX    A,@DPTR
0E96 FE                MOV     R6,A
0E97 A3                INC     DPTR
0E98 E0                MOVX    A,@DPTR
0E99 FF                MOV     R7,A
0E9A C3                CLR     C
0E9B E4                CLR     A
0E9C 9F                SUBB    A,R7
0E9D FF                MOV     R7,A
0E9E E4                CLR     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 83  

0E9F 9E                SUBB    A,R6
0EA0 FE                MOV     R6,A
0EA1 33                RLC     A
0EA2 95E0              SUBB    A,ACC
0EA4 FD                MOV     R5,A
0EA5 FC                MOV     R4,A
0EA6 AB00        R     MOV     R3,i_ref+03H
0EA8 AA00        R     MOV     R2,i_ref+02H
0EAA A900        R     MOV     R1,i_ref+01H
0EAC A800        R     MOV     R0,i_ref
0EAE C3                CLR     C
0EAF 120000      E     LCALL   ?C?SLCMP
0EB2 501A              JNC     ?C0128
                                           ; SOURCE LINE # 832
0EB4 900000      E     MOV     DPTR,#c_mem+069H
0EB7 E0                MOVX    A,@DPTR
0EB8 FE                MOV     R6,A
0EB9 A3                INC     DPTR
0EBA E0                MOVX    A,@DPTR
0EBB FF                MOV     R7,A
0EBC C3                CLR     C
0EBD E4                CLR     A
0EBE 9F                SUBB    A,R7
0EBF FF                MOV     R7,A
0EC0 E4                CLR     A
0EC1 9E                SUBB    A,R6
0EC2 FE                MOV     R6,A
0EC3 33                RLC     A
0EC4 95E0              SUBB    A,ACC
0EC6 8F00        R     MOV     i_ref+03H,R7
0EC8 8E00        R     MOV     i_ref+02H,R6
0ECA F500        R     MOV     i_ref+01H,A
0ECC F500        R     MOV     i_ref,A
                                           ; SOURCE LINE # 833
0ECE         ?C0128:
                                           ; SOURCE LINE # 836
0ECE 900000      E     MOV     DPTR,#g_meas+0CH
0ED1 E0                MOVX    A,@DPTR
0ED2 F8                MOV     R0,A
0ED3 A3                INC     DPTR
0ED4 E0                MOVX    A,@DPTR
0ED5 F9                MOV     R1,A
0ED6 A3                INC     DPTR
0ED7 E0                MOVX    A,@DPTR
0ED8 FA                MOV     R2,A
0ED9 A3                INC     DPTR
0EDA E0                MOVX    A,@DPTR
0EDB FB                MOV     R3,A
0EDC C3                CLR     C
0EDD E500        R     MOV     A,i_ref+03H
0EDF 9B                SUBB    A,R3
0EE0 F500        R     MOV     curr_error+03H,A
0EE2 E500        R     MOV     A,i_ref+02H
0EE4 9A                SUBB    A,R2
0EE5 F500        R     MOV     curr_error+02H,A
0EE7 E500        R     MOV     A,i_ref+01H
0EE9 99                SUBB    A,R1
0EEA F500        R     MOV     curr_error+01H,A
0EEC E500        R     MOV     A,i_ref
0EEE 98                SUBB    A,R0
0EEF F500        R     MOV     curr_error,A
                                           ; SOURCE LINE # 837
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 84  

0EF1 900000      R     MOV     DPTR,#curr_error_sum
0EF4 E0                MOVX    A,@DPTR
0EF5 FC                MOV     R4,A
0EF6 A3                INC     DPTR
0EF7 E0                MOVX    A,@DPTR
0EF8 FD                MOV     R5,A
0EF9 A3                INC     DPTR
0EFA E0                MOVX    A,@DPTR
0EFB FE                MOV     R6,A
0EFC A3                INC     DPTR
0EFD E0                MOVX    A,@DPTR
0EFE 2500        R     ADD     A,curr_error+03H
0F00 FF                MOV     R7,A
0F01 EE                MOV     A,R6
0F02 3500        R     ADDC    A,curr_error+02H
0F04 FE                MOV     R6,A
0F05 ED                MOV     A,R5
0F06 3500        R     ADDC    A,curr_error+01H
0F08 FD                MOV     R5,A
0F09 EC                MOV     A,R4
0F0A 3500        R     ADDC    A,curr_error
0F0C FC                MOV     R4,A
0F0D 900000      R     MOV     DPTR,#curr_error_sum
0F10 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 839
0F13 7FA0              MOV     R7,#0A0H
0F15 7E86              MOV     R6,#086H
0F17 7D01              MOV     R5,#01H
0F19 7C00              MOV     R4,#00H
0F1B 900000      R     MOV     DPTR,#curr_error_sum
0F1E E0                MOVX    A,@DPTR
0F1F F8                MOV     R0,A
0F20 A3                INC     DPTR
0F21 E0                MOVX    A,@DPTR
0F22 F9                MOV     R1,A
0F23 A3                INC     DPTR
0F24 E0                MOVX    A,@DPTR
0F25 FA                MOV     R2,A
0F26 A3                INC     DPTR
0F27 E0                MOVX    A,@DPTR
0F28 FB                MOV     R3,A
0F29 D3                SETB    C
0F2A 120000      E     LCALL   ?C?SLCMP
0F2D 4010              JC      ?C0130
                                           ; SOURCE LINE # 840
0F2F 7FA0              MOV     R7,#0A0H
0F31 7E86              MOV     R6,#086H
0F33 7D01              MOV     R5,#01H
0F35 7C00              MOV     R4,#00H
0F37 900000      R     MOV     DPTR,#curr_error_sum
0F3A 120000      E     LCALL   ?C?LSTXDATA
0F3D 802A              SJMP    ?C0131
0F3F         ?C0130:
                                           ; SOURCE LINE # 841
                                           ; SOURCE LINE # 842
0F3F 7F60              MOV     R7,#060H
0F41 7E79              MOV     R6,#079H
0F43 7DFE              MOV     R5,#0FEH
0F45 7CFF              MOV     R4,#0FFH
0F47 900000      R     MOV     DPTR,#curr_error_sum
0F4A E0                MOVX    A,@DPTR
0F4B F8                MOV     R0,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 85  

0F4C A3                INC     DPTR
0F4D E0                MOVX    A,@DPTR
0F4E F9                MOV     R1,A
0F4F A3                INC     DPTR
0F50 E0                MOVX    A,@DPTR
0F51 FA                MOV     R2,A
0F52 A3                INC     DPTR
0F53 E0                MOVX    A,@DPTR
0F54 FB                MOV     R3,A
0F55 C3                CLR     C
0F56 120000      E     LCALL   ?C?SLCMP
0F59 500E              JNC     ?C0131
                                           ; SOURCE LINE # 843
0F5B 7F60              MOV     R7,#060H
0F5D 7E79              MOV     R6,#079H
0F5F 7DFE              MOV     R5,#0FEH
0F61 7CFF              MOV     R4,#0FFH
0F63 900000      R     MOV     DPTR,#curr_error_sum
0F66 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 844
0F69         ?C0131:
                                           ; SOURCE LINE # 846
0F69 E4                CLR     A
0F6A F500        R     MOV     pwm_input+03H,A
0F6C F500        R     MOV     pwm_input+02H,A
0F6E F500        R     MOV     pwm_input+01H,A
0F70 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 849
0F72 FF                MOV     R7,A
0F73 FE                MOV     R6,A
0F74 FD                MOV     R5,A
0F75 FC                MOV     R4,A
0F76 AB00        R     MOV     R3,k_p_c+03H
0F78 AA00        R     MOV     R2,k_p_c+02H
0F7A A900        R     MOV     R1,k_p_c+01H
0F7C A800        R     MOV     R0,k_p_c
0F7E C3                CLR     C
0F7F 120000      E     LCALL   ?C?SLCMP
0F82 6026              JZ      ?C0133
                                           ; SOURCE LINE # 850
0F84 AF00        R     MOV     R7,curr_error+03H
0F86 AE00        R     MOV     R6,curr_error+02H
0F88 AD00        R     MOV     R5,curr_error+01H
0F8A AC00        R     MOV     R4,curr_error
0F8C A800        R     MOV     R0,k_p_c
0F8E 120000      E     LCALL   ?C?LMUL
0F91 7810              MOV     R0,#010H
0F93 120000      E     LCALL   ?C?SLSHR
0F96 E500        R     MOV     A,pwm_input+03H
0F98 2F                ADD     A,R7
0F99 F500        R     MOV     pwm_input+03H,A
0F9B E500        R     MOV     A,pwm_input+02H
0F9D 3E                ADDC    A,R6
0F9E F500        R     MOV     pwm_input+02H,A
0FA0 E500        R     MOV     A,pwm_input+01H
0FA2 3D                ADDC    A,R5
0FA3 F500        R     MOV     pwm_input+01H,A
0FA5 E500        R     MOV     A,pwm_input
0FA7 3C                ADDC    A,R4
0FA8 F500        R     MOV     pwm_input,A
0FAA         ?C0133:
                                           ; SOURCE LINE # 853
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 86  

0FAA E4                CLR     A
0FAB FF                MOV     R7,A
0FAC FE                MOV     R6,A
0FAD FD                MOV     R5,A
0FAE FC                MOV     R4,A
0FAF AB00        R     MOV     R3,k_i_c+03H
0FB1 AA00        R     MOV     R2,k_i_c+02H
0FB3 A900        R     MOV     R1,k_i_c+01H
0FB5 A800        R     MOV     R0,k_i_c
0FB7 C3                CLR     C
0FB8 120000      E     LCALL   ?C?SLCMP
0FBB 602C              JZ      ?C0134
                                           ; SOURCE LINE # 854
0FBD 900000      R     MOV     DPTR,#curr_error_sum
0FC0 E0                MOVX    A,@DPTR
0FC1 FC                MOV     R4,A
0FC2 A3                INC     DPTR
0FC3 E0                MOVX    A,@DPTR
0FC4 FD                MOV     R5,A
0FC5 A3                INC     DPTR
0FC6 E0                MOVX    A,@DPTR
0FC7 FE                MOV     R6,A
0FC8 A3                INC     DPTR
0FC9 E0                MOVX    A,@DPTR
0FCA FF                MOV     R7,A
0FCB A800        R     MOV     R0,k_i_c
0FCD 120000      E     LCALL   ?C?LMUL
0FD0 7810              MOV     R0,#010H
0FD2 120000      E     LCALL   ?C?SLSHR
0FD5 E500        R     MOV     A,pwm_input+03H
0FD7 2F                ADD     A,R7
0FD8 F500        R     MOV     pwm_input+03H,A
0FDA E500        R     MOV     A,pwm_input+02H
0FDC 3E                ADDC    A,R6
0FDD F500        R     MOV     pwm_input+02H,A
0FDF E500        R     MOV     A,pwm_input+01H
0FE1 3D                ADDC    A,R5
0FE2 F500        R     MOV     pwm_input+01H,A
0FE4 E500        R     MOV     A,pwm_input
0FE6 3C                ADDC    A,R4
0FE7 F500        R     MOV     pwm_input,A
0FE9         ?C0134:
                                           ; SOURCE LINE # 857
0FE9 E4                CLR     A
0FEA FF                MOV     R7,A
0FEB FE                MOV     R6,A
0FEC FD                MOV     R5,A
0FED FC                MOV     R4,A
0FEE AB00        R     MOV     R3,k_d_c+03H
0FF0 AA00        R     MOV     R2,k_d_c+02H
0FF2 A900        R     MOV     R1,k_d_c+01H
0FF4 A800        R     MOV     R0,k_d_c
0FF6 C3                CLR     C
0FF7 120000      E     LCALL   ?C?SLCMP
0FFA 6043              JZ      ?C0135
                                           ; SOURCE LINE # 858
0FFC 900000      R     MOV     DPTR,#prev_curr_err
0FFF E0                MOVX    A,@DPTR
1000 F8                MOV     R0,A
1001 A3                INC     DPTR
1002 E0                MOVX    A,@DPTR
1003 F9                MOV     R1,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 87  

1004 A3                INC     DPTR
1005 E0                MOVX    A,@DPTR
1006 FA                MOV     R2,A
1007 A3                INC     DPTR
1008 E0                MOVX    A,@DPTR
1009 FB                MOV     R3,A
100A C3                CLR     C
100B E500        R     MOV     A,curr_error+03H
100D 9B                SUBB    A,R3
100E FF                MOV     R7,A
100F E500        R     MOV     A,curr_error+02H
1011 9A                SUBB    A,R2
1012 FE                MOV     R6,A
1013 E500        R     MOV     A,curr_error+01H
1015 99                SUBB    A,R1
1016 FD                MOV     R5,A
1017 E500        R     MOV     A,curr_error
1019 98                SUBB    A,R0
101A FC                MOV     R4,A
101B AB00        R     MOV     R3,k_d_c+03H
101D AA00        R     MOV     R2,k_d_c+02H
101F A900        R     MOV     R1,k_d_c+01H
1021 A800        R     MOV     R0,k_d_c
1023 120000      E     LCALL   ?C?LMUL
1026 7810              MOV     R0,#010H
1028 120000      E     LCALL   ?C?SLSHR
102B E500        R     MOV     A,pwm_input+03H
102D 2F                ADD     A,R7
102E F500        R     MOV     pwm_input+03H,A
1030 E500        R     MOV     A,pwm_input+02H
1032 3E                ADDC    A,R6
1033 F500        R     MOV     pwm_input+02H,A
1035 E500        R     MOV     A,pwm_input+01H
1037 3D                ADDC    A,R5
1038 F500        R     MOV     pwm_input+01H,A
103A E500        R     MOV     A,pwm_input
103C 3C                ADDC    A,R4
103D F500        R     MOV     pwm_input,A
103F         ?C0135:
                                           ; SOURCE LINE # 860
103F AF00        R     MOV     R7,curr_error+03H
1041 AE00        R     MOV     R6,curr_error+02H
1043 AD00        R     MOV     R5,curr_error+01H
1045 AC00        R     MOV     R4,curr_error
1047 900000      R     MOV     DPTR,#prev_curr_err
104A 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 862
104D E4                CLR     A
104E FF                MOV     R7,A
104F FE                MOV     R6,A
1050 FD                MOV     R5,A
1051 FC                MOV     R4,A
1052 AB00        R     MOV     R3,pwm_input+03H
1054 AA00        R     MOV     R2,pwm_input+02H
1056 A900        R     MOV     R1,pwm_input+01H
1058 A800        R     MOV     R0,pwm_input
105A C3                CLR     C
105B 120000      E     LCALL   ?C?SLCMP
105E 4004              JC      ?C0136
                                           ; SOURCE LINE # 863
1060 D200        R     SETB    motor_dir
1062 8072              SJMP    ?C0091
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 88  

1064         ?C0136:
                                           ; SOURCE LINE # 865
1064 C200        R     CLR     motor_dir
                                           ; SOURCE LINE # 866
                                           ; SOURCE LINE # 867
1066 806E              SJMP    ?C0091
                                           ; SOURCE LINE # 870
1068         ?C0138:
                                           ; SOURCE LINE # 872
1068 900000      E     MOV     DPTR,#g_ref+010H
106B E0                MOVX    A,@DPTR
106C FC                MOV     R4,A
106D A3                INC     DPTR
106E E0                MOVX    A,@DPTR
106F FD                MOV     R5,A
1070 A3                INC     DPTR
1071 E0                MOVX    A,@DPTR
1072 FE                MOV     R6,A
1073 A3                INC     DPTR
1074 E0                MOVX    A,@DPTR
1075 F500        R     MOV     pwm_input+03H,A
1077 8E00        R     MOV     pwm_input+02H,R6
1079 8D00        R     MOV     pwm_input+01H,R5
107B 8C00        R     MOV     pwm_input,R4
                                           ; SOURCE LINE # 874
107D E4                CLR     A
107E FF                MOV     R7,A
107F FE                MOV     R6,A
1080 FD                MOV     R5,A
1081 FC                MOV     R4,A
1082 AB00        R     MOV     R3,pwm_input+03H
1084 AA00        R     MOV     R2,pwm_input+02H
1086 A900        R     MOV     R1,pwm_input+01H
1088 A800        R     MOV     R0,pwm_input
108A D3                SETB    C
108B 120000      E     LCALL   ?C?SLCMP
108E 4004              JC      ?C0139
                                           ; SOURCE LINE # 875
1090 D200        R     SETB    motor_dir
1092 8002              SJMP    ?C0140
1094         ?C0139:
                                           ; SOURCE LINE # 877
1094 C200        R     CLR     motor_dir
1096         ?C0140:
                                           ; SOURCE LINE # 881
1096 74FF              MOV     A,#0FFH
1098 7F9C              MOV     R7,#09CH
109A FE                MOV     R6,A
109B FD                MOV     R5,A
109C FC                MOV     R4,A
109D AB00        R     MOV     R3,pwm_input+03H
109F AA00        R     MOV     R2,pwm_input+02H
10A1 A900        R     MOV     R1,pwm_input+01H
10A3 A800        R     MOV     R0,pwm_input
10A5 C3                CLR     C
10A6 120000      E     LCALL   ?C?SLCMP
10A9 500D              JNC     ?C0141
                                           ; SOURCE LINE # 882
10AB 74FF              MOV     A,#0FFH
10AD 75009C      R     MOV     pwm_input+03H,#09CH
10B0 F500        R     MOV     pwm_input+02H,A
10B2 F500        R     MOV     pwm_input+01H,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 89  

10B4 F500        R     MOV     pwm_input,A
10B6 801E              SJMP    ?C0091
10B8         ?C0141:
                                           ; SOURCE LINE # 883
                                           ; SOURCE LINE # 884
10B8 E4                CLR     A
10B9 7F64              MOV     R7,#064H
10BB FE                MOV     R6,A
10BC FD                MOV     R5,A
10BD FC                MOV     R4,A
10BE AB00        R     MOV     R3,pwm_input+03H
10C0 AA00        R     MOV     R2,pwm_input+02H
10C2 A900        R     MOV     R1,pwm_input+01H
10C4 A800        R     MOV     R0,pwm_input
10C6 D3                SETB    C
10C7 120000      E     LCALL   ?C?SLCMP
10CA 400A              JC      ?C0091
                                           ; SOURCE LINE # 885
10CC E4                CLR     A
10CD 750064      R     MOV     pwm_input+03H,#064H
10D0 F500        R     MOV     pwm_input+02H,A
10D2 F500        R     MOV     pwm_input+01H,A
10D4 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 886
                                           ; SOURCE LINE # 888
                                           ; SOURCE LINE # 889
10D6         ?C0091:
                                           ; SOURCE LINE # 893
10D6 E4                CLR     A
10D7 7F64              MOV     R7,#064H
10D9 FE                MOV     R6,A
10DA FD                MOV     R5,A
10DB FC                MOV     R4,A
10DC AB00        R     MOV     R3,pwm_input+03H
10DE AA00        R     MOV     R2,pwm_input+02H
10E0 A900        R     MOV     R1,pwm_input+01H
10E2 A800        R     MOV     R0,pwm_input
10E4 D3                SETB    C
10E5 120000      E     LCALL   ?C?SLCMP
10E8 400A              JC      ?C0144
                                           ; SOURCE LINE # 894
10EA E4                CLR     A
10EB 750064      R     MOV     pwm_input+03H,#064H
10EE F500        R     MOV     pwm_input+02H,A
10F0 F500        R     MOV     pwm_input+01H,A
10F2 F500        R     MOV     pwm_input,A
10F4         ?C0144:
                                           ; SOURCE LINE # 895
10F4 74FF              MOV     A,#0FFH
10F6 7F9C              MOV     R7,#09CH
10F8 FE                MOV     R6,A
10F9 FD                MOV     R5,A
10FA FC                MOV     R4,A
10FB AB00        R     MOV     R3,pwm_input+03H
10FD AA00        R     MOV     R2,pwm_input+02H
10FF A900        R     MOV     R1,pwm_input+01H
1101 A800        R     MOV     R0,pwm_input
1103 C3                CLR     C
1104 120000      E     LCALL   ?C?SLCMP
1107 500B              JNC     ?C0145
                                           ; SOURCE LINE # 896
1109 74FF              MOV     A,#0FFH
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 90  

110B 75009C      R     MOV     pwm_input+03H,#09CH
110E F500        R     MOV     pwm_input+02H,A
1110 F500        R     MOV     pwm_input+01H,A
1112 F500        R     MOV     pwm_input,A
1114         ?C0145:
                                           ; SOURCE LINE # 899
1114 900000      E     MOV     DPTR,#c_mem+034H
1117 E0                MOVX    A,@DPTR
1118 6401              XRL     A,#01H
111A 6037              JZ      ?C0146
                                           ; SOURCE LINE # 900
111C AF00        R     MOV     R7,pwm_input+03H
111E AE00        R     MOV     R6,pwm_input+02H
1120 AD00        R     MOV     R5,pwm_input+01H
1122 AC00        R     MOV     R4,pwm_input
1124 780A              MOV     R0,#0AH
1126 120000      E     LCALL   ?C?LSHL
1129 E4                CLR     A
112A 7B64              MOV     R3,#064H
112C FA                MOV     R2,A
112D F9                MOV     R1,A
112E F8                MOV     R0,A
112F 120000      E     LCALL   ?C?SLDIV
1132 A804              MOV     R0,AR4
1134 A905              MOV     R1,AR5
1136 AA06              MOV     R2,AR6
1138 AB07              MOV     R3,AR7
113A 900000      E     MOV     DPTR,#dev_pwm_limit
113D E0                MOVX    A,@DPTR
113E FF                MOV     R7,A
113F E4                CLR     A
1140 FC                MOV     R4,A
1141 FD                MOV     R5,A
1142 FE                MOV     R6,A
1143 120000      E     LCALL   ?C?LMUL
1146 780A              MOV     R0,#0AH
1148 120000      E     LCALL   ?C?SLSHR
114B 8F00        R     MOV     pwm_input+03H,R7
114D 8E00        R     MOV     pwm_input+02H,R6
114F 8D00        R     MOV     pwm_input+01H,R5
1151 8C00        R     MOV     pwm_input,R4
1153         ?C0146:
                                           ; SOURCE LINE # 903
1153 E4                CLR     A
1154 FF                MOV     R7,A
1155 FE                MOV     R6,A
1156 FD                MOV     R5,A
1157 FC                MOV     R4,A
1158 AB00        R     MOV     R3,pwm_input+03H
115A AA00        R     MOV     R2,pwm_input+02H
115C A900        R     MOV     R1,pwm_input+01H
115E A800        R     MOV     R0,pwm_input
1160 C3                CLR     C
1161 120000      E     LCALL   ?C?SLCMP
1164 4004              JC      ?C0147
1166 7F01              MOV     R7,#01H
1168 8002              SJMP    ?C0148
116A         ?C0147:
116A 7FFF              MOV     R7,#0FFH
116C         ?C0148:
116C 900000      E     MOV     DPTR,#pwm_sign
116F EF                MOV     A,R7
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 91  

1170 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 905
1171 300007            JNB     motor_dir,?C0149
                                           ; SOURCE LINE # 906
1174 7F01              MOV     R7,#01H
1176 120000      E     LCALL   _MOTOR_DIR_Write
1179 8005              SJMP    ?C0150
117B         ?C0149:
                                           ; SOURCE LINE # 908
117B E4                CLR     A
117C FF                MOV     R7,A
117D 120000      E     LCALL   _MOTOR_DIR_Write
1180         ?C0150:
                                           ; SOURCE LINE # 910
1180 AE00        R     MOV     R6,pwm_input+02H
1182 AF00        R     MOV     R7,pwm_input+03H
1184 120000      E     LCALL   _abs
1187 120000      E     LCALL   _PWM_MOTORS_WriteCompare1
                                           ; SOURCE LINE # 911
118A 22                RET     
             ; FUNCTION motor_control (END)

             ; FUNCTION _encoder_reading (BEGIN)
                                           ; SOURCE LINE # 917
;---- Variable 'idx' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 919
0000 8F00        R     MOV     index,R7
                                           ; SOURCE LINE # 928
0002 E4                CLR     A
0003 FF                MOV     R7,A
0004 FE                MOV     R6,A
0005 FD                MOV     R5,A
0006 FC                MOV     R4,A
0007 900000      R     MOV     DPTR,#init_rot
000A 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 947
000D E500        R     MOV     A,index
000F C3                CLR     C
0010 9403              SUBB    A,#03H
0012 4003              JC      $ + 5H
0014 020000      R     LJMP    ?C0153
0017         ?C0152:
                                           ; SOURCE LINE # 950
0017 300022            JNB     reset_last_value_flag,?C0154
                                           ; SOURCE LINE # 951
;---- Variable 'jj' assigned to Register 'R3' ----
001A 7B03              MOV     R3,#03H
001C         ?C0155:
001C AF03              MOV     R7,AR3
001E 1B                DEC     R3
001F EF                MOV     A,R7
0020 6018              JZ      ?C0156
                                           ; SOURCE LINE # 952
0022 E4                CLR     A
0023 FF                MOV     R7,A
0024 FE                MOV     R6,A
0025 FD                MOV     R5,A
0026 FC                MOV     R4,A
0027 EB                MOV     A,R3
0028 25E0              ADD     A,ACC
002A 25E0              ADD     A,ACC
002C 2400        R     ADD     A,#LOW last_value_encoder
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 92  

002E F582              MOV     DPL,A
0030 E4                CLR     A
0031 3400        R     ADDC    A,#HIGH last_value_encoder
0033 F583              MOV     DPH,A
0035 120000      E     LCALL   ?C?LSTXDATA
0038 80E2              SJMP    ?C0155
003A         ?C0156:
                                           ; SOURCE LINE # 954
003A C200        E     CLR     reset_last_value_flag
                                           ; SOURCE LINE # 955
003C         ?C0154:
                                           ; SOURCE LINE # 959
003C E500        R     MOV     A,index
003E 7018              JNZ     ?C0157
                                           ; SOURCE LINE # 960
0040 120000      E     LCALL   SHIFTREG_ENC_1_ReadData
0043 7801              MOV     R0,#01H
0045 120000      E     LCALL   ?C?ULSHR
0048 EF                MOV     A,R7
0049 EE                MOV     A,R6
004A ED                MOV     A,R5
004B 5403              ANL     A,#03H
004D FD                MOV     R5,A
004E E4                CLR     A
004F FC                MOV     R4,A
0050 900000      R     MOV     DPTR,#data_encoder
0053 120000      E     LCALL   ?C?LSTXDATA
0056 8033              SJMP    ?C0158
0058         ?C0157:
                                           ; SOURCE LINE # 961
                                           ; SOURCE LINE # 962
0058 E500        R     MOV     A,index
005A B40118            CJNE    A,#01H,?C0159
                                           ; SOURCE LINE # 963
005D 120000      E     LCALL   SHIFTREG_ENC_2_ReadData
0060 7801              MOV     R0,#01H
0062 120000      E     LCALL   ?C?ULSHR
0065 EF                MOV     A,R7
0066 EE                MOV     A,R6
0067 ED                MOV     A,R5
0068 5403              ANL     A,#03H
006A FD                MOV     R5,A
006B E4                CLR     A
006C FC                MOV     R4,A
006D 900000      R     MOV     DPTR,#data_encoder
0070 120000      E     LCALL   ?C?LSTXDATA
0073 8016              SJMP    ?C0158
0075         ?C0159:
                                           ; SOURCE LINE # 965
0075 120000      E     LCALL   SHIFTREG_ENC_3_ReadData
0078 7801              MOV     R0,#01H
007A 120000      E     LCALL   ?C?ULSHR
007D EF                MOV     A,R7
007E EE                MOV     A,R6
007F ED                MOV     A,R5
0080 5403              ANL     A,#03H
0082 FD                MOV     R5,A
0083 E4                CLR     A
0084 FC                MOV     R4,A
0085 900000      R     MOV     DPTR,#data_encoder
0088 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 966
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 93  

008B         ?C0158:
                                           ; SOURCE LINE # 969
008B 7B01              MOV     R3,#01H
008D 7A00        R     MOV     R2,#HIGH data_encoder
008F 7900        R     MOV     R1,#LOW data_encoder
0091 120000      E     LCALL   _check_enc_data
0094 4003              JC      $ + 5H
0096 020000      R     LJMP    ?C0161
                                           ; SOURCE LINE # 971
0099 900000      R     MOV     DPTR,#data_encoder
009C E0                MOVX    A,@DPTR
009D FC                MOV     R4,A
009E A3                INC     DPTR
009F E0                MOVX    A,@DPTR
00A0 FD                MOV     R5,A
00A1 A3                INC     DPTR
00A2 E0                MOVX    A,@DPTR
00A3 FE                MOV     R6,A
00A4 A3                INC     DPTR
00A5 E0                MOVX    A,@DPTR
00A6 54C0              ANL     A,#0C0H
00A8 FF                MOV     R7,A
00A9 EE                MOV     A,R6
00AA ED                MOV     A,R5
00AB 5403              ANL     A,#03H
00AD FD                MOV     R5,A
00AE E4                CLR     A
00AF 2F                ADD     A,R7
00B0 FF                MOV     R7,A
00B1 E4                CLR     A
00B2 3E                ADDC    A,R6
00B3 FE                MOV     R6,A
00B4 ED                MOV     A,R5
00B5 34FE              ADDC    A,#0FEH
00B7 FD                MOV     R5,A
00B8 E4                CLR     A
00B9 34FF              ADDC    A,#0FFH
00BB FC                MOV     R4,A
00BC 7802              MOV     R0,#02H
00BE 120000      E     LCALL   ?C?ULSHR
00C1 EE                MOV     A,R6
00C2 33                RLC     A
00C3 95E0              SUBB    A,ACC
00C5 FD                MOV     R5,A
00C6 FC                MOV     R4,A
00C7 E500        R     MOV     A,index
00C9 25E0              ADD     A,ACC
00CB 25E0              ADD     A,ACC
00CD 2400        E     ADD     A,#LOW g_mem+038H
00CF F582              MOV     DPL,A
00D1 E4                CLR     A
00D2 3400        E     ADDC    A,#HIGH g_mem+038H
00D4 F583              MOV     DPH,A
00D6 E0                MOVX    A,@DPTR
00D7 F8                MOV     R0,A
00D8 A3                INC     DPTR
00D9 E0                MOVX    A,@DPTR
00DA F9                MOV     R1,A
00DB A3                INC     DPTR
00DC E0                MOVX    A,@DPTR
00DD FA                MOV     R2,A
00DE A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 94  

00DF E0                MOVX    A,@DPTR
00E0 2F                ADD     A,R7
00E1 FF                MOV     R7,A
00E2 EA                MOV     A,R2
00E3 3E                ADDC    A,R6
00E4 FE                MOV     R6,A
00E5 E9                MOV     A,R1
00E6 3D                ADDC    A,R5
00E7 FD                MOV     R5,A
00E8 E8                MOV     A,R0
00E9 3C                ADDC    A,R4
00EA FC                MOV     R4,A
00EB 900000      R     MOV     DPTR,#value_encoder
00EE 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 978
00F1 300027            JNB     only_first_time,?C0162
                                           ; SOURCE LINE # 979
00F4 900000      R     MOV     DPTR,#value_encoder
00F7 E0                MOVX    A,@DPTR
00F8 FC                MOV     R4,A
00F9 A3                INC     DPTR
00FA E0                MOVX    A,@DPTR
00FB FD                MOV     R5,A
00FC A3                INC     DPTR
00FD E0                MOVX    A,@DPTR
00FE FE                MOV     R6,A
00FF A3                INC     DPTR
0100 E0                MOVX    A,@DPTR
0101 FF                MOV     R7,A
0102 E500        R     MOV     A,index
0104 25E0              ADD     A,ACC
0106 25E0              ADD     A,ACC
0108 2400        R     ADD     A,#LOW last_value_encoder
010A F582              MOV     DPL,A
010C E4                CLR     A
010D 3400        R     ADDC    A,#HIGH last_value_encoder
010F F583              MOV     DPH,A
0111 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 980
0114 E500        R     MOV     A,index
0116 B40202            CJNE    A,#02H,?C0162
                                           ; SOURCE LINE # 981
0119 C200        R     CLR     only_first_time
                                           ; SOURCE LINE # 982
011B         ?C0162:
                                           ; SOURCE LINE # 985
011B E500        R     MOV     A,index
011D 25E0              ADD     A,ACC
011F 25E0              ADD     A,ACC
0121 2400        R     ADD     A,#LOW last_value_encoder
0123 F582              MOV     DPL,A
0125 E4                CLR     A
0126 3400        R     ADDC    A,#HIGH last_value_encoder
0128 F583              MOV     DPH,A
012A E0                MOVX    A,@DPTR
012B F8                MOV     R0,A
012C A3                INC     DPTR
012D E0                MOVX    A,@DPTR
012E F9                MOV     R1,A
012F A3                INC     DPTR
0130 E0                MOVX    A,@DPTR
0131 FA                MOV     R2,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 95  

0132 A3                INC     DPTR
0133 E0                MOVX    A,@DPTR
0134 FB                MOV     R3,A
0135 900000      R     MOV     DPTR,#value_encoder
0138 E0                MOVX    A,@DPTR
0139 FC                MOV     R4,A
013A A3                INC     DPTR
013B E0                MOVX    A,@DPTR
013C FD                MOV     R5,A
013D A3                INC     DPTR
013E E0                MOVX    A,@DPTR
013F FE                MOV     R6,A
0140 A3                INC     DPTR
0141 E0                MOVX    A,@DPTR
0142 C3                CLR     C
0143 9B                SUBB    A,R3
0144 FF                MOV     R7,A
0145 EE                MOV     A,R6
0146 9A                SUBB    A,R2
0147 FE                MOV     R6,A
0148 ED                MOV     A,R5
0149 99                SUBB    A,R1
014A FD                MOV     R5,A
014B EC                MOV     A,R4
014C 98                SUBB    A,R0
014D FC                MOV     R4,A
014E 900000      R     MOV     DPTR,#aux
0151 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1005
0154 E4                CLR     A
0155 FF                MOV     R7,A
0156 7EC0              MOV     R6,#0C0H
0158 FD                MOV     R5,A
0159 FC                MOV     R4,A
015A 900000      R     MOV     DPTR,#aux
015D E0                MOVX    A,@DPTR
015E F8                MOV     R0,A
015F A3                INC     DPTR
0160 E0                MOVX    A,@DPTR
0161 F9                MOV     R1,A
0162 A3                INC     DPTR
0163 E0                MOVX    A,@DPTR
0164 FA                MOV     R2,A
0165 A3                INC     DPTR
0166 E0                MOVX    A,@DPTR
0167 FB                MOV     R3,A
0168 D3                SETB    C
0169 120000      E     LCALL   ?C?SLCMP
016C 4010              JC      ?C0164
                                           ; SOURCE LINE # 1006
016E 7400        E     MOV     A,#LOW g_meas+014H
0170 2500        R     ADD     A,index
0172 F582              MOV     DPL,A
0174 E4                CLR     A
0175 3400        E     ADDC    A,#HIGH g_meas+014H
0177 F583              MOV     DPH,A
0179 E0                MOVX    A,@DPTR
017A 14                DEC     A
017B F0                MOVX    @DPTR,A
017C 8068              SJMP    ?C0165
017E         ?C0164:
                                           ; SOURCE LINE # 1007
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 96  

                                           ; SOURCE LINE # 1008
017E 7F00              MOV     R7,#00H
0180 7E40              MOV     R6,#040H
0182 7DFF              MOV     R5,#0FFH
0184 7CFF              MOV     R4,#0FFH
0186 900000      R     MOV     DPTR,#aux
0189 E0                MOVX    A,@DPTR
018A F8                MOV     R0,A
018B A3                INC     DPTR
018C E0                MOVX    A,@DPTR
018D F9                MOV     R1,A
018E A3                INC     DPTR
018F E0                MOVX    A,@DPTR
0190 FA                MOV     R2,A
0191 A3                INC     DPTR
0192 E0                MOVX    A,@DPTR
0193 FB                MOV     R3,A
0194 C3                CLR     C
0195 120000      E     LCALL   ?C?SLCMP
0198 5010              JNC     ?C0166
                                           ; SOURCE LINE # 1009
019A 7400        E     MOV     A,#LOW g_meas+014H
019C 2500        R     ADD     A,index
019E F582              MOV     DPL,A
01A0 E4                CLR     A
01A1 3400        E     ADDC    A,#HIGH g_meas+014H
01A3 F583              MOV     DPH,A
01A5 E0                MOVX    A,@DPTR
01A6 04                INC     A
01A7 F0                MOVX    @DPTR,A
01A8 803C              SJMP    ?C0165
01AA         ?C0166:
                                           ; SOURCE LINE # 1010
                                           ; SOURCE LINE # 1011
01AA 900000      R     MOV     DPTR,#aux
01AD E0                MOVX    A,@DPTR
01AE A3                INC     DPTR
01AF E0                MOVX    A,@DPTR
01B0 A3                INC     DPTR
01B1 E0                MOVX    A,@DPTR
01B2 FE                MOV     R6,A
01B3 A3                INC     DPTR
01B4 E0                MOVX    A,@DPTR
01B5 FF                MOV     R7,A
01B6 120000      E     LCALL   _abs
01B9 D3                SETB    C
01BA EF                MOV     A,R7
01BB 9400              SUBB    A,#00H
01BD EE                MOV     A,R6
01BE 6480              XRL     A,#080H
01C0 94C0              SUBB    A,#0C0H
01C2 4022              JC      ?C0165
                                           ; SOURCE LINE # 1012
01C4 7400        R     MOV     A,#LOW error
01C6 2500        R     ADD     A,index
01C8 F582              MOV     DPL,A
01CA E4                CLR     A
01CB 3400        R     ADDC    A,#HIGH error
01CD F583              MOV     DPH,A
01CF E0                MOVX    A,@DPTR
01D0 04                INC     A
01D1 F0                MOVX    @DPTR,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 97  

                                           ; SOURCE LINE # 1013
01D2 7400        R     MOV     A,#LOW error
01D4 2500        R     ADD     A,index
01D6 F582              MOV     DPL,A
01D8 E4                CLR     A
01D9 3400        R     ADDC    A,#HIGH error
01DB F583              MOV     DPH,A
01DD E0                MOVX    A,@DPTR
01DE C3                CLR     C
01DF 940A              SUBB    A,#0AH
01E1 5003              JNC     $ + 5H
01E3 020000      R     LJMP    ?C0153
01E6         ?C0169:
                                           ; SOURCE LINE # 1016
                                           ; SOURCE LINE # 1017
                                           ; SOURCE LINE # 1018
01E6         ?C0165:
                                           ; SOURCE LINE # 1020
01E6 7400        R     MOV     A,#LOW error
01E8 2500        R     ADD     A,index
01EA F582              MOV     DPL,A
01EC E4                CLR     A
01ED 3400        R     ADDC    A,#HIGH error
01EF F583              MOV     DPH,A
01F1 E4                CLR     A
01F2 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1022
01F3 900000      R     MOV     DPTR,#value_encoder
01F6 E0                MOVX    A,@DPTR
01F7 FC                MOV     R4,A
01F8 A3                INC     DPTR
01F9 E0                MOVX    A,@DPTR
01FA FD                MOV     R5,A
01FB A3                INC     DPTR
01FC E0                MOVX    A,@DPTR
01FD FE                MOV     R6,A
01FE A3                INC     DPTR
01FF E0                MOVX    A,@DPTR
0200 FF                MOV     R7,A
0201 E500        R     MOV     A,index
0203 25E0              ADD     A,ACC
0205 25E0              ADD     A,ACC
0207 2400        R     ADD     A,#LOW last_value_encoder
0209 F582              MOV     DPL,A
020B E4                CLR     A
020C 3400        R     ADDC    A,#HIGH last_value_encoder
020E F583              MOV     DPH,A
0210 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1024
0213 900000      R     MOV     DPTR,#value_encoder
0216 E0                MOVX    A,@DPTR
0217 F8                MOV     R0,A
0218 A3                INC     DPTR
0219 E0                MOVX    A,@DPTR
021A F9                MOV     R1,A
021B A3                INC     DPTR
021C E0                MOVX    A,@DPTR
021D FA                MOV     R2,A
021E A3                INC     DPTR
021F E0                MOVX    A,@DPTR
0220 FB                MOV     R3,A
0221 C000              PUSH    AR0
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 98  

0223 7400        E     MOV     A,#LOW g_meas+014H
0225 2500        R     ADD     A,index
0227 F582              MOV     DPL,A
0229 E4                CLR     A
022A 3400        E     ADDC    A,#HIGH g_meas+014H
022C F583              MOV     DPH,A
022E E0                MOVX    A,@DPTR
022F FF                MOV     R7,A
0230 33                RLC     A
0231 95E0              SUBB    A,ACC
0233 FE                MOV     R6,A
0234 FD                MOV     R5,A
0235 FC                MOV     R4,A
0236 7810              MOV     R0,#010H
0238 120000      E     LCALL   ?C?LSHL
023B D000              POP     AR0
023D EB                MOV     A,R3
023E 2F                ADD     A,R7
023F FF                MOV     R7,A
0240 EA                MOV     A,R2
0241 3E                ADDC    A,R6
0242 FE                MOV     R6,A
0243 E9                MOV     A,R1
0244 3D                ADDC    A,R5
0245 FD                MOV     R5,A
0246 E8                MOV     A,R0
0247 3C                ADDC    A,R4
0248 FC                MOV     R4,A
0249 900000      R     MOV     DPTR,#value_encoder
024C 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1026
024F E500        R     MOV     A,index
0251 25E0              ADD     A,ACC
0253 25E0              ADD     A,ACC
0255 2400        E     ADD     A,#LOW c_mem+044H
0257 F582              MOV     DPL,A
0259 E4                CLR     A
025A 3400        E     ADDC    A,#HIGH c_mem+044H
025C F583              MOV     DPH,A
025E E0                MOVX    A,@DPTR
025F FC                MOV     R4,A
0260 A3                INC     DPTR
0261 E0                MOVX    A,@DPTR
0262 FD                MOV     R5,A
0263 A3                INC     DPTR
0264 E0                MOVX    A,@DPTR
0265 FE                MOV     R6,A
0266 A3                INC     DPTR
0267 E0                MOVX    A,@DPTR
0268 FF                MOV     R7,A
0269 E4                CLR     A
026A FB                MOV     R3,A
026B FA                MOV     R2,A
026C 7980              MOV     R1,#080H
026E 783F              MOV     R0,#03FH
0270 120000      E     LCALL   ?C?FPCMP3
0273 6038              JZ      ?C0170
                                           ; SOURCE LINE # 1027
0275 900000      R     MOV     DPTR,#value_encoder
0278 E0                MOVX    A,@DPTR
0279 FC                MOV     R4,A
027A A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 99  

027B E0                MOVX    A,@DPTR
027C FD                MOV     R5,A
027D A3                INC     DPTR
027E E0                MOVX    A,@DPTR
027F FE                MOV     R6,A
0280 A3                INC     DPTR
0281 E0                MOVX    A,@DPTR
0282 FF                MOV     R7,A
0283 EC                MOV     A,R4
0284 120000      E     LCALL   ?C?FCASTL
0287 E500        R     MOV     A,index
0289 25E0              ADD     A,ACC
028B 25E0              ADD     A,ACC
028D 2400        E     ADD     A,#LOW c_mem+044H
028F F582              MOV     DPL,A
0291 E4                CLR     A
0292 3400        E     ADDC    A,#HIGH c_mem+044H
0294 F583              MOV     DPH,A
0296 E0                MOVX    A,@DPTR
0297 F8                MOV     R0,A
0298 A3                INC     DPTR
0299 E0                MOVX    A,@DPTR
029A F9                MOV     R1,A
029B A3                INC     DPTR
029C E0                MOVX    A,@DPTR
029D FA                MOV     R2,A
029E A3                INC     DPTR
029F E0                MOVX    A,@DPTR
02A0 FB                MOV     R3,A
02A1 120000      E     LCALL   ?C?FPMUL
02A4 120000      E     LCALL   ?C?CASTF
02A7 900000      R     MOV     DPTR,#value_encoder
02AA 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1028
02AD         ?C0170:
                                           ; SOURCE LINE # 1030
02AD 900000      R     MOV     DPTR,#value_encoder
02B0 E0                MOVX    A,@DPTR
02B1 FC                MOV     R4,A
02B2 A3                INC     DPTR
02B3 E0                MOVX    A,@DPTR
02B4 FD                MOV     R5,A
02B5 A3                INC     DPTR
02B6 E0                MOVX    A,@DPTR
02B7 FE                MOV     R6,A
02B8 A3                INC     DPTR
02B9 E0                MOVX    A,@DPTR
02BA FF                MOV     R7,A
02BB E500        R     MOV     A,index
02BD 25E0              ADD     A,ACC
02BF 25E0              ADD     A,ACC
02C1 2400        E     ADD     A,#LOW g_meas
02C3 F582              MOV     DPL,A
02C5 E4                CLR     A
02C6 3400        E     ADDC    A,#HIGH g_meas
02C8 F583              MOV     DPH,A
02CA 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1031
02CD         ?C0161:
                                           ; SOURCE LINE # 1033
02CD E500        R     MOV     A,index
02CF 14                DEC     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 100 

02D0 7003              JNZ     $ + 5H
02D2 020000      R     LJMP    ?C0173
02D5 14                DEC     A
02D6 7003              JNZ     $ + 5H
02D8 020000      R     LJMP    ?C0174
02DB 2402              ADD     A,#02H
02DD 6003              JZ      $ + 5H
02DF 020000      R     LJMP    ?C0171
                                           ; SOURCE LINE # 1034
02E2         ?C0172:
                                           ; SOURCE LINE # 1035
02E2 E4                CLR     A
02E3 7F12              MOV     R7,#012H
02E5 FE                MOV     R6,A
02E6 FD                MOV     R5,A
02E7 FC                MOV     R4,A
02E8 900000      R     MOV     DPTR,#v_value
02EB E0                MOVX    A,@DPTR
02EC F8                MOV     R0,A
02ED A3                INC     DPTR
02EE E0                MOVX    A,@DPTR
02EF F9                MOV     R1,A
02F0 A3                INC     DPTR
02F1 E0                MOVX    A,@DPTR
02F2 FA                MOV     R2,A
02F3 A3                INC     DPTR
02F4 E0                MOVX    A,@DPTR
02F5 FB                MOV     R3,A
02F6 120000      E     LCALL   ?C?LMUL
02F9 C004              PUSH    AR4
02FB C005              PUSH    AR5
02FD C006              PUSH    AR6
02FF C007              PUSH    AR7
0301 E4                CLR     A
0302 7F0B              MOV     R7,#0BH
0304 FE                MOV     R6,A
0305 FD                MOV     R5,A
0306 FC                MOV     R4,A
0307 900000      R     MOV     DPTR,#value_encoder
030A E0                MOVX    A,@DPTR
030B F8                MOV     R0,A
030C A3                INC     DPTR
030D E0                MOVX    A,@DPTR
030E F9                MOV     R1,A
030F A3                INC     DPTR
0310 E0                MOVX    A,@DPTR
0311 FA                MOV     R2,A
0312 A3                INC     DPTR
0313 E0                MOVX    A,@DPTR
0314 FB                MOV     R3,A
0315 120000      E     LCALL   ?C?LMUL
0318 D003              POP     AR3
031A D002              POP     AR2
031C D001              POP     AR1
031E D000              POP     AR0
0320 C3                CLR     C
0321 EF                MOV     A,R7
0322 9B                SUBB    A,R3
0323 FF                MOV     R7,A
0324 EE                MOV     A,R6
0325 9A                SUBB    A,R2
0326 FE                MOV     R6,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 101 

0327 ED                MOV     A,R5
0328 99                SUBB    A,R1
0329 FD                MOV     R5,A
032A EC                MOV     A,R4
032B 98                SUBB    A,R0
032C FC                MOV     R4,A
032D C004              PUSH    AR4
032F C005              PUSH    AR5
0331 C006              PUSH    AR6
0333 C007              PUSH    AR7
0335 E4                CLR     A
0336 7F09              MOV     R7,#09H
0338 FE                MOV     R6,A
0339 FD                MOV     R5,A
033A FC                MOV     R4,A
033B 900000      R     MOV     DPTR,#vv_value
033E E0                MOVX    A,@DPTR
033F F8                MOV     R0,A
0340 A3                INC     DPTR
0341 E0                MOVX    A,@DPTR
0342 F9                MOV     R1,A
0343 A3                INC     DPTR
0344 E0                MOVX    A,@DPTR
0345 FA                MOV     R2,A
0346 A3                INC     DPTR
0347 E0                MOVX    A,@DPTR
0348 FB                MOV     R3,A
0349 120000      E     LCALL   ?C?LMUL
034C D003              POP     AR3
034E D002              POP     AR2
0350 D001              POP     AR1
0352 D000              POP     AR0
0354 EF                MOV     A,R7
0355 2B                ADD     A,R3
0356 FF                MOV     R7,A
0357 EE                MOV     A,R6
0358 3A                ADDC    A,R2
0359 FE                MOV     R6,A
035A ED                MOV     A,R5
035B 39                ADDC    A,R1
035C FD                MOV     R5,A
035D EC                MOV     A,R4
035E 38                ADDC    A,R0
035F FC                MOV     R4,A
0360 C004              PUSH    AR4
0362 C005              PUSH    AR5
0364 C006              PUSH    AR6
0366 C007              PUSH    AR7
0368 E4                CLR     A
0369 7F02              MOV     R7,#02H
036B FE                MOV     R6,A
036C FD                MOV     R5,A
036D FC                MOV     R4,A
036E 900000      R     MOV     DPTR,#vvv_value
0371 E0                MOVX    A,@DPTR
0372 F8                MOV     R0,A
0373 A3                INC     DPTR
0374 E0                MOVX    A,@DPTR
0375 F9                MOV     R1,A
0376 A3                INC     DPTR
0377 E0                MOVX    A,@DPTR
0378 FA                MOV     R2,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 102 

0379 A3                INC     DPTR
037A E0                MOVX    A,@DPTR
037B FB                MOV     R3,A
037C 120000      E     LCALL   ?C?LMUL
037F A804              MOV     R0,AR4
0381 A905              MOV     R1,AR5
0383 AA06              MOV     R2,AR6
0385 AB07              MOV     R3,AR7
0387 D007              POP     AR7
0389 D006              POP     AR6
038B D005              POP     AR5
038D D004              POP     AR4
038F C3                CLR     C
0390 EF                MOV     A,R7
0391 9B                SUBB    A,R3
0392 FF                MOV     R7,A
0393 EE                MOV     A,R6
0394 9A                SUBB    A,R2
0395 FE                MOV     R6,A
0396 ED                MOV     A,R5
0397 99                SUBB    A,R1
0398 FD                MOV     R5,A
0399 EC                MOV     A,R4
039A 98                SUBB    A,R0
039B FC                MOV     R4,A
039C 120000      E     LCALL   _filter_vel_1
039F EE                MOV     A,R6
03A0 33                RLC     A
03A1 95E0              SUBB    A,ACC
03A3 FD                MOV     R5,A
03A4 FC                MOV     R4,A
03A5 900000      R     MOV     DPTR,#speed_encoder
03A8 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1036
03AB 020000      R     LJMP    ?C0171
                                           ; SOURCE LINE # 1038
03AE         ?C0173:
                                           ; SOURCE LINE # 1039
03AE E4                CLR     A
03AF 7F12              MOV     R7,#012H
03B1 FE                MOV     R6,A
03B2 FD                MOV     R5,A
03B3 FC                MOV     R4,A
03B4 900000      R     MOV     DPTR,#v_value+04H
03B7 E0                MOVX    A,@DPTR
03B8 F8                MOV     R0,A
03B9 A3                INC     DPTR
03BA E0                MOVX    A,@DPTR
03BB F9                MOV     R1,A
03BC A3                INC     DPTR
03BD E0                MOVX    A,@DPTR
03BE FA                MOV     R2,A
03BF A3                INC     DPTR
03C0 E0                MOVX    A,@DPTR
03C1 FB                MOV     R3,A
03C2 120000      E     LCALL   ?C?LMUL
03C5 C004              PUSH    AR4
03C7 C005              PUSH    AR5
03C9 C006              PUSH    AR6
03CB C007              PUSH    AR7
03CD E4                CLR     A
03CE 7F0B              MOV     R7,#0BH
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 103 

03D0 FE                MOV     R6,A
03D1 FD                MOV     R5,A
03D2 FC                MOV     R4,A
03D3 900000      R     MOV     DPTR,#value_encoder
03D6 E0                MOVX    A,@DPTR
03D7 F8                MOV     R0,A
03D8 A3                INC     DPTR
03D9 E0                MOVX    A,@DPTR
03DA F9                MOV     R1,A
03DB A3                INC     DPTR
03DC E0                MOVX    A,@DPTR
03DD FA                MOV     R2,A
03DE A3                INC     DPTR
03DF E0                MOVX    A,@DPTR
03E0 FB                MOV     R3,A
03E1 120000      E     LCALL   ?C?LMUL
03E4 D003              POP     AR3
03E6 D002              POP     AR2
03E8 D001              POP     AR1
03EA D000              POP     AR0
03EC C3                CLR     C
03ED EF                MOV     A,R7
03EE 9B                SUBB    A,R3
03EF FF                MOV     R7,A
03F0 EE                MOV     A,R6
03F1 9A                SUBB    A,R2
03F2 FE                MOV     R6,A
03F3 ED                MOV     A,R5
03F4 99                SUBB    A,R1
03F5 FD                MOV     R5,A
03F6 EC                MOV     A,R4
03F7 98                SUBB    A,R0
03F8 FC                MOV     R4,A
03F9 C004              PUSH    AR4
03FB C005              PUSH    AR5
03FD C006              PUSH    AR6
03FF C007              PUSH    AR7
0401 E4                CLR     A
0402 7F09              MOV     R7,#09H
0404 FE                MOV     R6,A
0405 FD                MOV     R5,A
0406 FC                MOV     R4,A
0407 900000      R     MOV     DPTR,#vv_value+04H
040A E0                MOVX    A,@DPTR
040B F8                MOV     R0,A
040C A3                INC     DPTR
040D E0                MOVX    A,@DPTR
040E F9                MOV     R1,A
040F A3                INC     DPTR
0410 E0                MOVX    A,@DPTR
0411 FA                MOV     R2,A
0412 A3                INC     DPTR
0413 E0                MOVX    A,@DPTR
0414 FB                MOV     R3,A
0415 120000      E     LCALL   ?C?LMUL
0418 D003              POP     AR3
041A D002              POP     AR2
041C D001              POP     AR1
041E D000              POP     AR0
0420 EF                MOV     A,R7
0421 2B                ADD     A,R3
0422 FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 104 

0423 EE                MOV     A,R6
0424 3A                ADDC    A,R2
0425 FE                MOV     R6,A
0426 ED                MOV     A,R5
0427 39                ADDC    A,R1
0428 FD                MOV     R5,A
0429 EC                MOV     A,R4
042A 38                ADDC    A,R0
042B FC                MOV     R4,A
042C C004              PUSH    AR4
042E C005              PUSH    AR5
0430 C006              PUSH    AR6
0432 C007              PUSH    AR7
0434 E4                CLR     A
0435 7F02              MOV     R7,#02H
0437 FE                MOV     R6,A
0438 FD                MOV     R5,A
0439 FC                MOV     R4,A
043A 900000      R     MOV     DPTR,#vvv_value+04H
043D E0                MOVX    A,@DPTR
043E F8                MOV     R0,A
043F A3                INC     DPTR
0440 E0                MOVX    A,@DPTR
0441 F9                MOV     R1,A
0442 A3                INC     DPTR
0443 E0                MOVX    A,@DPTR
0444 FA                MOV     R2,A
0445 A3                INC     DPTR
0446 E0                MOVX    A,@DPTR
0447 FB                MOV     R3,A
0448 120000      E     LCALL   ?C?LMUL
044B A804              MOV     R0,AR4
044D A905              MOV     R1,AR5
044F AA06              MOV     R2,AR6
0451 AB07              MOV     R3,AR7
0453 D007              POP     AR7
0455 D006              POP     AR6
0457 D005              POP     AR5
0459 D004              POP     AR4
045B C3                CLR     C
045C EF                MOV     A,R7
045D 9B                SUBB    A,R3
045E FF                MOV     R7,A
045F EE                MOV     A,R6
0460 9A                SUBB    A,R2
0461 FE                MOV     R6,A
0462 ED                MOV     A,R5
0463 99                SUBB    A,R1
0464 FD                MOV     R5,A
0465 EC                MOV     A,R4
0466 98                SUBB    A,R0
0467 FC                MOV     R4,A
0468 120000      E     LCALL   _filter_vel_2
046B EE                MOV     A,R6
046C 33                RLC     A
046D 95E0              SUBB    A,ACC
046F FD                MOV     R5,A
0470 FC                MOV     R4,A
0471 900000      R     MOV     DPTR,#speed_encoder
0474 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1040
0477 020000      R     LJMP    ?C0171
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 105 

                                           ; SOURCE LINE # 1042
047A         ?C0174:
                                           ; SOURCE LINE # 1043
047A E4                CLR     A
047B 7F12              MOV     R7,#012H
047D FE                MOV     R6,A
047E FD                MOV     R5,A
047F FC                MOV     R4,A
0480 900000      R     MOV     DPTR,#v_value+08H
0483 E0                MOVX    A,@DPTR
0484 F8                MOV     R0,A
0485 A3                INC     DPTR
0486 E0                MOVX    A,@DPTR
0487 F9                MOV     R1,A
0488 A3                INC     DPTR
0489 E0                MOVX    A,@DPTR
048A FA                MOV     R2,A
048B A3                INC     DPTR
048C E0                MOVX    A,@DPTR
048D FB                MOV     R3,A
048E 120000      E     LCALL   ?C?LMUL
0491 C004              PUSH    AR4
0493 C005              PUSH    AR5
0495 C006              PUSH    AR6
0497 C007              PUSH    AR7
0499 E4                CLR     A
049A 7F0B              MOV     R7,#0BH
049C FE                MOV     R6,A
049D FD                MOV     R5,A
049E FC                MOV     R4,A
049F 900000      R     MOV     DPTR,#value_encoder
04A2 E0                MOVX    A,@DPTR
04A3 F8                MOV     R0,A
04A4 A3                INC     DPTR
04A5 E0                MOVX    A,@DPTR
04A6 F9                MOV     R1,A
04A7 A3                INC     DPTR
04A8 E0                MOVX    A,@DPTR
04A9 FA                MOV     R2,A
04AA A3                INC     DPTR
04AB E0                MOVX    A,@DPTR
04AC FB                MOV     R3,A
04AD 120000      E     LCALL   ?C?LMUL
04B0 D003              POP     AR3
04B2 D002              POP     AR2
04B4 D001              POP     AR1
04B6 D000              POP     AR0
04B8 C3                CLR     C
04B9 EF                MOV     A,R7
04BA 9B                SUBB    A,R3
04BB FF                MOV     R7,A
04BC EE                MOV     A,R6
04BD 9A                SUBB    A,R2
04BE FE                MOV     R6,A
04BF ED                MOV     A,R5
04C0 99                SUBB    A,R1
04C1 FD                MOV     R5,A
04C2 EC                MOV     A,R4
04C3 98                SUBB    A,R0
04C4 FC                MOV     R4,A
04C5 C004              PUSH    AR4
04C7 C005              PUSH    AR5
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 106 

04C9 C006              PUSH    AR6
04CB C007              PUSH    AR7
04CD E4                CLR     A
04CE 7F09              MOV     R7,#09H
04D0 FE                MOV     R6,A
04D1 FD                MOV     R5,A
04D2 FC                MOV     R4,A
04D3 900000      R     MOV     DPTR,#vv_value+08H
04D6 E0                MOVX    A,@DPTR
04D7 F8                MOV     R0,A
04D8 A3                INC     DPTR
04D9 E0                MOVX    A,@DPTR
04DA F9                MOV     R1,A
04DB A3                INC     DPTR
04DC E0                MOVX    A,@DPTR
04DD FA                MOV     R2,A
04DE A3                INC     DPTR
04DF E0                MOVX    A,@DPTR
04E0 FB                MOV     R3,A
04E1 120000      E     LCALL   ?C?LMUL
04E4 D003              POP     AR3
04E6 D002              POP     AR2
04E8 D001              POP     AR1
04EA D000              POP     AR0
04EC EF                MOV     A,R7
04ED 2B                ADD     A,R3
04EE FF                MOV     R7,A
04EF EE                MOV     A,R6
04F0 3A                ADDC    A,R2
04F1 FE                MOV     R6,A
04F2 ED                MOV     A,R5
04F3 39                ADDC    A,R1
04F4 FD                MOV     R5,A
04F5 EC                MOV     A,R4
04F6 38                ADDC    A,R0
04F7 FC                MOV     R4,A
04F8 C004              PUSH    AR4
04FA C005              PUSH    AR5
04FC C006              PUSH    AR6
04FE C007              PUSH    AR7
0500 E4                CLR     A
0501 7F02              MOV     R7,#02H
0503 FE                MOV     R6,A
0504 FD                MOV     R5,A
0505 FC                MOV     R4,A
0506 900000      R     MOV     DPTR,#vvv_value+08H
0509 E0                MOVX    A,@DPTR
050A F8                MOV     R0,A
050B A3                INC     DPTR
050C E0                MOVX    A,@DPTR
050D F9                MOV     R1,A
050E A3                INC     DPTR
050F E0                MOVX    A,@DPTR
0510 FA                MOV     R2,A
0511 A3                INC     DPTR
0512 E0                MOVX    A,@DPTR
0513 FB                MOV     R3,A
0514 120000      E     LCALL   ?C?LMUL
0517 A804              MOV     R0,AR4
0519 A905              MOV     R1,AR5
051B AA06              MOV     R2,AR6
051D AB07              MOV     R3,AR7
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 107 

051F D007              POP     AR7
0521 D006              POP     AR6
0523 D005              POP     AR5
0525 D004              POP     AR4
0527 C3                CLR     C
0528 EF                MOV     A,R7
0529 9B                SUBB    A,R3
052A FF                MOV     R7,A
052B EE                MOV     A,R6
052C 9A                SUBB    A,R2
052D FE                MOV     R6,A
052E ED                MOV     A,R5
052F 99                SUBB    A,R1
0530 FD                MOV     R5,A
0531 EC                MOV     A,R4
0532 98                SUBB    A,R0
0533 FC                MOV     R4,A
0534 120000      E     LCALL   _filter_vel_3
0537 EE                MOV     A,R6
0538 33                RLC     A
0539 95E0              SUBB    A,ACC
053B FD                MOV     R5,A
053C FC                MOV     R4,A
053D 900000      R     MOV     DPTR,#speed_encoder
0540 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1044
                                           ; SOURCE LINE # 1045
0543         ?C0171:
                                           ; SOURCE LINE # 1047
0543 E4                CLR     A
0544 FF                MOV     R7,A
0545 FE                MOV     R6,A
0546 7DC0              MOV     R5,#0C0H
0548 7C40              MOV     R4,#040H
054A 900000      E     MOV     DPTR,#cycle_time
054D E0                MOVX    A,@DPTR
054E F8                MOV     R0,A
054F A3                INC     DPTR
0550 E0                MOVX    A,@DPTR
0551 F9                MOV     R1,A
0552 A3                INC     DPTR
0553 E0                MOVX    A,@DPTR
0554 FA                MOV     R2,A
0555 A3                INC     DPTR
0556 E0                MOVX    A,@DPTR
0557 FB                MOV     R3,A
0558 120000      E     LCALL   ?C?FPMUL
055B C004              PUSH    AR4
055D C005              PUSH    AR5
055F C006              PUSH    AR6
0561 C007              PUSH    AR7
0563 900000      R     MOV     DPTR,#speed_encoder
0566 E0                MOVX    A,@DPTR
0567 FC                MOV     R4,A
0568 A3                INC     DPTR
0569 E0                MOVX    A,@DPTR
056A FD                MOV     R5,A
056B A3                INC     DPTR
056C E0                MOVX    A,@DPTR
056D FE                MOV     R6,A
056E A3                INC     DPTR
056F E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 108 

0570 FF                MOV     R7,A
0571 EC                MOV     A,R4
0572 120000      E     LCALL   ?C?FCASTL
0575 D003              POP     AR3
0577 D002              POP     AR2
0579 D001              POP     AR1
057B D000              POP     AR0
057D 120000      E     LCALL   ?C?FPDIV
0580 120000      E     LCALL   ?C?CASTF
0583 900000      R     MOV     DPTR,#speed_encoder
0586 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1048
0589 900000      R     MOV     DPTR,#speed_encoder
058C E0                MOVX    A,@DPTR
058D FC                MOV     R4,A
058E A3                INC     DPTR
058F E0                MOVX    A,@DPTR
0590 FD                MOV     R5,A
0591 A3                INC     DPTR
0592 E0                MOVX    A,@DPTR
0593 FE                MOV     R6,A
0594 A3                INC     DPTR
0595 E0                MOVX    A,@DPTR
0596 FF                MOV     R7,A
0597 E500        R     MOV     A,index
0599 25E0              ADD     A,ACC
059B 25E0              ADD     A,ACC
059D 2400        E     ADD     A,#LOW g_meas+01FH
059F F582              MOV     DPL,A
05A1 E4                CLR     A
05A2 3400        E     ADDC    A,#HIGH g_meas+01FH
05A4 F583              MOV     DPH,A
05A6 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1070
05A9 E500        R     MOV     A,index
05AB 25E0              ADD     A,ACC
05AD 25E0              ADD     A,ACC
05AF 2400        R     ADD     A,#LOW vv_value
05B1 F582              MOV     DPL,A
05B3 E4                CLR     A
05B4 3400        R     ADDC    A,#HIGH vv_value
05B6 F583              MOV     DPH,A
05B8 E0                MOVX    A,@DPTR
05B9 FC                MOV     R4,A
05BA A3                INC     DPTR
05BB E0                MOVX    A,@DPTR
05BC FD                MOV     R5,A
05BD A3                INC     DPTR
05BE E0                MOVX    A,@DPTR
05BF FE                MOV     R6,A
05C0 A3                INC     DPTR
05C1 E0                MOVX    A,@DPTR
05C2 FF                MOV     R7,A
05C3 E500        R     MOV     A,index
05C5 25E0              ADD     A,ACC
05C7 25E0              ADD     A,ACC
05C9 2400        R     ADD     A,#LOW vvv_value
05CB F582              MOV     DPL,A
05CD E4                CLR     A
05CE 3400        R     ADDC    A,#HIGH vvv_value
05D0 F583              MOV     DPH,A
05D2 120000      E     LCALL   ?C?LSTXDATA
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 109 

                                           ; SOURCE LINE # 1071
05D5 E500        R     MOV     A,index
05D7 25E0              ADD     A,ACC
05D9 25E0              ADD     A,ACC
05DB 2400        R     ADD     A,#LOW v_value
05DD F582              MOV     DPL,A
05DF E4                CLR     A
05E0 3400        R     ADDC    A,#HIGH v_value
05E2 F583              MOV     DPH,A
05E4 E0                MOVX    A,@DPTR
05E5 FC                MOV     R4,A
05E6 A3                INC     DPTR
05E7 E0                MOVX    A,@DPTR
05E8 FD                MOV     R5,A
05E9 A3                INC     DPTR
05EA E0                MOVX    A,@DPTR
05EB FE                MOV     R6,A
05EC A3                INC     DPTR
05ED E0                MOVX    A,@DPTR
05EE FF                MOV     R7,A
05EF E500        R     MOV     A,index
05F1 25E0              ADD     A,ACC
05F3 25E0              ADD     A,ACC
05F5 2400        R     ADD     A,#LOW vv_value
05F7 F582              MOV     DPL,A
05F9 E4                CLR     A
05FA 3400        R     ADDC    A,#HIGH vv_value
05FC F583              MOV     DPH,A
05FE 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1072
0601 900000      R     MOV     DPTR,#value_encoder
0604 E0                MOVX    A,@DPTR
0605 FC                MOV     R4,A
0606 A3                INC     DPTR
0607 E0                MOVX    A,@DPTR
0608 FD                MOV     R5,A
0609 A3                INC     DPTR
060A E0                MOVX    A,@DPTR
060B FE                MOV     R6,A
060C A3                INC     DPTR
060D E0                MOVX    A,@DPTR
060E FF                MOV     R7,A
060F E500        R     MOV     A,index
0611 25E0              ADD     A,ACC
0613 25E0              ADD     A,ACC
0615 2400        R     ADD     A,#LOW v_value
0617 F582              MOV     DPL,A
0619 E4                CLR     A
061A 3400        R     ADDC    A,#HIGH v_value
061C F583              MOV     DPH,A
061E 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1082
0621 300003      R     JNB     pos_reconstruct,$ + 6H
0624 020000      R     LJMP    ?C0153
                                           ; SOURCE LINE # 1083
0627 900000      R     MOV     DPTR,#one_time_execute
062A E0                MOVX    A,@DPTR
062B C3                CLR     C
062C 9422              SUBB    A,#022H
062E 5004              JNC     ?C0176
                                           ; SOURCE LINE # 1084
0630 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 110 

0631 04                INC     A
0632 F0                MOVX    @DPTR,A
0633 22                RET     
0634         ?C0176:
                                           ; SOURCE LINE # 1085
                                           ; SOURCE LINE # 1087
0634 900000      E     MOV     DPTR,#c_mem+079H
0637 E0                MOVX    A,@DPTR
0638 606E              JZ      ?C0178
                                           ; SOURCE LINE # 1089
063A 900000      E     MOV     DPTR,#g_meas+04H
063D E0                MOVX    A,@DPTR
063E FC                MOV     R4,A
063F A3                INC     DPTR
0640 E0                MOVX    A,@DPTR
0641 FD                MOV     R5,A
0642 A3                INC     DPTR
0643 E0                MOVX    A,@DPTR
0644 FE                MOV     R6,A
0645 A3                INC     DPTR
0646 E0                MOVX    A,@DPTR
0647 FF                MOV     R7,A
0648 900000      E     MOV     DPTR,#?_calc_turns_fcn?BYTE+04H
064B 120000      E     LCALL   ?C?LSTXDATA
064E 900000      E     MOV     DPTR,#g_meas
0651 E0                MOVX    A,@DPTR
0652 FC                MOV     R4,A
0653 A3                INC     DPTR
0654 E0                MOVX    A,@DPTR
0655 FD                MOV     R5,A
0656 A3                INC     DPTR
0657 E0                MOVX    A,@DPTR
0658 FE                MOV     R6,A
0659 A3                INC     DPTR
065A E0                MOVX    A,@DPTR
065B FF                MOV     R7,A
065C 120000      E     LCALL   _calc_turns_fcn
065F EE                MOV     A,R6
0660 33                RLC     A
0661 95E0              SUBB    A,ACC
0663 FD                MOV     R5,A
0664 FC                MOV     R4,A
0665 900000      R     MOV     DPTR,#init_rot
0668 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1091
066B E4                CLR     A
066C FF                MOV     R7,A
066D FE                MOV     R6,A
066E FD                MOV     R5,A
066F FC                MOV     R4,A
0670 900000      E     MOV     DPTR,#c_mem+044H
0673 E0                MOVX    A,@DPTR
0674 F8                MOV     R0,A
0675 A3                INC     DPTR
0676 E0                MOVX    A,@DPTR
0677 F9                MOV     R1,A
0678 A3                INC     DPTR
0679 E0                MOVX    A,@DPTR
067A FA                MOV     R2,A
067B A3                INC     DPTR
067C E0                MOVX    A,@DPTR
067D FB                MOV     R3,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 111 

067E 120000      E     LCALL   ?C?FPCMP3
0681 5017              JNC     ?C0179
                                           ; SOURCE LINE # 1092
0683 900000      R     MOV     DPTR,#init_rot
0686 E0                MOVX    A,@DPTR
0687 FC                MOV     R4,A
0688 A3                INC     DPTR
0689 E0                MOVX    A,@DPTR
068A FD                MOV     R5,A
068B A3                INC     DPTR
068C E0                MOVX    A,@DPTR
068D FE                MOV     R6,A
068E A3                INC     DPTR
068F E0                MOVX    A,@DPTR
0690 FF                MOV     R7,A
0691 120000      E     LCALL   ?C?LNEG
0694 900000      R     MOV     DPTR,#init_rot
0697 120000      E     LCALL   ?C?LSTXDATA
069A         ?C0179:
                                           ; SOURCE LINE # 1094
069A 900000      R     MOV     DPTR,#init_rot
069D E0                MOVX    A,@DPTR
069E A3                INC     DPTR
069F E0                MOVX    A,@DPTR
06A0 A3                INC     DPTR
06A1 E0                MOVX    A,@DPTR
06A2 A3                INC     DPTR
06A3 E0                MOVX    A,@DPTR
06A4 900000      E     MOV     DPTR,#g_meas+014H
06A7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1096
06A8         ?C0178:
                                           ; SOURCE LINE # 1098
06A8 7400        E     MOV     A,#LOW c_mem+044H
06AA 6401              XRL     A,#01H
06AC 4400        E     ORL     A,#HIGH c_mem+044H
06AE 602C              JZ      ?C0180
                                           ; SOURCE LINE # 1099
06B0 900000      E     MOV     DPTR,#g_meas
06B3 E0                MOVX    A,@DPTR
06B4 FC                MOV     R4,A
06B5 A3                INC     DPTR
06B6 E0                MOVX    A,@DPTR
06B7 FD                MOV     R5,A
06B8 A3                INC     DPTR
06B9 E0                MOVX    A,@DPTR
06BA FE                MOV     R6,A
06BB A3                INC     DPTR
06BC E0                MOVX    A,@DPTR
06BD FF                MOV     R7,A
06BE EC                MOV     A,R4
06BF 120000      E     LCALL   ?C?FCASTL
06C2 900000      E     MOV     DPTR,#c_mem+044H
06C5 E0                MOVX    A,@DPTR
06C6 F8                MOV     R0,A
06C7 A3                INC     DPTR
06C8 E0                MOVX    A,@DPTR
06C9 F9                MOV     R1,A
06CA A3                INC     DPTR
06CB E0                MOVX    A,@DPTR
06CC FA                MOV     R2,A
06CD A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 112 

06CE E0                MOVX    A,@DPTR
06CF FB                MOV     R3,A
06D0 120000      E     LCALL   ?C?FPDIV
06D3 120000      E     LCALL   ?C?CASTF
06D6 900000      E     MOV     DPTR,#g_meas
06D9 120000      E     LCALL   ?C?LSTXDATA
06DC         ?C0180:
                                           ; SOURCE LINE # 1101
06DC 900000      E     MOV     DPTR,#g_meas
06DF E0                MOVX    A,@DPTR
06E0 F8                MOV     R0,A
06E1 A3                INC     DPTR
06E2 E0                MOVX    A,@DPTR
06E3 F9                MOV     R1,A
06E4 A3                INC     DPTR
06E5 E0                MOVX    A,@DPTR
06E6 FA                MOV     R2,A
06E7 A3                INC     DPTR
06E8 E0                MOVX    A,@DPTR
06E9 FB                MOV     R3,A
06EA C000              PUSH    AR0
06EC 900000      R     MOV     DPTR,#init_rot
06EF E0                MOVX    A,@DPTR
06F0 FC                MOV     R4,A
06F1 A3                INC     DPTR
06F2 E0                MOVX    A,@DPTR
06F3 FD                MOV     R5,A
06F4 A3                INC     DPTR
06F5 E0                MOVX    A,@DPTR
06F6 FE                MOV     R6,A
06F7 A3                INC     DPTR
06F8 E0                MOVX    A,@DPTR
06F9 FF                MOV     R7,A
06FA 7810              MOV     R0,#010H
06FC 120000      E     LCALL   ?C?LSHL
06FF D000              POP     AR0
0701 EB                MOV     A,R3
0702 2F                ADD     A,R7
0703 FF                MOV     R7,A
0704 EA                MOV     A,R2
0705 3E                ADDC    A,R6
0706 FE                MOV     R6,A
0707 E9                MOV     A,R1
0708 3D                ADDC    A,R5
0709 FD                MOV     R5,A
070A E8                MOV     A,R0
070B 3C                ADDC    A,R4
070C FC                MOV     R4,A
070D 900000      E     MOV     DPTR,#g_meas
0710 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1103
0713 7400        E     MOV     A,#LOW c_mem+044H
0715 6401              XRL     A,#01H
0717 4400        E     ORL     A,#HIGH c_mem+044H
0719 602C              JZ      ?C0181
                                           ; SOURCE LINE # 1104
071B 900000      E     MOV     DPTR,#g_meas
071E E0                MOVX    A,@DPTR
071F FC                MOV     R4,A
0720 A3                INC     DPTR
0721 E0                MOVX    A,@DPTR
0722 FD                MOV     R5,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 113 

0723 A3                INC     DPTR
0724 E0                MOVX    A,@DPTR
0725 FE                MOV     R6,A
0726 A3                INC     DPTR
0727 E0                MOVX    A,@DPTR
0728 FF                MOV     R7,A
0729 EC                MOV     A,R4
072A 120000      E     LCALL   ?C?FCASTL
072D 900000      E     MOV     DPTR,#c_mem+044H
0730 E0                MOVX    A,@DPTR
0731 F8                MOV     R0,A
0732 A3                INC     DPTR
0733 E0                MOVX    A,@DPTR
0734 F9                MOV     R1,A
0735 A3                INC     DPTR
0736 E0                MOVX    A,@DPTR
0737 FA                MOV     R2,A
0738 A3                INC     DPTR
0739 E0                MOVX    A,@DPTR
073A FB                MOV     R3,A
073B 120000      E     LCALL   ?C?FPMUL
073E 120000      E     LCALL   ?C?CASTF
0741 900000      E     MOV     DPTR,#g_meas
0744 120000      E     LCALL   ?C?LSTXDATA
0747         ?C0181:
                                           ; SOURCE LINE # 1107
0747 900000      E     MOV     DPTR,#g_meas
074A E0                MOVX    A,@DPTR
074B FC                MOV     R4,A
074C A3                INC     DPTR
074D E0                MOVX    A,@DPTR
074E FD                MOV     R5,A
074F A3                INC     DPTR
0750 E0                MOVX    A,@DPTR
0751 FE                MOV     R6,A
0752 A3                INC     DPTR
0753 E0                MOVX    A,@DPTR
0754 FF                MOV     R7,A
0755 900000      E     MOV     DPTR,#g_refNew
0758 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1109
075B 900000      E     MOV     DPTR,#g_ref+018H
075E E0                MOVX    A,@DPTR
075F FF                MOV     R7,A
0760 120000      E     LCALL   _MOTOR_ON_OFF_Write
                                           ; SOURCE LINE # 1111
0763 D200        R     SETB    pos_reconstruct
                                           ; SOURCE LINE # 1112
                                           ; SOURCE LINE # 1113
                                           ; SOURCE LINE # 1114
0765         ?C0153:
0765 22                RET     
             ; FUNCTION _encoder_reading (END)

             ; FUNCTION analog_read_end (BEGIN)
                                           ; SOURCE LINE # 1120
0000         ?C0182:
                                           ; SOURCE LINE # 1152
0000 120000      E     LCALL   ADC_STATUS_Read
0003 EF                MOV     A,R7
0004 700A              JNZ     ?C0183
                                           ; SOURCE LINE # 1153
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 114 

0006 3000F7            JNB     interrupt_flag,?C0182
                                           ; SOURCE LINE # 1154
0009 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1155
000B 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1156
                                           ; SOURCE LINE # 1157
000E 80F0              SJMP    ?C0182
0010         ?C0183:
                                           ; SOURCE LINE # 1160
0010 900000      E     MOV     DPTR,#ADC_buf+01H
0013 E0                MOVX    A,@DPTR
0014 249A              ADD     A,#09AH
0016 FF                MOV     R7,A
0017 900000      E     MOV     DPTR,#ADC_buf
001A E0                MOVX    A,@DPTR
001B 34F9              ADDC    A,#0F9H
001D FE                MOV     R6,A
001E 33                RLC     A
001F 95E0              SUBB    A,ACC
0021 FD                MOV     R5,A
0022 FC                MOV     R4,A
0023 E4                CLR     A
0024 7BA0              MOV     R3,#0A0H
0026 7A07              MOV     R2,#07H
0028 F9                MOV     R1,A
0029 F8                MOV     R0,A
002A 120000      E     LCALL   ?C?LMUL
002D 7807              MOV     R0,#07H
002F 120000      E     LCALL   ?C?SLSHR
0032 900000      E     MOV     DPTR,#dev_tension
0035 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1162
0038 300005            JNB     interrupt_flag,?C0185
                                           ; SOURCE LINE # 1163
003B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1164
003D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1165
0040         ?C0185:
                                           ; SOURCE LINE # 1166
0040 900000      R     MOV     DPTR,#first_tension_valid
0043 E0                MOVX    A,@DPTR
0044 7003              JNZ     $ + 5H
0046 020000      R     LJMP    ?C0186
0049 200003      E     JB      tension_valid,$ + 6H
004C 020000      R     LJMP    ?C0186
                                           ; SOURCE LINE # 1167
004F 900000      R     MOV     DPTR,#count+01H
0052 E0                MOVX    A,@DPTR
0053 04                INC     A
0054 F0                MOVX    @DPTR,A
0055 7006              JNZ     ?C0312
0057 900000      R     MOV     DPTR,#count
005A E0                MOVX    A,@DPTR
005B 04                INC     A
005C F0                MOVX    @DPTR,A
005D         ?C0312:
                                           ; SOURCE LINE # 1169
005D 900000      R     MOV     DPTR,#count
0060 E0                MOVX    A,@DPTR
0061 6403              XRL     A,#03H
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 115 

0063 7004              JNZ     ?C0313
0065 A3                INC     DPTR
0066 E0                MOVX    A,@DPTR
0067 64E8              XRL     A,#0E8H
0069         ?C0313:
0069 7065              JNZ     ?C0186
                                           ; SOURCE LINE # 1170
006B 7F28              MOV     R7,#028H
006D 7E23              MOV     R6,#023H
006F FD                MOV     R5,A
0070 FC                MOV     R4,A
0071 900000      E     MOV     DPTR,#dev_tension
0074 E0                MOVX    A,@DPTR
0075 F8                MOV     R0,A
0076 A3                INC     DPTR
0077 E0                MOVX    A,@DPTR
0078 F9                MOV     R1,A
0079 A3                INC     DPTR
007A E0                MOVX    A,@DPTR
007B FA                MOV     R2,A
007C A3                INC     DPTR
007D E0                MOVX    A,@DPTR
007E FB                MOV     R3,A
007F C3                CLR     C
0080 120000      E     LCALL   ?C?SLCMP
0083 500F              JNC     ?C0188
                                           ; SOURCE LINE # 1171
0085 E4                CLR     A
0086 7F40              MOV     R7,#040H
0088 7E1F              MOV     R6,#01FH
008A FD                MOV     R5,A
008B FC                MOV     R4,A
008C 900000      R     MOV     DPTR,#pow_tension
008F 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1172
0092 8037              SJMP    ?C0189
0094         ?C0188:
                                           ; SOURCE LINE # 1173
                                           ; SOURCE LINE # 1174
0094 E4                CLR     A
0095 7FC8              MOV     R7,#0C8H
0097 7E32              MOV     R6,#032H
0099 FD                MOV     R5,A
009A FC                MOV     R4,A
009B 900000      E     MOV     DPTR,#dev_tension
009E E0                MOVX    A,@DPTR
009F F8                MOV     R0,A
00A0 A3                INC     DPTR
00A1 E0                MOVX    A,@DPTR
00A2 F9                MOV     R1,A
00A3 A3                INC     DPTR
00A4 E0                MOVX    A,@DPTR
00A5 FA                MOV     R2,A
00A6 A3                INC     DPTR
00A7 E0                MOVX    A,@DPTR
00A8 FB                MOV     R3,A
00A9 C3                CLR     C
00AA 120000      E     LCALL   ?C?SLCMP
00AD 500F              JNC     ?C0190
                                           ; SOURCE LINE # 1175
00AF E4                CLR     A
00B0 7FE0              MOV     R7,#0E0H
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 116 

00B2 7E2E              MOV     R6,#02EH
00B4 FD                MOV     R5,A
00B5 FC                MOV     R4,A
00B6 900000      R     MOV     DPTR,#pow_tension
00B9 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1176
00BC 800D              SJMP    ?C0189
00BE         ?C0190:
                                           ; SOURCE LINE # 1178
00BE E4                CLR     A
00BF 7FC0              MOV     R7,#0C0H
00C1 7E5D              MOV     R6,#05DH
00C3 FD                MOV     R5,A
00C4 FC                MOV     R4,A
00C5 900000      R     MOV     DPTR,#pow_tension
00C8 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1179
00CB         ?C0189:
                                           ; SOURCE LINE # 1181
00CB E4                CLR     A
00CC 900000      R     MOV     DPTR,#first_tension_valid
00CF F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1182
                                           ; SOURCE LINE # 1183
00D0         ?C0186:
                                           ; SOURCE LINE # 1187
00D0 E4                CLR     A
00D1 7F58              MOV     R7,#058H
00D3 7E1B              MOV     R6,#01BH
00D5 FD                MOV     R5,A
00D6 FC                MOV     R4,A
00D7 900000      E     MOV     DPTR,#dev_tension
00DA E0                MOVX    A,@DPTR
00DB F8                MOV     R0,A
00DC A3                INC     DPTR
00DD E0                MOVX    A,@DPTR
00DE F9                MOV     R1,A
00DF A3                INC     DPTR
00E0 E0                MOVX    A,@DPTR
00E1 FA                MOV     R2,A
00E2 A3                INC     DPTR
00E3 E0                MOVX    A,@DPTR
00E4 FB                MOV     R3,A
00E5 D3                SETB    C
00E6 120000      E     LCALL   ?C?SLCMP
00E9 5003              JNC     $ + 5H
00EB 020000      R     LJMP    ?C0192
                                           ; SOURCE LINE # 1190
00EE E4                CLR     A
00EF 7FE8              MOV     R7,#0E8H
00F1 7E03              MOV     R6,#03H
00F3 FD                MOV     R5,A
00F4 FC                MOV     R4,A
00F5 900000      R     MOV     DPTR,#count2
00F8 E0                MOVX    A,@DPTR
00F9 F8                MOV     R0,A
00FA A3                INC     DPTR
00FB E0                MOVX    A,@DPTR
00FC F9                MOV     R1,A
00FD A3                INC     DPTR
00FE E0                MOVX    A,@DPTR
00FF FA                MOV     R2,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 117 

0100 A3                INC     DPTR
0101 E0                MOVX    A,@DPTR
0102 FB                MOV     R3,A
0103 120000      E     LCALL   ?C?ULCMP
0106 7004              JNZ     ?C0193
                                           ; SOURCE LINE # 1191
0108 D200        E     SETB    tension_valid
                                           ; SOURCE LINE # 1192
010A 8036              SJMP    ?C0194
010C         ?C0193:
                                           ; SOURCE LINE # 1193
                                           ; SOURCE LINE # 1194
010C 900000      R     MOV     DPTR,#count2
010F E0                MOVX    A,@DPTR
0110 FC                MOV     R4,A
0111 A3                INC     DPTR
0112 E0                MOVX    A,@DPTR
0113 FD                MOV     R5,A
0114 A3                INC     DPTR
0115 E0                MOVX    A,@DPTR
0116 FE                MOV     R6,A
0117 A3                INC     DPTR
0118 E0                MOVX    A,@DPTR
0119 2401              ADD     A,#01H
011B FF                MOV     R7,A
011C E4                CLR     A
011D 3E                ADDC    A,R6
011E FE                MOV     R6,A
011F E4                CLR     A
0120 3D                ADDC    A,R5
0121 FD                MOV     R5,A
0122 E4                CLR     A
0123 3C                ADDC    A,R4
0124 FC                MOV     R4,A
0125 900000      R     MOV     DPTR,#count2
0128 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1195
012B 900000      E     MOV     DPTR,#dev_tension
012E E0                MOVX    A,@DPTR
012F FC                MOV     R4,A
0130 A3                INC     DPTR
0131 E0                MOVX    A,@DPTR
0132 FD                MOV     R5,A
0133 A3                INC     DPTR
0134 E0                MOVX    A,@DPTR
0135 FE                MOV     R6,A
0136 A3                INC     DPTR
0137 E0                MOVX    A,@DPTR
0138 FF                MOV     R7,A
0139 120000      E     LCALL   _filter_voltage
013C 900000      E     MOV     DPTR,#dev_tension_f
013F 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1196
0142         ?C0194:
                                           ; SOURCE LINE # 1198
0142 900000      E     MOV     DPTR,#g_mem+07BH
0145 E0                MOVX    A,@DPTR
0146 6003              JZ      ?C0195
                                           ; SOURCE LINE # 1199
0148 120000      R     LCALL   pwm_limit_search
014B         ?C0195:
                                           ; SOURCE LINE # 1202
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 118 

014B 900000      E     MOV     DPTR,#ADC_buf+03H
014E E0                MOVX    A,@DPTR
014F 249A              ADD     A,#09AH
0151 FF                MOV     R7,A
0152 900000      E     MOV     DPTR,#ADC_buf+02H
0155 E0                MOVX    A,@DPTR
0156 34F9              ADDC    A,#0F9H
0158 FE                MOV     R6,A
0159 33                RLC     A
015A 95E0              SUBB    A,ACC
015C FD                MOV     R5,A
015D FC                MOV     R4,A
015E E4                CLR     A
015F 7BAB              MOV     R3,#0ABH
0161 7A64              MOV     R2,#064H
0163 F9                MOV     R1,A
0164 F8                MOV     R0,A
0165 120000      E     LCALL   ?C?LMUL
0168 780D              MOV     R0,#0DH
016A 120000      E     LCALL   ?C?SLSHR
016D 900000      E     MOV     DPTR,#pwm_sign
0170 E0                MOVX    A,@DPTR
0171 FD                MOV     R5,A
0172 33                RLC     A
0173 95E0              SUBB    A,ACC
0175 FC                MOV     R4,A
0176 120000      E     LCALL   ?C?IMUL
0179 EE                MOV     A,R6
017A 33                RLC     A
017B 95E0              SUBB    A,ACC
017D FD                MOV     R5,A
017E FC                MOV     R4,A
017F 120000      E     LCALL   _filter_i1
0182 900000      E     MOV     DPTR,#g_meas+0CH
0185 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1205
0188 900000      E     MOV     DPTR,#g_meas
018B E0                MOVX    A,@DPTR
018C FC                MOV     R4,A
018D A3                INC     DPTR
018E E0                MOVX    A,@DPTR
018F FD                MOV     R5,A
0190 A3                INC     DPTR
0191 E0                MOVX    A,@DPTR
0192 FE                MOV     R6,A
0193 A3                INC     DPTR
0194 E0                MOVX    A,@DPTR
0195 FF                MOV     R7,A
0196 900000      E     MOV     DPTR,#g_mem+035H
0199 E0                MOVX    A,@DPTR
019A F9                MOV     R1,A
019B F8                MOV     R0,A
019C 120000      E     LCALL   ?C?SLSHR
019F C004              PUSH    AR4
01A1 C005              PUSH    AR5
01A3 C006              PUSH    AR6
01A5 C007              PUSH    AR7
01A7 900000      E     MOV     DPTR,#g_meas+01FH
01AA E0                MOVX    A,@DPTR
01AB FC                MOV     R4,A
01AC A3                INC     DPTR
01AD E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 119 

01AE FD                MOV     R5,A
01AF A3                INC     DPTR
01B0 E0                MOVX    A,@DPTR
01B1 FE                MOV     R6,A
01B2 A3                INC     DPTR
01B3 E0                MOVX    A,@DPTR
01B4 FF                MOV     R7,A
01B5 900000      E     MOV     DPTR,#g_mem+035H
01B8 E0                MOVX    A,@DPTR
01B9 F8                MOV     R0,A
01BA 120000      E     LCALL   ?C?SLSHR
01BD 900000      E     MOV     DPTR,#?_curr_estim?BYTE+04H
01C0 120000      E     LCALL   ?C?LSTXDATA
01C3 900000      E     MOV     DPTR,#g_ref
01C6 E0                MOVX    A,@DPTR
01C7 FC                MOV     R4,A
01C8 A3                INC     DPTR
01C9 E0                MOVX    A,@DPTR
01CA FD                MOV     R5,A
01CB A3                INC     DPTR
01CC E0                MOVX    A,@DPTR
01CD FE                MOV     R6,A
01CE A3                INC     DPTR
01CF E0                MOVX    A,@DPTR
01D0 FF                MOV     R7,A
01D1 A801              MOV     R0,AR1
01D3 120000      E     LCALL   ?C?SLSHR
01D6 900000      E     MOV     DPTR,#?_curr_estim?BYTE+08H
01D9 120000      E     LCALL   ?C?LSTXDATA
01DC D007              POP     AR7
01DE D006              POP     AR6
01E0 D005              POP     AR5
01E2 D004              POP     AR4
01E4 120000      E     LCALL   _curr_estim
01E7 A804              MOV     R0,AR4
01E9 A905              MOV     R1,AR5
01EB AA06              MOV     R2,AR6
01ED AB07              MOV     R3,AR7
01EF 900000      E     MOV     DPTR,#g_meas+0CH
01F2 E0                MOVX    A,@DPTR
01F3 FC                MOV     R4,A
01F4 A3                INC     DPTR
01F5 E0                MOVX    A,@DPTR
01F6 FD                MOV     R5,A
01F7 A3                INC     DPTR
01F8 E0                MOVX    A,@DPTR
01F9 FE                MOV     R6,A
01FA A3                INC     DPTR
01FB E0                MOVX    A,@DPTR
01FC C3                CLR     C
01FD 9B                SUBB    A,R3
01FE FF                MOV     R7,A
01FF EE                MOV     A,R6
0200 9A                SUBB    A,R2
0201 FE                MOV     R6,A
0202 ED                MOV     A,R5
0203 99                SUBB    A,R1
0204 FD                MOV     R5,A
0205 EC                MOV     A,R4
0206 98                SUBB    A,R0
0207 FC                MOV     R4,A
0208 120000      E     LCALL   _filter_curr_diff
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 120 

020B EE                MOV     A,R6
020C 33                RLC     A
020D 95E0              SUBB    A,ACC
020F FD                MOV     R5,A
0210 FC                MOV     R4,A
0211 900000      E     MOV     DPTR,#g_meas+010H
0214 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1209
0217 300005            JNB     interrupt_flag,?C0196
                                           ; SOURCE LINE # 1210
021A C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1211
021C 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1212
021F         ?C0196:
                                           ; SOURCE LINE # 1215
021F 900000      E     MOV     DPTR,#g_mem+06FH
0222 E0                MOVX    A,@DPTR
0223 7004              JNZ     ?C0197
                                           ; SOURCE LINE # 1216
0225 F500        E     MOV     emg_1_status,A
                                           ; SOURCE LINE # 1217
0227 F500        E     MOV     emg_2_status,A
                                           ; SOURCE LINE # 1218
0229         ?C0197:
                                           ; SOURCE LINE # 1223
0229 E500        E     MOV     A,emg_1_status
022B 14                DEC     A
022C 7003              JNZ     $ + 5H
022E 020000      R     LJMP    ?C0206
0231 14                DEC     A
0232 7003              JNZ     $ + 5H
0234 020000      R     LJMP    ?C0207
0237 14                DEC     A
0238 7003              JNZ     $ + 5H
023A 020000      R     LJMP    ?C0210
023D 2403              ADD     A,#03H
023F 6003              JZ      $ + 5H
0241 020000      R     LJMP    ?C0198
                                           ; SOURCE LINE # 1224
0244         ?C0199:
                                           ; SOURCE LINE # 1225
0244 900000      E     MOV     DPTR,#g_mem+0A5H
0247 E0                MOVX    A,@DPTR
0248 25E0              ADD     A,ACC
024A 2400        E     ADD     A,#LOW ADC_buf+04H
024C F582              MOV     DPL,A
024E E4                CLR     A
024F 3400        E     ADDC    A,#HIGH ADC_buf+04H
0251 F583              MOV     DPH,A
0253 E0                MOVX    A,@DPTR
0254 FE                MOV     R6,A
0255 A3                INC     DPTR
0256 E0                MOVX    A,@DPTR
0257 FF                MOV     R7,A
0258 EE                MOV     A,R6
0259 33                RLC     A
025A 95E0              SUBB    A,ACC
025C 8F00        R     MOV     i_aux+03H,R7
025E 8E00        R     MOV     i_aux+02H,R6
0260 F500        R     MOV     i_aux+01H,A
0262 F500        R     MOV     i_aux,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 121 

                                           ; SOURCE LINE # 1226
0264 E4                CLR     A
0265 FF                MOV     R7,A
0266 FE                MOV     R6,A
0267 FD                MOV     R5,A
0268 FC                MOV     R4,A
0269 AB00        R     MOV     R3,i_aux+03H
026B AA00        R     MOV     R2,i_aux+02H
026D A900        R     MOV     R1,i_aux+01H
026F A800        R     MOV     R0,i_aux
0271 C3                CLR     C
0272 120000      E     LCALL   ?C?SLCMP
0275 5009              JNC     ?C0200
                                           ; SOURCE LINE # 1227
0277 E4                CLR     A
0278 F500        R     MOV     i_aux+03H,A
027A F500        R     MOV     i_aux+02H,A
027C F500        R     MOV     i_aux+01H,A
027E F500        R     MOV     i_aux,A
0280         ?C0200:
                                           ; SOURCE LINE # 1228
0280 AF00        R     MOV     R7,i_aux+03H
0282 AE00        R     MOV     R6,i_aux+02H
0284 AD00        R     MOV     R5,i_aux+01H
0286 AC00        R     MOV     R4,i_aux
0288 120000      E     LCALL   _filter_ch1
028B 8F00        R     MOV     i_aux+03H,R7
028D 8E00        R     MOV     i_aux+02H,R6
028F 8D00        R     MOV     i_aux+01H,R5
0291 8C00        R     MOV     i_aux,R4
                                           ; SOURCE LINE # 1229
0293 780A              MOV     R0,#0AH
0295 120000      E     LCALL   ?C?LSHL
0298 900000      E     MOV     DPTR,#g_mem+070H
029B E0                MOVX    A,@DPTR
029C F8                MOV     R0,A
029D A3                INC     DPTR
029E E0                MOVX    A,@DPTR
029F F9                MOV     R1,A
02A0 A3                INC     DPTR
02A1 E0                MOVX    A,@DPTR
02A2 FA                MOV     R2,A
02A3 A3                INC     DPTR
02A4 E0                MOVX    A,@DPTR
02A5 FB                MOV     R3,A
02A6 120000      E     LCALL   ?C?ULDIV
02A9 8F00        R     MOV     i_aux+03H,R7
02AB 8E00        R     MOV     i_aux+02H,R6
02AD 8D00        R     MOV     i_aux+01H,R5
02AF 8C00        R     MOV     i_aux,R4
                                           ; SOURCE LINE # 1231
02B1 300005            JNB     interrupt_flag,?C0201
                                           ; SOURCE LINE # 1232
02B4 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1233
02B6 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1234
02B9         ?C0201:
                                           ; SOURCE LINE # 1236
02B9 E4                CLR     A
02BA FF                MOV     R7,A
02BB FE                MOV     R6,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 122 

02BC FD                MOV     R5,A
02BD FC                MOV     R4,A
02BE AB00        R     MOV     R3,i_aux+03H
02C0 AA00        R     MOV     R2,i_aux+02H
02C2 A900        R     MOV     R1,i_aux+01H
02C4 A800        R     MOV     R0,i_aux
02C6 C3                CLR     C
02C7 120000      E     LCALL   ?C?SLCMP
02CA 500B              JNC     ?C0202
                                           ; SOURCE LINE # 1237
02CC E4                CLR     A
02CD F500        R     MOV     i_aux+03H,A
02CF F500        R     MOV     i_aux+02H,A
02D1 F500        R     MOV     i_aux+01H,A
02D3 F500        R     MOV     i_aux,A
02D5 801E              SJMP    ?C0203
02D7         ?C0202:
                                           ; SOURCE LINE # 1239
02D7 E4                CLR     A
02D8 FF                MOV     R7,A
02D9 7E04              MOV     R6,#04H
02DB FD                MOV     R5,A
02DC FC                MOV     R4,A
02DD AB00        R     MOV     R3,i_aux+03H
02DF AA00        R     MOV     R2,i_aux+02H
02E1 A900        R     MOV     R1,i_aux+01H
02E3 A800        R     MOV     R0,i_aux
02E5 D3                SETB    C
02E6 120000      E     LCALL   ?C?SLCMP
02E9 400A              JC      ?C0203
                                           ; SOURCE LINE # 1240
02EB E4                CLR     A
02EC F500        R     MOV     i_aux+03H,A
02EE 750004      R     MOV     i_aux+02H,#04H
02F1 F500        R     MOV     i_aux+01H,A
02F3 F500        R     MOV     i_aux,A
02F5         ?C0203:
                                           ; SOURCE LINE # 1242
02F5 AF00        R     MOV     R7,i_aux+03H
02F7 AE00        R     MOV     R6,i_aux+02H
02F9 AD00        R     MOV     R5,i_aux+01H
02FB AC00        R     MOV     R4,i_aux
02FD 900000      E     MOV     DPTR,#g_meas+017H
0300 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1244
0303 200003      E     JB      interrupt_flag,$ + 6H
0306 020000      R     LJMP    ?C0198
                                           ; SOURCE LINE # 1245
0309 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1246
030B 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1247
                                           ; SOURCE LINE # 1249
030E 020000      R     LJMP    ?C0198
                                           ; SOURCE LINE # 1251
0311         ?C0206:
                                           ; SOURCE LINE # 1252
0311 E4                CLR     A
0312 900000      R     MOV     DPTR,#emg_counter_1
0315 F0                MOVX    @DPTR,A
0316 A3                INC     DPTR
0317 F0                MOVX    @DPTR,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 123 

                                           ; SOURCE LINE # 1253
0318 FF                MOV     R7,A
0319 FE                MOV     R6,A
031A FD                MOV     R5,A
031B FC                MOV     R4,A
031C 900000      E     MOV     DPTR,#g_mem+070H
031F 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1254
0322 750002      E     MOV     emg_1_status,#02H
                                           ; SOURCE LINE # 1256
0325 020000      R     LJMP    ?C0198
                                           ; SOURCE LINE # 1258
0328         ?C0207:
                                           ; SOURCE LINE # 1259
0328 900000      R     MOV     DPTR,#emg_counter_1+01H
032B E0                MOVX    A,@DPTR
032C 04                INC     A
032D F0                MOVX    @DPTR,A
032E 7006              JNZ     ?C0314
0330 900000      R     MOV     DPTR,#emg_counter_1
0333 E0                MOVX    A,@DPTR
0334 04                INC     A
0335 F0                MOVX    @DPTR,A
0336         ?C0314:
                                           ; SOURCE LINE # 1260
0336 900000      R     MOV     DPTR,#emg_counter_1
0339 E0                MOVX    A,@DPTR
033A 6401              XRL     A,#01H
033C 7004              JNZ     ?C0315
033E A3                INC     DPTR
033F E0                MOVX    A,@DPTR
0340 64F4              XRL     A,#0F4H
0342         ?C0315:
0342 6003              JZ      $ + 5H
0344 020000      R     LJMP    ?C0198
                                           ; SOURCE LINE # 1261
0347 900000      R     MOV     DPTR,#emg_counter_1
034A F0                MOVX    @DPTR,A
034B A3                INC     DPTR
034C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1263
034D 7F01              MOV     R7,#01H
034F 120000      E     LCALL   _LED_CTRL_Write
                                           ; SOURCE LINE # 1264
0352 E4                CLR     A
0353 FF                MOV     R7,A
0354 120000      E     LCALL   _LED_BLINK_EN_Write
                                           ; SOURCE LINE # 1266
0357 300005            JNB     interrupt_flag,?C0209
                                           ; SOURCE LINE # 1267
035A C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1268
035C 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1269
035F         ?C0209:
                                           ; SOURCE LINE # 1271
035F 750003      E     MOV     emg_1_status,#03H
                                           ; SOURCE LINE # 1272
                                           ; SOURCE LINE # 1273
0362 020000      R     LJMP    ?C0198
                                           ; SOURCE LINE # 1275
0365         ?C0210:
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 124 

                                           ; SOURCE LINE # 1277
0365 900000      R     MOV     DPTR,#emg_counter_1+01H
0368 E0                MOVX    A,@DPTR
0369 04                INC     A
036A F0                MOVX    @DPTR,A
036B 7006              JNZ     ?C0316
036D 900000      R     MOV     DPTR,#emg_counter_1
0370 E0                MOVX    A,@DPTR
0371 04                INC     A
0372 F0                MOVX    @DPTR,A
0373         ?C0316:
                                           ; SOURCE LINE # 1278
0373 900000      E     MOV     DPTR,#g_mem+0A5H
0376 E0                MOVX    A,@DPTR
0377 FF                MOV     R7,A
0378 25E0              ADD     A,ACC
037A 2400        E     ADD     A,#LOW ADC_buf+04H
037C F582              MOV     DPL,A
037E E4                CLR     A
037F 3400        E     ADDC    A,#HIGH ADC_buf+04H
0381 F583              MOV     DPH,A
0383 E0                MOVX    A,@DPTR
0384 FC                MOV     R4,A
0385 A3                INC     DPTR
0386 E0                MOVX    A,@DPTR
0387 C3                CLR     C
0388 EC                MOV     A,R4
0389 6480              XRL     A,#080H
038B 9480              SUBB    A,#080H
038D 5010              JNC     ?C0211
                                           ; SOURCE LINE # 1279
038F EF                MOV     A,R7
0390 25E0              ADD     A,ACC
0392 2400        E     ADD     A,#LOW ADC_buf+04H
0394 F582              MOV     DPL,A
0396 E4                CLR     A
0397 3400        E     ADDC    A,#HIGH ADC_buf+04H
0399 F583              MOV     DPH,A
039B E4                CLR     A
039C F0                MOVX    @DPTR,A
039D A3                INC     DPTR
039E F0                MOVX    @DPTR,A
039F         ?C0211:
                                           ; SOURCE LINE # 1280
039F 900000      E     MOV     DPTR,#g_mem+070H
03A2 E0                MOVX    A,@DPTR
03A3 F8                MOV     R0,A
03A4 A3                INC     DPTR
03A5 E0                MOVX    A,@DPTR
03A6 F9                MOV     R1,A
03A7 A3                INC     DPTR
03A8 E0                MOVX    A,@DPTR
03A9 FA                MOV     R2,A
03AA A3                INC     DPTR
03AB E0                MOVX    A,@DPTR
03AC FB                MOV     R3,A
03AD C000              PUSH    AR0
03AF C001              PUSH    AR1
03B1 C002              PUSH    AR2
03B3 C003              PUSH    AR3
03B5 900000      E     MOV     DPTR,#g_mem+0A5H
03B8 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 125 

03B9 25E0              ADD     A,ACC
03BB 2400        E     ADD     A,#LOW ADC_buf+04H
03BD F582              MOV     DPL,A
03BF E4                CLR     A
03C0 3400        E     ADDC    A,#HIGH ADC_buf+04H
03C2 F583              MOV     DPH,A
03C4 E0                MOVX    A,@DPTR
03C5 FE                MOV     R6,A
03C6 A3                INC     DPTR
03C7 E0                MOVX    A,@DPTR
03C8 FF                MOV     R7,A
03C9 EE                MOV     A,R6
03CA 33                RLC     A
03CB 95E0              SUBB    A,ACC
03CD FD                MOV     R5,A
03CE FC                MOV     R4,A
03CF 120000      E     LCALL   _filter_ch1
03D2 D003              POP     AR3
03D4 D002              POP     AR2
03D6 D001              POP     AR1
03D8 D000              POP     AR0
03DA EB                MOV     A,R3
03DB 2F                ADD     A,R7
03DC FF                MOV     R7,A
03DD EA                MOV     A,R2
03DE 3E                ADDC    A,R6
03DF FE                MOV     R6,A
03E0 E9                MOV     A,R1
03E1 3D                ADDC    A,R5
03E2 FD                MOV     R5,A
03E3 E8                MOV     A,R0
03E4 3C                ADDC    A,R4
03E5 FC                MOV     R4,A
03E6 900000      E     MOV     DPTR,#g_mem+070H
03E9 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1282
03EC 300005            JNB     interrupt_flag,?C0212
                                           ; SOURCE LINE # 1283
03EF C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1284
03F1 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1285
03F4         ?C0212:
                                           ; SOURCE LINE # 1287
03F4 900000      R     MOV     DPTR,#emg_counter_1
03F7 E0                MOVX    A,@DPTR
03F8 6403              XRL     A,#03H
03FA 7004              JNZ     ?C0317
03FC A3                INC     DPTR
03FD E0                MOVX    A,@DPTR
03FE 64E8              XRL     A,#0E8H
0400         ?C0317:
0400 7039              JNZ     ?C0198
                                           ; SOURCE LINE # 1288
0402 900000      E     MOV     DPTR,#g_mem+070H
0405 E0                MOVX    A,@DPTR
0406 FC                MOV     R4,A
0407 A3                INC     DPTR
0408 E0                MOVX    A,@DPTR
0409 FD                MOV     R5,A
040A A3                INC     DPTR
040B E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 126 

040C FE                MOV     R6,A
040D A3                INC     DPTR
040E E0                MOVX    A,@DPTR
040F FF                MOV     R7,A
0410 E4                CLR     A
0411 7BE8              MOV     R3,#0E8H
0413 7A03              MOV     R2,#03H
0415 F9                MOV     R1,A
0416 F8                MOV     R0,A
0417 120000      E     LCALL   ?C?ULDIV
041A 900000      E     MOV     DPTR,#g_mem+070H
041D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1290
0420 300005            JNB     interrupt_flag,?C0214
                                           ; SOURCE LINE # 1291
0423 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1292
0425 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1293
0428         ?C0214:
                                           ; SOURCE LINE # 1295
0428 E4                CLR     A
0429 FF                MOV     R7,A
042A 120000      E     LCALL   _LED_CTRL_Write
                                           ; SOURCE LINE # 1296
042D E4                CLR     A
042E FF                MOV     R7,A
042F 120000      E     LCALL   _LED_BLINK_EN_Write
                                           ; SOURCE LINE # 1298
0432 E4                CLR     A
0433 900000      R     MOV     DPTR,#emg_counter_1
0436 F0                MOVX    @DPTR,A
0437 A3                INC     DPTR
0438 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1300
0439 F500        E     MOV     emg_1_status,A
                                           ; SOURCE LINE # 1301
                                           ; SOURCE LINE # 1302
                                           ; SOURCE LINE # 1304
                                           ; SOURCE LINE # 1305
                                           ; SOURCE LINE # 1306
043B         ?C0198:
                                           ; SOURCE LINE # 1308
043B 300005            JNB     interrupt_flag,?C0216
                                           ; SOURCE LINE # 1309
043E C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1310
0440 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1311
0443         ?C0216:
                                           ; SOURCE LINE # 1313
0443 E500        E     MOV     A,emg_2_status
0445 14                DEC     A
0446 7003              JNZ     $ + 5H
0448 020000      R     LJMP    ?C0224
044B 14                DEC     A
044C 7003              JNZ     $ + 5H
044E 020000      R     LJMP    ?C0226
0451 14                DEC     A
0452 7003              JNZ     $ + 5H
0454 020000      R     LJMP    ?C0229
0457 14                DEC     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 127 

0458 7003              JNZ     $ + 5H
045A 020000      R     LJMP    ?C0234
045D 14                DEC     A
045E 7003              JNZ     $ + 5H
0460 020000      R     LJMP    ?C0236
0463 2405              ADD     A,#05H
0465 6003              JZ      $ + 5H
0467 020000      R     LJMP    ?C0217
                                           ; SOURCE LINE # 1314
046A         ?C0218:
                                           ; SOURCE LINE # 1315
046A 900000      E     MOV     DPTR,#g_mem+0A5H
046D E0                MOVX    A,@DPTR
046E FF                MOV     R7,A
046F C3                CLR     C
0470 7403              MOV     A,#03H
0472 9F                SUBB    A,R7
0473 25E0              ADD     A,ACC
0475 2400        E     ADD     A,#LOW ADC_buf
0477 F582              MOV     DPL,A
0479 E4                CLR     A
047A 3400        E     ADDC    A,#HIGH ADC_buf
047C F583              MOV     DPH,A
047E E0                MOVX    A,@DPTR
047F FE                MOV     R6,A
0480 A3                INC     DPTR
0481 E0                MOVX    A,@DPTR
0482 FF                MOV     R7,A
0483 EE                MOV     A,R6
0484 33                RLC     A
0485 95E0              SUBB    A,ACC
0487 8F00        R     MOV     i_aux+03H,R7
0489 8E00        R     MOV     i_aux+02H,R6
048B F500        R     MOV     i_aux+01H,A
048D F500        R     MOV     i_aux,A
                                           ; SOURCE LINE # 1316
048F E4                CLR     A
0490 FF                MOV     R7,A
0491 FE                MOV     R6,A
0492 FD                MOV     R5,A
0493 FC                MOV     R4,A
0494 AB00        R     MOV     R3,i_aux+03H
0496 AA00        R     MOV     R2,i_aux+02H
0498 A900        R     MOV     R1,i_aux+01H
049A A800        R     MOV     R0,i_aux
049C C3                CLR     C
049D 120000      E     LCALL   ?C?SLCMP
04A0 5009              JNC     ?C0219
                                           ; SOURCE LINE # 1317
04A2 E4                CLR     A
04A3 F500        R     MOV     i_aux+03H,A
04A5 F500        R     MOV     i_aux+02H,A
04A7 F500        R     MOV     i_aux+01H,A
04A9 F500        R     MOV     i_aux,A
04AB         ?C0219:
                                           ; SOURCE LINE # 1318
04AB AF00        R     MOV     R7,i_aux+03H
04AD AE00        R     MOV     R6,i_aux+02H
04AF AD00        R     MOV     R5,i_aux+01H
04B1 AC00        R     MOV     R4,i_aux
04B3 120000      E     LCALL   _filter_ch2
04B6 8F00        R     MOV     i_aux+03H,R7
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 128 

04B8 8E00        R     MOV     i_aux+02H,R6
04BA 8D00        R     MOV     i_aux+01H,R5
04BC 8C00        R     MOV     i_aux,R4
                                           ; SOURCE LINE # 1319
04BE 780A              MOV     R0,#0AH
04C0 120000      E     LCALL   ?C?LSHL
04C3 900000      E     MOV     DPTR,#g_mem+074H
04C6 E0                MOVX    A,@DPTR
04C7 F8                MOV     R0,A
04C8 A3                INC     DPTR
04C9 E0                MOVX    A,@DPTR
04CA F9                MOV     R1,A
04CB A3                INC     DPTR
04CC E0                MOVX    A,@DPTR
04CD FA                MOV     R2,A
04CE A3                INC     DPTR
04CF E0                MOVX    A,@DPTR
04D0 FB                MOV     R3,A
04D1 120000      E     LCALL   ?C?ULDIV
04D4 8F00        R     MOV     i_aux+03H,R7
04D6 8E00        R     MOV     i_aux+02H,R6
04D8 8D00        R     MOV     i_aux+01H,R5
04DA 8C00        R     MOV     i_aux,R4
                                           ; SOURCE LINE # 1321
04DC 300005            JNB     interrupt_flag,?C0220
                                           ; SOURCE LINE # 1322
04DF C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1323
04E1 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1324
04E4         ?C0220:
                                           ; SOURCE LINE # 1326
04E4 E4                CLR     A
04E5 FF                MOV     R7,A
04E6 FE                MOV     R6,A
04E7 FD                MOV     R5,A
04E8 FC                MOV     R4,A
04E9 AB00        R     MOV     R3,i_aux+03H
04EB AA00        R     MOV     R2,i_aux+02H
04ED A900        R     MOV     R1,i_aux+01H
04EF A800        R     MOV     R0,i_aux
04F1 C3                CLR     C
04F2 120000      E     LCALL   ?C?SLCMP
04F5 500B              JNC     ?C0221
                                           ; SOURCE LINE # 1327
04F7 E4                CLR     A
04F8 F500        R     MOV     i_aux+03H,A
04FA F500        R     MOV     i_aux+02H,A
04FC F500        R     MOV     i_aux+01H,A
04FE F500        R     MOV     i_aux,A
0500 801E              SJMP    ?C0222
0502         ?C0221:
                                           ; SOURCE LINE # 1329
0502 E4                CLR     A
0503 FF                MOV     R7,A
0504 7E04              MOV     R6,#04H
0506 FD                MOV     R5,A
0507 FC                MOV     R4,A
0508 AB00        R     MOV     R3,i_aux+03H
050A AA00        R     MOV     R2,i_aux+02H
050C A900        R     MOV     R1,i_aux+01H
050E A800        R     MOV     R0,i_aux
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 129 

0510 D3                SETB    C
0511 120000      E     LCALL   ?C?SLCMP
0514 400A              JC      ?C0222
                                           ; SOURCE LINE # 1330
0516 E4                CLR     A
0517 F500        R     MOV     i_aux+03H,A
0519 750004      R     MOV     i_aux+02H,#04H
051C F500        R     MOV     i_aux+01H,A
051E F500        R     MOV     i_aux,A
0520         ?C0222:
                                           ; SOURCE LINE # 1332
0520 AF00        R     MOV     R7,i_aux+03H
0522 AE00        R     MOV     R6,i_aux+02H
0524 AD00        R     MOV     R5,i_aux+01H
0526 AC00        R     MOV     R4,i_aux
0528 900000      E     MOV     DPTR,#g_meas+01BH
052B 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1334
052E 020000      R     LJMP    ?C0217
                                           ; SOURCE LINE # 1336
0531         ?C0224:
                                           ; SOURCE LINE # 1337
0531 E4                CLR     A
0532 900000      R     MOV     DPTR,#emg_counter_2
0535 F0                MOVX    @DPTR,A
0536 A3                INC     DPTR
0537 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1338
0538 FF                MOV     R7,A
0539 FE                MOV     R6,A
053A FD                MOV     R5,A
053B FC                MOV     R4,A
053C 900000      E     MOV     DPTR,#g_mem+074H
053F 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1340
0542 300005            JNB     interrupt_flag,?C0225
                                           ; SOURCE LINE # 1341
0545 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1342
0547 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1343
054A         ?C0225:
                                           ; SOURCE LINE # 1345
054A 750004      E     MOV     emg_2_status,#04H
                                           ; SOURCE LINE # 1346
054D 020000      R     LJMP    ?C0217
                                           ; SOURCE LINE # 1348
0550         ?C0226:
                                           ; SOURCE LINE # 1349
0550 900000      R     MOV     DPTR,#emg_counter_2+01H
0553 E0                MOVX    A,@DPTR
0554 04                INC     A
0555 F0                MOVX    @DPTR,A
0556 7006              JNZ     ?C0318
0558 900000      R     MOV     DPTR,#emg_counter_2
055B E0                MOVX    A,@DPTR
055C 04                INC     A
055D F0                MOVX    @DPTR,A
055E         ?C0318:
                                           ; SOURCE LINE # 1350
055E 900000      R     MOV     DPTR,#emg_counter_2
0561 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 130 

0562 6401              XRL     A,#01H
0564 7004              JNZ     ?C0319
0566 A3                INC     DPTR
0567 E0                MOVX    A,@DPTR
0568 64F4              XRL     A,#0F4H
056A         ?C0319:
056A 6003              JZ      $ + 5H
056C 020000      R     LJMP    ?C0217
                                           ; SOURCE LINE # 1351
056F 900000      R     MOV     DPTR,#emg_counter_2
0572 F0                MOVX    @DPTR,A
0573 A3                INC     DPTR
0574 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1353
0575 7F01              MOV     R7,#01H
0577 120000      E     LCALL   _LED_CTRL_Write
                                           ; SOURCE LINE # 1354
057A E4                CLR     A
057B FF                MOV     R7,A
057C 120000      E     LCALL   _LED_BLINK_EN_Write
                                           ; SOURCE LINE # 1356
057F 300005            JNB     interrupt_flag,?C0228
                                           ; SOURCE LINE # 1357
0582 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1358
0584 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1359
0587         ?C0228:
                                           ; SOURCE LINE # 1361
0587 750003      E     MOV     emg_2_status,#03H
                                           ; SOURCE LINE # 1362
                                           ; SOURCE LINE # 1363
058A 020000      R     LJMP    ?C0217
                                           ; SOURCE LINE # 1365
058D         ?C0229:
                                           ; SOURCE LINE # 1367
058D 900000      R     MOV     DPTR,#emg_counter_2+01H
0590 E0                MOVX    A,@DPTR
0591 04                INC     A
0592 F0                MOVX    @DPTR,A
0593 7006              JNZ     ?C0320
0595 900000      R     MOV     DPTR,#emg_counter_2
0598 E0                MOVX    A,@DPTR
0599 04                INC     A
059A F0                MOVX    @DPTR,A
059B         ?C0320:
                                           ; SOURCE LINE # 1368
059B 900000      E     MOV     DPTR,#g_mem+0A5H
059E E0                MOVX    A,@DPTR
059F FF                MOV     R7,A
05A0 C3                CLR     C
05A1 7403              MOV     A,#03H
05A3 9F                SUBB    A,R7
05A4 FF                MOV     R7,A
05A5 25E0              ADD     A,ACC
05A7 2400        E     ADD     A,#LOW ADC_buf
05A9 F582              MOV     DPL,A
05AB E4                CLR     A
05AC 3400        E     ADDC    A,#HIGH ADC_buf
05AE F583              MOV     DPH,A
05B0 E0                MOVX    A,@DPTR
05B1 FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 131 

05B2 A3                INC     DPTR
05B3 E0                MOVX    A,@DPTR
05B4 C3                CLR     C
05B5 EC                MOV     A,R4
05B6 6480              XRL     A,#080H
05B8 9480              SUBB    A,#080H
05BA 5010              JNC     ?C0230
                                           ; SOURCE LINE # 1369
05BC EF                MOV     A,R7
05BD 25E0              ADD     A,ACC
05BF 2400        E     ADD     A,#LOW ADC_buf
05C1 F582              MOV     DPL,A
05C3 E4                CLR     A
05C4 3400        E     ADDC    A,#HIGH ADC_buf
05C6 F583              MOV     DPH,A
05C8 E4                CLR     A
05C9 F0                MOVX    @DPTR,A
05CA A3                INC     DPTR
05CB F0                MOVX    @DPTR,A
05CC         ?C0230:
                                           ; SOURCE LINE # 1370
05CC 900000      E     MOV     DPTR,#g_mem+074H
05CF E0                MOVX    A,@DPTR
05D0 F8                MOV     R0,A
05D1 A3                INC     DPTR
05D2 E0                MOVX    A,@DPTR
05D3 F9                MOV     R1,A
05D4 A3                INC     DPTR
05D5 E0                MOVX    A,@DPTR
05D6 FA                MOV     R2,A
05D7 A3                INC     DPTR
05D8 E0                MOVX    A,@DPTR
05D9 FB                MOV     R3,A
05DA C000              PUSH    AR0
05DC C001              PUSH    AR1
05DE C002              PUSH    AR2
05E0 C003              PUSH    AR3
05E2 900000      E     MOV     DPTR,#g_mem+0A5H
05E5 E0                MOVX    A,@DPTR
05E6 FF                MOV     R7,A
05E7 C3                CLR     C
05E8 7403              MOV     A,#03H
05EA 9F                SUBB    A,R7
05EB 25E0              ADD     A,ACC
05ED 2400        E     ADD     A,#LOW ADC_buf
05EF F582              MOV     DPL,A
05F1 E4                CLR     A
05F2 3400        E     ADDC    A,#HIGH ADC_buf
05F4 F583              MOV     DPH,A
05F6 E0                MOVX    A,@DPTR
05F7 FE                MOV     R6,A
05F8 A3                INC     DPTR
05F9 E0                MOVX    A,@DPTR
05FA FF                MOV     R7,A
05FB EE                MOV     A,R6
05FC 33                RLC     A
05FD 95E0              SUBB    A,ACC
05FF FD                MOV     R5,A
0600 FC                MOV     R4,A
0601 120000      E     LCALL   _filter_ch2
0604 D003              POP     AR3
0606 D002              POP     AR2
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 132 

0608 D001              POP     AR1
060A D000              POP     AR0
060C EB                MOV     A,R3
060D 2F                ADD     A,R7
060E FF                MOV     R7,A
060F EA                MOV     A,R2
0610 3E                ADDC    A,R6
0611 FE                MOV     R6,A
0612 E9                MOV     A,R1
0613 3D                ADDC    A,R5
0614 FD                MOV     R5,A
0615 E8                MOV     A,R0
0616 3C                ADDC    A,R4
0617 FC                MOV     R4,A
0618 900000      E     MOV     DPTR,#g_mem+074H
061B 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1372
061E 300005            JNB     interrupt_flag,?C0231
                                           ; SOURCE LINE # 1373
0621 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1374
0623 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1375
0626         ?C0231:
                                           ; SOURCE LINE # 1377
0626 900000      R     MOV     DPTR,#emg_counter_2
0629 E0                MOVX    A,@DPTR
062A 6403              XRL     A,#03H
062C 7004              JNZ     ?C0321
062E A3                INC     DPTR
062F E0                MOVX    A,@DPTR
0630 64E8              XRL     A,#0E8H
0632         ?C0321:
0632 6003              JZ      $ + 5H
0634 020000      R     LJMP    ?C0217
                                           ; SOURCE LINE # 1378
0637 900000      E     MOV     DPTR,#g_mem+074H
063A E0                MOVX    A,@DPTR
063B FC                MOV     R4,A
063C A3                INC     DPTR
063D E0                MOVX    A,@DPTR
063E FD                MOV     R5,A
063F A3                INC     DPTR
0640 E0                MOVX    A,@DPTR
0641 FE                MOV     R6,A
0642 A3                INC     DPTR
0643 E0                MOVX    A,@DPTR
0644 FF                MOV     R7,A
0645 E4                CLR     A
0646 7BE8              MOV     R3,#0E8H
0648 7A03              MOV     R2,#03H
064A F9                MOV     R1,A
064B F8                MOV     R0,A
064C 120000      E     LCALL   ?C?ULDIV
064F 900000      E     MOV     DPTR,#g_mem+074H
0652 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1380
0655 E4                CLR     A
0656 FF                MOV     R7,A
0657 120000      E     LCALL   _LED_CTRL_Write
                                           ; SOURCE LINE # 1381
065A E4                CLR     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 133 

065B FF                MOV     R7,A
065C 120000      E     LCALL   _LED_BLINK_EN_Write
                                           ; SOURCE LINE # 1383
065F E4                CLR     A
0660 900000      R     MOV     DPTR,#emg_counter_2
0663 F0                MOVX    @DPTR,A
0664 A3                INC     DPTR
0665 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1385
0666 300005            JNB     interrupt_flag,?C0233
                                           ; SOURCE LINE # 1386
0669 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1387
066B 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1388
066E         ?C0233:
                                           ; SOURCE LINE # 1390
066E 750005      E     MOV     emg_2_status,#05H
                                           ; SOURCE LINE # 1391
                                           ; SOURCE LINE # 1392
0671 020000      R     LJMP    ?C0217
                                           ; SOURCE LINE # 1394
0674         ?C0234:
                                           ; SOURCE LINE # 1395
0674 E500        E     MOV     A,emg_1_status
0676 6003              JZ      $ + 5H
0678 020000      R     LJMP    ?C0217
                                           ; SOURCE LINE # 1396
067B 750002      E     MOV     emg_2_status,#02H
                                           ; SOURCE LINE # 1397
067E 807E              SJMP    ?C0217
                                           ; SOURCE LINE # 1399
0680         ?C0236:
                                           ; SOURCE LINE # 1400
0680 900000      R     MOV     DPTR,#emg_counter_2+01H
0683 E0                MOVX    A,@DPTR
0684 04                INC     A
0685 F0                MOVX    @DPTR,A
0686 7006              JNZ     ?C0322
0688 900000      R     MOV     DPTR,#emg_counter_2
068B E0                MOVX    A,@DPTR
068C 04                INC     A
068D F0                MOVX    @DPTR,A
068E         ?C0322:
                                           ; SOURCE LINE # 1401
068E 900000      R     MOV     DPTR,#emg_counter_2
0691 E0                MOVX    A,@DPTR
0692 6401              XRL     A,#01H
0694 7004              JNZ     ?C0323
0696 A3                INC     DPTR
0697 E0                MOVX    A,@DPTR
0698 64F4              XRL     A,#0F4H
069A         ?C0323:
069A 7062              JNZ     ?C0217
                                           ; SOURCE LINE # 1402
069C 900000      R     MOV     DPTR,#emg_counter_2
069F F0                MOVX    @DPTR,A
06A0 A3                INC     DPTR
06A1 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1404
06A2 300005            JNB     interrupt_flag,?C0238
                                           ; SOURCE LINE # 1405
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 134 

06A5 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1406
06A7 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1407
06AA         ?C0238:
                                           ; SOURCE LINE # 1410
06AA 900000      E     MOV     DPTR,#c_mem+033H
06AD E0                MOVX    A,@DPTR
06AE FF                MOV     R7,A
06AF 6402              XRL     A,#02H
06B1 600E              JZ      ?C0240
06B3 EF                MOV     A,R7
06B4 6403              XRL     A,#03H
06B6 6009              JZ      ?C0240
06B8 EF                MOV     A,R7
06B9 6404              XRL     A,#04H
06BB 6004              JZ      ?C0240
06BD EF                MOV     A,R7
06BE B4053A            CJNE    A,#05H,?C0239
06C1         ?C0240:
                                           ; SOURCE LINE # 1413
                                           ; SOURCE LINE # 1414
06C1 900000      E     MOV     DPTR,#c_mem+034H
06C4 E0                MOVX    A,@DPTR
06C5 7028              JNZ     ?C0241
                                           ; SOURCE LINE # 1415
06C7 900000      E     MOV     DPTR,#g_meas
06CA E0                MOVX    A,@DPTR
06CB FC                MOV     R4,A
06CC A3                INC     DPTR
06CD E0                MOVX    A,@DPTR
06CE FD                MOV     R5,A
06CF A3                INC     DPTR
06D0 E0                MOVX    A,@DPTR
06D1 FE                MOV     R6,A
06D2 A3                INC     DPTR
06D3 E0                MOVX    A,@DPTR
06D4 FF                MOV     R7,A
06D5 900000      E     MOV     DPTR,#g_ref
06D8 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1416
06DB 900000      E     MOV     DPTR,#g_meas+04H
06DE E0                MOVX    A,@DPTR
06DF FC                MOV     R4,A
06E0 A3                INC     DPTR
06E1 E0                MOVX    A,@DPTR
06E2 FD                MOV     R5,A
06E3 A3                INC     DPTR
06E4 E0                MOVX    A,@DPTR
06E5 FE                MOV     R6,A
06E6 A3                INC     DPTR
06E7 E0                MOVX    A,@DPTR
06E8 FF                MOV     R7,A
06E9 900000      E     MOV     DPTR,#g_ref+04H
06EC 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1417
06EF         ?C0241:
                                           ; SOURCE LINE # 1418
06EF 900000      E     MOV     DPTR,#c_mem+032H
06F2 E0                MOVX    A,@DPTR
06F3 FF                MOV     R7,A
06F4 900000      E     MOV     DPTR,#g_ref+018H
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 135 

06F7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1419
06F8 120000      E     LCALL   _MOTOR_ON_OFF_Write
                                           ; SOURCE LINE # 1420
06FB         ?C0239:
                                           ; SOURCE LINE # 1422
06FB E4                CLR     A
06FC F500        E     MOV     emg_2_status,A
                                           ; SOURCE LINE # 1423
                                           ; SOURCE LINE # 1424
                                           ; SOURCE LINE # 1426
                                           ; SOURCE LINE # 1427
                                           ; SOURCE LINE # 1428
06FE         ?C0217:
                                           ; SOURCE LINE # 1430
06FE 300068            JNB     interrupt_flag,?C0244
                                           ; SOURCE LINE # 1431
0701 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1432
0703 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1433
                                           ; SOURCE LINE # 1434
0706 8061              SJMP    ?C0244
0708         ?C0192:
                                           ; SOURCE LINE # 1435
                                           ; SOURCE LINE # 1437
0708 750001      E     MOV     emg_1_status,#01H
                                           ; SOURCE LINE # 1438
070B 750001      E     MOV     emg_2_status,#01H
                                           ; SOURCE LINE # 1440
070E C200        E     CLR     tension_valid
                                           ; SOURCE LINE # 1442
0710 7F01              MOV     R7,#01H
0712 120000      E     LCALL   _LED_CTRL_Write
                                           ; SOURCE LINE # 1444
0715 E4                CLR     A
0716 FF                MOV     R7,A
0717 120000      E     LCALL   _LED_BLINK_EN_Write
                                           ; SOURCE LINE # 1446
071A 300005            JNB     interrupt_flag,?C0245
                                           ; SOURCE LINE # 1447
071D C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1448
071F 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1449
0722         ?C0245:
                                           ; SOURCE LINE # 1451
0722 900000      E     MOV     DPTR,#c_mem+06FH
0725 E0                MOVX    A,@DPTR
0726 6020              JZ      ?C0246
                                           ; SOURCE LINE # 1452
0728 900000      E     MOV     DPTR,#c_mem+033H
072B E0                MOVX    A,@DPTR
072C FF                MOV     R7,A
072D 6402              XRL     A,#02H
072F 600E              JZ      ?C0248
0731 EF                MOV     A,R7
0732 6403              XRL     A,#03H
0734 6009              JZ      ?C0248
0736 EF                MOV     A,R7
0737 6404              XRL     A,#04H
0739 6004              JZ      ?C0248
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 136 

073B EF                MOV     A,R7
073C B40509            CJNE    A,#05H,?C0246
073F         ?C0248:
                                           ; SOURCE LINE # 1455
                                           ; SOURCE LINE # 1456
073F E4                CLR     A
0740 900000      E     MOV     DPTR,#g_ref+018H
0743 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1457
0744 FF                MOV     R7,A
0745 120000      E     LCALL   _MOTOR_ON_OFF_Write
                                           ; SOURCE LINE # 1458
                                           ; SOURCE LINE # 1459
0748         ?C0246:
                                           ; SOURCE LINE # 1462
0748 E4                CLR     A
0749 FF                MOV     R7,A
074A FE                MOV     R6,A
074B FD                MOV     R5,A
074C FC                MOV     R4,A
074D 900000      E     MOV     DPTR,#g_meas+0CH
0750 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1465
0753 E4                CLR     A
0754 FF                MOV     R7,A
0755 FE                MOV     R6,A
0756 FD                MOV     R5,A
0757 FC                MOV     R4,A
0758 900000      E     MOV     DPTR,#g_meas+017H
075B 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1466
075E E4                CLR     A
075F FF                MOV     R7,A
0760 FE                MOV     R6,A
0761 FD                MOV     R5,A
0762 FC                MOV     R4,A
0763 900000      E     MOV     DPTR,#g_meas+01BH
0766 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1468
0769         ?C0244:
                                           ; SOURCE LINE # 1470
0769 900000      R     MOV     DPTR,#first_tension_valid
076C E0                MOVX    A,@DPTR
076D 6003              JZ      $ + 5H
076F 020000      R     LJMP    ?C0249
0772 200003      E     JB      tension_valid,$ + 6H
0775 020000      R     LJMP    ?C0249
0778 E500        E     MOV     A,emg_1_status
077A 707F              JNZ     ?C0249
077C E500        E     MOV     A,emg_2_status
077E 707B              JNZ     ?C0249
                                           ; SOURCE LINE # 1471
0780 900000      E     MOV     DPTR,#dev_tension
0783 E0                MOVX    A,@DPTR
0784 FC                MOV     R4,A
0785 A3                INC     DPTR
0786 E0                MOVX    A,@DPTR
0787 FD                MOV     R5,A
0788 A3                INC     DPTR
0789 E0                MOVX    A,@DPTR
078A FE                MOV     R6,A
078B A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 137 

078C E0                MOVX    A,@DPTR
078D FF                MOV     R7,A
078E 120000      E     LCALL   _filter_voltage
0791 900000      E     MOV     DPTR,#dev_tension_f
0794 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1472
0797 900000      R     MOV     DPTR,#pow_tension
079A E0                MOVX    A,@DPTR
079B FC                MOV     R4,A
079C A3                INC     DPTR
079D E0                MOVX    A,@DPTR
079E FD                MOV     R5,A
079F A3                INC     DPTR
07A0 E0                MOVX    A,@DPTR
07A1 FE                MOV     R6,A
07A2 A3                INC     DPTR
07A3 E0                MOVX    A,@DPTR
07A4 FF                MOV     R7,A
07A5 EC                MOV     A,R4
07A6 120000      E     LCALL   ?C?FCASTL
07A9 7B1F              MOV     R3,#01FH
07AB 7A85              MOV     R2,#085H
07AD 796B              MOV     R1,#06BH
07AF 783F              MOV     R0,#03FH
07B1 120000      E     LCALL   ?C?FPMUL
07B4 C004              PUSH    AR4
07B6 C005              PUSH    AR5
07B8 C006              PUSH    AR6
07BA C007              PUSH    AR7
07BC 900000      E     MOV     DPTR,#dev_tension_f
07BF E0                MOVX    A,@DPTR
07C0 FC                MOV     R4,A
07C1 A3                INC     DPTR
07C2 E0                MOVX    A,@DPTR
07C3 FD                MOV     R5,A
07C4 A3                INC     DPTR
07C5 E0                MOVX    A,@DPTR
07C6 FE                MOV     R6,A
07C7 A3                INC     DPTR
07C8 E0                MOVX    A,@DPTR
07C9 FF                MOV     R7,A
07CA EC                MOV     A,R4
07CB 120000      E     LCALL   ?C?FCASTL
07CE A804              MOV     R0,AR4
07D0 A905              MOV     R1,AR5
07D2 AA06              MOV     R2,AR6
07D4 AB07              MOV     R3,AR7
07D6 D007              POP     AR7
07D8 D006              POP     AR6
07DA D005              POP     AR5
07DC D004              POP     AR4
07DE 120000      E     LCALL   ?C?FPCMP3
07E1 600E              JZ      ?C0250
07E3 400C              JC      ?C0250
                                           ; SOURCE LINE # 1474
07E5 7F01              MOV     R7,#01H
07E7 120000      E     LCALL   _LED_CTRL_Write
                                           ; SOURCE LINE # 1477
07EA E4                CLR     A
07EB FF                MOV     R7,A
07EC 120000      E     LCALL   _LED_BLINK_EN_Write
                                           ; SOURCE LINE # 1478
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 138 

07EF 800A              SJMP    ?C0249
07F1         ?C0250:
                                           ; SOURCE LINE # 1479
                                           ; SOURCE LINE # 1481
07F1 E4                CLR     A
07F2 FF                MOV     R7,A
07F3 120000      E     LCALL   _LED_CTRL_Write
                                           ; SOURCE LINE # 1484
07F6 7F01              MOV     R7,#01H
07F8 120000      E     LCALL   _LED_BLINK_EN_Write
                                           ; SOURCE LINE # 1489
                                           ; SOURCE LINE # 1490
07FB         ?C0249:
                                           ; SOURCE LINE # 1492
07FB 300005            JNB     interrupt_flag,?C0253
                                           ; SOURCE LINE # 1493
07FE C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 1494
0800 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 1495
                                           ; SOURCE LINE # 1496
0803         ?C0253:
0803 22                RET     
             ; FUNCTION analog_read_end (END)

             ; FUNCTION overcurrent_control (BEGIN)
                                           ; SOURCE LINE # 1502
                                           ; SOURCE LINE # 1503
0000 900000      E     MOV     DPTR,#c_mem+069H
0003 E0                MOVX    A,@DPTR
0004 FE                MOV     R6,A
0005 A3                INC     DPTR
0006 E0                MOVX    A,@DPTR
0007 FF                MOV     R7,A
0008 4E                ORL     A,R6
0009 606B              JZ      ?C0261
                                           ; SOURCE LINE # 1505
000B EE                MOV     A,R6
000C 33                RLC     A
000D 95E0              SUBB    A,ACC
000F FD                MOV     R5,A
0010 FC                MOV     R4,A
0011 900000      E     MOV     DPTR,#g_meas+0CH
0014 E0                MOVX    A,@DPTR
0015 F8                MOV     R0,A
0016 A3                INC     DPTR
0017 E0                MOVX    A,@DPTR
0018 F9                MOV     R1,A
0019 A3                INC     DPTR
001A E0                MOVX    A,@DPTR
001B FA                MOV     R2,A
001C A3                INC     DPTR
001D E0                MOVX    A,@DPTR
001E FB                MOV     R3,A
001F D3                SETB    C
0020 120000      E     LCALL   ?C?SLCMP
0023 4008              JC      ?C0255
                                           ; SOURCE LINE # 1507
0025 900000      E     MOV     DPTR,#dev_pwm_limit
0028 E0                MOVX    A,@DPTR
0029 14                DEC     A
002A F0                MOVX    @DPTR,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 139 

                                           ; SOURCE LINE # 1509
002B 802D              SJMP    ?C0256
002D         ?C0255:
002D 900000      E     MOV     DPTR,#c_mem+06AH
0030 E0                MOVX    A,@DPTR
0031 24F6              ADD     A,#0F6H
0033 FF                MOV     R7,A
0034 900000      E     MOV     DPTR,#c_mem+069H
0037 E0                MOVX    A,@DPTR
0038 34FF              ADDC    A,#0FFH
003A FE                MOV     R6,A
003B 33                RLC     A
003C 95E0              SUBB    A,ACC
003E FD                MOV     R5,A
003F FC                MOV     R4,A
0040 900000      E     MOV     DPTR,#g_meas+0CH
0043 E0                MOVX    A,@DPTR
0044 F8                MOV     R0,A
0045 A3                INC     DPTR
0046 E0                MOVX    A,@DPTR
0047 F9                MOV     R1,A
0048 A3                INC     DPTR
0049 E0                MOVX    A,@DPTR
004A FA                MOV     R2,A
004B A3                INC     DPTR
004C E0                MOVX    A,@DPTR
004D FB                MOV     R3,A
004E C3                CLR     C
004F 120000      E     LCALL   ?C?SLCMP
0052 5006              JNC     ?C0256
                                           ; SOURCE LINE # 1511
0054 900000      E     MOV     DPTR,#dev_pwm_limit
0057 E0                MOVX    A,@DPTR
0058 04                INC     A
0059 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1512
005A         ?C0256:
                                           ; SOURCE LINE # 1515
005A 900000      E     MOV     DPTR,#dev_pwm_limit
005D E0                MOVX    A,@DPTR
005E FF                MOV     R7,A
005F C3                CLR     C
0060 9400              SUBB    A,#00H
0062 5003              JNC     ?C0258
                                           ; SOURCE LINE # 1516
0064 E4                CLR     A
0065 F0                MOVX    @DPTR,A
0066 22                RET     
0067         ?C0258:
                                           ; SOURCE LINE # 1518
0067 900000      E     MOV     DPTR,#dev_pwm_sat
006A E0                MOVX    A,@DPTR
006B FE                MOV     R6,A
006C EF                MOV     A,R7
006D D3                SETB    C
006E 9E                SUBB    A,R6
006F 4005              JC      ?C0261
                                           ; SOURCE LINE # 1519
0071 900000      E     MOV     DPTR,#dev_pwm_limit
0074 EE                MOV     A,R6
0075 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1520
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 140 

                                           ; SOURCE LINE # 1521
0076         ?C0261:
0076 22                RET     
             ; FUNCTION overcurrent_control (END)

             ; FUNCTION pwm_limit_search (BEGIN)
                                           ; SOURCE LINE # 1527
                                           ; SOURCE LINE # 1530
0000 750063      R     MOV     max_tension,#063H
0003 75009C      R     MOV     max_tension+01H,#09CH
                                           ; SOURCE LINE # 1531
0006 75002C      R     MOV     min_tension,#02CH
0009 7500EC      R     MOV     min_tension+01H,#0ECH
                                           ; SOURCE LINE # 1533
000C AE00        R     MOV     R6,max_tension
000E AF00        R     MOV     R7,max_tension+01H
0010 E4                CLR     A
0011 FC                MOV     R4,A
0012 FD                MOV     R5,A
0013 900000      E     MOV     DPTR,#dev_tension
0016 E0                MOVX    A,@DPTR
0017 F8                MOV     R0,A
0018 A3                INC     DPTR
0019 E0                MOVX    A,@DPTR
001A F9                MOV     R1,A
001B A3                INC     DPTR
001C E0                MOVX    A,@DPTR
001D FA                MOV     R2,A
001E A3                INC     DPTR
001F E0                MOVX    A,@DPTR
0020 FB                MOV     R3,A
0021 D3                SETB    C
0022 120000      E     LCALL   ?C?SLCMP
0025 4006              JC      ?C0262
                                           ; SOURCE LINE # 1534
0027 E4                CLR     A
0028 900000      E     MOV     DPTR,#dev_pwm_sat
002B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1535
002C 22                RET     
002D         ?C0262:
002D AE00        R     MOV     R6,min_tension
002F AF00        R     MOV     R7,min_tension+01H
0031 E4                CLR     A
0032 FC                MOV     R4,A
0033 FD                MOV     R5,A
0034 900000      E     MOV     DPTR,#dev_tension
0037 E0                MOVX    A,@DPTR
0038 F8                MOV     R0,A
0039 A3                INC     DPTR
003A E0                MOVX    A,@DPTR
003B F9                MOV     R1,A
003C A3                INC     DPTR
003D E0                MOVX    A,@DPTR
003E FA                MOV     R2,A
003F A3                INC     DPTR
0040 E0                MOVX    A,@DPTR
0041 FB                MOV     R3,A
0042 C3                CLR     C
0043 120000      E     LCALL   ?C?SLCMP
0046 5007              JNC     ?C0264
                                           ; SOURCE LINE # 1536
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 141 

0048 900000      E     MOV     DPTR,#dev_pwm_sat
004B 7464              MOV     A,#064H
004D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1537
004E 22                RET     
004F         ?C0264:
                                           ; SOURCE LINE # 1538
004F AE00        R     MOV     R6,min_tension
0051 AF00        R     MOV     R7,min_tension+01H
0053 AB07              MOV     R3,AR7
0055 AA06              MOV     R2,AR6
0057 E4                CLR     A
0058 900000      E     MOV     DPTR,#dev_tension
005B E0                MOVX    A,@DPTR
005C FC                MOV     R4,A
005D A3                INC     DPTR
005E E0                MOVX    A,@DPTR
005F FD                MOV     R5,A
0060 A3                INC     DPTR
0061 E0                MOVX    A,@DPTR
0062 FE                MOV     R6,A
0063 A3                INC     DPTR
0064 E0                MOVX    A,@DPTR
0065 C3                CLR     C
0066 9B                SUBB    A,R3
0067 FF                MOV     R7,A
0068 EE                MOV     A,R6
0069 9A                SUBB    A,R2
006A FE                MOV     R6,A
006B ED                MOV     A,R5
006C 9400              SUBB    A,#00H
006E FD                MOV     R5,A
006F EC                MOV     A,R4
0070 9400              SUBB    A,#00H
0072 FC                MOV     R4,A
0073 7809              MOV     R0,#09H
0075 120000      E     LCALL   ?C?SLSHR
0078 8F00        R     MOV     index,R7
                                           ; SOURCE LINE # 1539
007A 7400        R     MOV     A,#LOW pwm_preload_values
007C 2F                ADD     A,R7
007D F582              MOV     DPL,A
007F E4                CLR     A
0080 3400        R     ADDC    A,#HIGH pwm_preload_values
0082 F583              MOV     DPH,A
0084 E0                MOVX    A,@DPTR
0085 900000      E     MOV     DPTR,#dev_pwm_sat
0088 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1540
                                           ; SOURCE LINE # 1541
0089         ?C0266:
0089 22                RET     
             ; FUNCTION pwm_limit_search (END)

             ; FUNCTION cycles_counter_update (BEGIN)
                                           ; SOURCE LINE # 1548
                                           ; SOURCE LINE # 1559
0000 900000      E     MOV     DPTR,#g_meas
0003 E0                MOVX    A,@DPTR
0004 FC                MOV     R4,A
0005 A3                INC     DPTR
0006 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 142 

0007 FD                MOV     R5,A
0008 A3                INC     DPTR
0009 E0                MOVX    A,@DPTR
000A FE                MOV     R6,A
000B A3                INC     DPTR
000C E0                MOVX    A,@DPTR
000D FF                MOV     R7,A
000E 900000      E     MOV     DPTR,#g_mem+035H
0011 E0                MOVX    A,@DPTR
0012 F9                MOV     R1,A
0013 F8                MOV     R0,A
0014 120000      E     LCALL   ?C?SLSHR
0017 900000      R     MOV     DPTR,#curr_pos
001A 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1562
001D 900000      R     MOV     DPTR,#pos_cycle_status
0020 E0                MOVX    A,@DPTR
0021 14                DEC     A
0022 7003              JNZ     $ + 5H
0024 020000      R     LJMP    ?C0270
0027 14                DEC     A
0028 7003              JNZ     $ + 5H
002A 020000      R     LJMP    ?C0272
002D 2402              ADD     A,#02H
002F 6003              JZ      $ + 5H
0031 020000      R     LJMP    ?C0267
                                           ; SOURCE LINE # 1563
0034         ?C0268:
                                           ; SOURCE LINE # 1564
0034 900000      E     MOV     DPTR,#pwm_sign
0037 E0                MOVX    A,@DPTR
0038 6401              XRL     A,#01H
003A 6003              JZ      $ + 5H
003C 020000      R     LJMP    ?C0267
                                           ; SOURCE LINE # 1565
003F 900000      R     MOV     DPTR,#curr_pos
0042 E0                MOVX    A,@DPTR
0043 FC                MOV     R4,A
0044 A3                INC     DPTR
0045 E0                MOVX    A,@DPTR
0046 FD                MOV     R5,A
0047 A3                INC     DPTR
0048 E0                MOVX    A,@DPTR
0049 FE                MOV     R6,A
004A A3                INC     DPTR
004B E0                MOVX    A,@DPTR
004C FF                MOV     R7,A
004D 900000      R     MOV     DPTR,#thr_pos
0050 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1566
0053 900000      E     MOV     DPTR,#g_mem+0F4H
0056 E0                MOVX    A,@DPTR
0057 F8                MOV     R0,A
0058 A3                INC     DPTR
0059 E0                MOVX    A,@DPTR
005A F9                MOV     R1,A
005B A3                INC     DPTR
005C E0                MOVX    A,@DPTR
005D FA                MOV     R2,A
005E A3                INC     DPTR
005F E0                MOVX    A,@DPTR
0060 FB                MOV     R3,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 143 

0061 C000              PUSH    AR0
0063 C001              PUSH    AR1
0065 C002              PUSH    AR2
0067 C003              PUSH    AR3
0069 900000      R     MOV     DPTR,#thr_pos
006C E0                MOVX    A,@DPTR
006D A3                INC     DPTR
006E E0                MOVX    A,@DPTR
006F A3                INC     DPTR
0070 E0                MOVX    A,@DPTR
0071 FE                MOV     R6,A
0072 A3                INC     DPTR
0073 E0                MOVX    A,@DPTR
0074 FB                MOV     R3,A
0075 AA06              MOV     R2,AR6
0077 A3                INC     DPTR
0078 E0                MOVX    A,@DPTR
0079 A3                INC     DPTR
007A E0                MOVX    A,@DPTR
007B A3                INC     DPTR
007C E0                MOVX    A,@DPTR
007D FE                MOV     R6,A
007E A3                INC     DPTR
007F E0                MOVX    A,@DPTR
0080 C3                CLR     C
0081 9B                SUBB    A,R3
0082 FF                MOV     R7,A
0083 EE                MOV     A,R6
0084 9A                SUBB    A,R2
0085 FE                MOV     R6,A
0086 120000      E     LCALL   _abs
0089 EE                MOV     A,R6
008A 33                RLC     A
008B 95E0              SUBB    A,ACC
008D FD                MOV     R5,A
008E FC                MOV     R4,A
008F D003              POP     AR3
0091 D002              POP     AR2
0093 D001              POP     AR1
0095 D000              POP     AR0
0097 EB                MOV     A,R3
0098 2F                ADD     A,R7
0099 FF                MOV     R7,A
009A EA                MOV     A,R2
009B 3E                ADDC    A,R6
009C FE                MOV     R6,A
009D E9                MOV     A,R1
009E 3D                ADDC    A,R5
009F FD                MOV     R5,A
00A0 E8                MOV     A,R0
00A1 3C                ADDC    A,R4
00A2 FC                MOV     R4,A
00A3 900000      E     MOV     DPTR,#g_mem+0F4H
00A6 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1567
00A9 900000      R     MOV     DPTR,#pos_cycle_status
00AC 7401              MOV     A,#01H
00AE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1568
                                           ; SOURCE LINE # 1569
00AF 020000      R     LJMP    ?C0267
                                           ; SOURCE LINE # 1570
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 144 

00B2         ?C0270:
                                           ; SOURCE LINE # 1571
00B2 900000      E     MOV     DPTR,#pwm_sign
00B5 E0                MOVX    A,@DPTR
00B6 F4                CPL     A
00B7 6003              JZ      $ + 5H
00B9 020000      R     LJMP    ?C0267
                                           ; SOURCE LINE # 1572
00BC 900000      R     MOV     DPTR,#curr_pos
00BF E0                MOVX    A,@DPTR
00C0 FC                MOV     R4,A
00C1 A3                INC     DPTR
00C2 E0                MOVX    A,@DPTR
00C3 FD                MOV     R5,A
00C4 A3                INC     DPTR
00C5 E0                MOVX    A,@DPTR
00C6 FE                MOV     R6,A
00C7 A3                INC     DPTR
00C8 E0                MOVX    A,@DPTR
00C9 FF                MOV     R7,A
00CA 900000      R     MOV     DPTR,#max_pos
00CD 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1573
00D0 900000      E     MOV     DPTR,#g_mem+0F4H
00D3 E0                MOVX    A,@DPTR
00D4 F8                MOV     R0,A
00D5 A3                INC     DPTR
00D6 E0                MOVX    A,@DPTR
00D7 F9                MOV     R1,A
00D8 A3                INC     DPTR
00D9 E0                MOVX    A,@DPTR
00DA FA                MOV     R2,A
00DB A3                INC     DPTR
00DC E0                MOVX    A,@DPTR
00DD FB                MOV     R3,A
00DE C000              PUSH    AR0
00E0 C001              PUSH    AR1
00E2 C002              PUSH    AR2
00E4 C003              PUSH    AR3
00E6 900000      R     MOV     DPTR,#thr_pos
00E9 E0                MOVX    A,@DPTR
00EA A3                INC     DPTR
00EB E0                MOVX    A,@DPTR
00EC A3                INC     DPTR
00ED E0                MOVX    A,@DPTR
00EE FE                MOV     R6,A
00EF A3                INC     DPTR
00F0 E0                MOVX    A,@DPTR
00F1 FB                MOV     R3,A
00F2 AA06              MOV     R2,AR6
00F4 A3                INC     DPTR
00F5 E0                MOVX    A,@DPTR
00F6 A3                INC     DPTR
00F7 E0                MOVX    A,@DPTR
00F8 A3                INC     DPTR
00F9 E0                MOVX    A,@DPTR
00FA FE                MOV     R6,A
00FB A3                INC     DPTR
00FC E0                MOVX    A,@DPTR
00FD C3                CLR     C
00FE 9B                SUBB    A,R3
00FF FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 145 

0100 EE                MOV     A,R6
0101 9A                SUBB    A,R2
0102 FE                MOV     R6,A
0103 120000      E     LCALL   _abs
0106 EE                MOV     A,R6
0107 33                RLC     A
0108 95E0              SUBB    A,ACC
010A FD                MOV     R5,A
010B FC                MOV     R4,A
010C D003              POP     AR3
010E D002              POP     AR2
0110 D001              POP     AR1
0112 D000              POP     AR0
0114 EB                MOV     A,R3
0115 2F                ADD     A,R7
0116 FF                MOV     R7,A
0117 EA                MOV     A,R2
0118 3E                ADDC    A,R6
0119 FE                MOV     R6,A
011A E9                MOV     A,R1
011B 3D                ADDC    A,R5
011C FD                MOV     R5,A
011D E8                MOV     A,R0
011E 3C                ADDC    A,R4
011F FC                MOV     R4,A
0120 900000      E     MOV     DPTR,#g_mem+0F4H
0123 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1574
0126 900000      R     MOV     DPTR,#pos_cycle_status
0129 7402              MOV     A,#02H
012B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1575
                                           ; SOURCE LINE # 1576
012C 020000      R     LJMP    ?C0267
                                           ; SOURCE LINE # 1577
012F         ?C0272:
                                           ; SOURCE LINE # 1578
012F 900000      R     MOV     DPTR,#thr_pos
0132 E0                MOVX    A,@DPTR
0133 A3                INC     DPTR
0134 E0                MOVX    A,@DPTR
0135 A3                INC     DPTR
0136 E0                MOVX    A,@DPTR
0137 FE                MOV     R6,A
0138 A3                INC     DPTR
0139 E0                MOVX    A,@DPTR
013A FB                MOV     R3,A
013B AA06              MOV     R2,AR6
013D A3                INC     DPTR
013E E0                MOVX    A,@DPTR
013F A3                INC     DPTR
0140 E0                MOVX    A,@DPTR
0141 A3                INC     DPTR
0142 E0                MOVX    A,@DPTR
0143 FE                MOV     R6,A
0144 A3                INC     DPTR
0145 E0                MOVX    A,@DPTR
0146 C3                CLR     C
0147 9B                SUBB    A,R3
0148 FF                MOV     R7,A
0149 EE                MOV     A,R6
014A 9A                SUBB    A,R2
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 146 

014B FE                MOV     R6,A
014C 120000      E     LCALL   _abs
014F EE                MOV     A,R6
0150 33                RLC     A
0151 95E0              SUBB    A,ACC
0153 FD                MOV     R5,A
0154 FC                MOV     R4,A
0155 900000      R     MOV     DPTR,#bin_threshold
0158 E0                MOVX    A,@DPTR
0159 F8                MOV     R0,A
015A A3                INC     DPTR
015B E0                MOVX    A,@DPTR
015C F9                MOV     R1,A
015D A3                INC     DPTR
015E E0                MOVX    A,@DPTR
015F FA                MOV     R2,A
0160 A3                INC     DPTR
0161 E0                MOVX    A,@DPTR
0162 FB                MOV     R3,A
0163 C3                CLR     C
0164 120000      E     LCALL   ?C?SLCMP
0167 4003              JC      $ + 5H
0169 020000      R     LJMP    ?C0273
                                           ; SOURCE LINE # 1580
016C 900000      E     MOV     DPTR,#g_mem+059H
016F E0                MOVX    A,@DPTR
0170 FC                MOV     R4,A
0171 A3                INC     DPTR
0172 E0                MOVX    A,@DPTR
0173 FD                MOV     R5,A
0174 A3                INC     DPTR
0175 E0                MOVX    A,@DPTR
0176 FE                MOV     R6,A
0177 A3                INC     DPTR
0178 E0                MOVX    A,@DPTR
0179 FF                MOV     R7,A
017A 900000      E     MOV     DPTR,#g_mem+035H
017D E0                MOVX    A,@DPTR
017E F9                MOV     R1,A
017F F8                MOV     R0,A
0180 120000      E     LCALL   ?C?SLSHR
0183 E4                CLR     A
0184 7B0A              MOV     R3,#0AH
0186 FA                MOV     R2,A
0187 F9                MOV     R1,A
0188 F8                MOV     R0,A
0189 120000      E     LCALL   ?C?SLDIV
018C 900000      R     MOV     DPTR,#step
018F 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1581
0192 900000      R     MOV     DPTR,#step
0195 E0                MOVX    A,@DPTR
0196 F8                MOV     R0,A
0197 A3                INC     DPTR
0198 E0                MOVX    A,@DPTR
0199 F9                MOV     R1,A
019A A3                INC     DPTR
019B E0                MOVX    A,@DPTR
019C FA                MOV     R2,A
019D A3                INC     DPTR
019E E0                MOVX    A,@DPTR
019F FB                MOV     R3,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 147 

01A0 900000      R     MOV     DPTR,#thr_pos
01A3 E0                MOVX    A,@DPTR
01A4 FC                MOV     R4,A
01A5 A3                INC     DPTR
01A6 E0                MOVX    A,@DPTR
01A7 FD                MOV     R5,A
01A8 A3                INC     DPTR
01A9 E0                MOVX    A,@DPTR
01AA FE                MOV     R6,A
01AB A3                INC     DPTR
01AC E0                MOVX    A,@DPTR
01AD FF                MOV     R7,A
01AE 120000      E     LCALL   ?C?SLDIV
01B1 900000      R     MOV     DPTR,#bin_st
01B4 EF                MOV     A,R7
01B5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1582
01B6 900000      R     MOV     DPTR,#step
01B9 E0                MOVX    A,@DPTR
01BA F8                MOV     R0,A
01BB A3                INC     DPTR
01BC E0                MOVX    A,@DPTR
01BD F9                MOV     R1,A
01BE A3                INC     DPTR
01BF E0                MOVX    A,@DPTR
01C0 FA                MOV     R2,A
01C1 A3                INC     DPTR
01C2 E0                MOVX    A,@DPTR
01C3 FB                MOV     R3,A
01C4 900000      R     MOV     DPTR,#max_pos
01C7 E0                MOVX    A,@DPTR
01C8 FC                MOV     R4,A
01C9 A3                INC     DPTR
01CA E0                MOVX    A,@DPTR
01CB FD                MOV     R5,A
01CC A3                INC     DPTR
01CD E0                MOVX    A,@DPTR
01CE FE                MOV     R6,A
01CF A3                INC     DPTR
01D0 E0                MOVX    A,@DPTR
01D1 FF                MOV     R7,A
01D2 120000      E     LCALL   ?C?SLDIV
01D5 900000      R     MOV     DPTR,#bin_max
01D8 EF                MOV     A,R7
01D9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1583
01DA 900000      R     MOV     DPTR,#bin_st
01DD E0                MOVX    A,@DPTR
01DE 900000      R     MOV     DPTR,#i
01E1 F0                MOVX    @DPTR,A
01E2         ?C0274:
01E2 900000      R     MOV     DPTR,#bin_max
01E5 E0                MOVX    A,@DPTR
01E6 FF                MOV     R7,A
01E7 900000      R     MOV     DPTR,#i
01EA E0                MOVX    A,@DPTR
01EB FE                MOV     R6,A
01EC D3                SETB    C
01ED 9F                SUBB    A,R7
01EE 5037              JNC     ?C0275
                                           ; SOURCE LINE # 1585
01F0 EE                MOV     A,R6
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 148 

01F1 25E0              ADD     A,ACC
01F3 25E0              ADD     A,ACC
01F5 2400        E     ADD     A,#LOW g_mem+0B8H
01F7 F582              MOV     DPL,A
01F9 E4                CLR     A
01FA 3400        E     ADDC    A,#HIGH g_mem+0B8H
01FC F583              MOV     DPH,A
01FE C083              PUSH    DPH
0200 C082              PUSH    DPL
0202 E0                MOVX    A,@DPTR
0203 FC                MOV     R4,A
0204 A3                INC     DPTR
0205 E0                MOVX    A,@DPTR
0206 FD                MOV     R5,A
0207 A3                INC     DPTR
0208 E0                MOVX    A,@DPTR
0209 FE                MOV     R6,A
020A A3                INC     DPTR
020B E0                MOVX    A,@DPTR
020C 2401              ADD     A,#01H
020E FF                MOV     R7,A
020F E4                CLR     A
0210 3E                ADDC    A,R6
0211 FE                MOV     R6,A
0212 E4                CLR     A
0213 3D                ADDC    A,R5
0214 FD                MOV     R5,A
0215 E4                CLR     A
0216 3C                ADDC    A,R4
0217 FC                MOV     R4,A
0218 D082              POP     DPL
021A D083              POP     DPH
021C 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1586
021F 900000      R     MOV     DPTR,#i
0222 E0                MOVX    A,@DPTR
0223 04                INC     A
0224 F0                MOVX    @DPTR,A
0225 80BB              SJMP    ?C0274
0227         ?C0275:
                                           ; SOURCE LINE # 1589
0227 900000      E     MOV     DPTR,#g_mem+069H
022A E0                MOVX    A,@DPTR
022B FE                MOV     R6,A
022C A3                INC     DPTR
022D E0                MOVX    A,@DPTR
022E FF                MOV     R7,A
022F EE                MOV     A,R6
0230 33                RLC     A
0231 95E0              SUBB    A,ACC
0233 FD                MOV     R5,A
0234 FC                MOV     R4,A
0235 E4                CLR     A
0236 7B04              MOV     R3,#04H
0238 FA                MOV     R2,A
0239 F9                MOV     R1,A
023A F8                MOV     R0,A
023B 120000      E     LCALL   ?C?SLDIV
023E 900000      R     MOV     DPTR,#step
0241 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1590
0244 900000      E     MOV     DPTR,#g_mem+069H
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 149 

0247 E0                MOVX    A,@DPTR
0248 FE                MOV     R6,A
0249 A3                INC     DPTR
024A E0                MOVX    A,@DPTR
024B FF                MOV     R7,A
024C EE                MOV     A,R6
024D 33                RLC     A
024E 95E0              SUBB    A,ACC
0250 FD                MOV     R5,A
0251 FC                MOV     R4,A
0252 900000      E     MOV     DPTR,#g_meas+0CH
0255 E0                MOVX    A,@DPTR
0256 F8                MOV     R0,A
0257 A3                INC     DPTR
0258 E0                MOVX    A,@DPTR
0259 F9                MOV     R1,A
025A A3                INC     DPTR
025B E0                MOVX    A,@DPTR
025C FA                MOV     R2,A
025D A3                INC     DPTR
025E E0                MOVX    A,@DPTR
025F FB                MOV     R3,A
0260 D3                SETB    C
0261 120000      E     LCALL   ?C?SLCMP
0264 4021              JC      ?C0277
                                           ; SOURCE LINE # 1591
0266 900000      E     MOV     DPTR,#g_mem+0ECH
0269 E0                MOVX    A,@DPTR
026A FC                MOV     R4,A
026B A3                INC     DPTR
026C E0                MOVX    A,@DPTR
026D FD                MOV     R5,A
026E A3                INC     DPTR
026F E0                MOVX    A,@DPTR
0270 FE                MOV     R6,A
0271 A3                INC     DPTR
0272 E0                MOVX    A,@DPTR
0273 2401              ADD     A,#01H
0275 FF                MOV     R7,A
0276 E4                CLR     A
0277 3E                ADDC    A,R6
0278 FE                MOV     R6,A
0279 E4                CLR     A
027A 3D                ADDC    A,R5
027B FD                MOV     R5,A
027C E4                CLR     A
027D 3C                ADDC    A,R4
027E FC                MOV     R4,A
027F 900000      E     MOV     DPTR,#g_mem+0ECH
0282 120000      E     LCALL   ?C?LSTXDATA
0285 804E              SJMP    ?C0273
0287         ?C0277:
                                           ; SOURCE LINE # 1593
0287 900000      R     MOV     DPTR,#step
028A E0                MOVX    A,@DPTR
028B F8                MOV     R0,A
028C A3                INC     DPTR
028D E0                MOVX    A,@DPTR
028E F9                MOV     R1,A
028F A3                INC     DPTR
0290 E0                MOVX    A,@DPTR
0291 FA                MOV     R2,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 150 

0292 A3                INC     DPTR
0293 E0                MOVX    A,@DPTR
0294 FB                MOV     R3,A
0295 900000      E     MOV     DPTR,#g_meas+0CH
0298 E0                MOVX    A,@DPTR
0299 FC                MOV     R4,A
029A A3                INC     DPTR
029B E0                MOVX    A,@DPTR
029C FD                MOV     R5,A
029D A3                INC     DPTR
029E E0                MOVX    A,@DPTR
029F FE                MOV     R6,A
02A0 A3                INC     DPTR
02A1 E0                MOVX    A,@DPTR
02A2 FF                MOV     R7,A
02A3 120000      E     LCALL   ?C?SLDIV
02A6 EF                MOV     A,R7
02A7 25E0              ADD     A,ACC
02A9 25E0              ADD     A,ACC
02AB 2400        E     ADD     A,#LOW g_mem+0E0H
02AD F582              MOV     DPL,A
02AF E4                CLR     A
02B0 3400        E     ADDC    A,#HIGH g_mem+0E0H
02B2 F583              MOV     DPH,A
02B4 C083              PUSH    DPH
02B6 C082              PUSH    DPL
02B8 E0                MOVX    A,@DPTR
02B9 FC                MOV     R4,A
02BA A3                INC     DPTR
02BB E0                MOVX    A,@DPTR
02BC FD                MOV     R5,A
02BD A3                INC     DPTR
02BE E0                MOVX    A,@DPTR
02BF FE                MOV     R6,A
02C0 A3                INC     DPTR
02C1 E0                MOVX    A,@DPTR
02C2 2401              ADD     A,#01H
02C4 FF                MOV     R7,A
02C5 E4                CLR     A
02C6 3E                ADDC    A,R6
02C7 FE                MOV     R6,A
02C8 E4                CLR     A
02C9 3D                ADDC    A,R5
02CA FD                MOV     R5,A
02CB E4                CLR     A
02CC 3C                ADDC    A,R4
02CD FC                MOV     R4,A
02CE D082              POP     DPL
02D0 D083              POP     DPH
02D2 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1594
02D5         ?C0273:
                                           ; SOURCE LINE # 1595
02D5 E4                CLR     A
02D6 900000      R     MOV     DPTR,#pos_cycle_status
02D9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1596
                                           ; SOURCE LINE # 1597
02DA         ?C0267:
                                           ; SOURCE LINE # 1600
02DA E4                CLR     A
02DB 900000      R     MOV     DPTR,#i
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 151 

02DE F0                MOVX    @DPTR,A
02DF         ?C0279:
02DF 900000      R     MOV     DPTR,#i
02E2 E0                MOVX    A,@DPTR
02E3 FF                MOV     R7,A
02E4 C3                CLR     C
02E5 9402              SUBB    A,#02H
02E7 4003              JC      $ + 5H
02E9 020000      R     LJMP    ?C0280
02EC E500        E     MOV     A,emg_1_status
02EE 6003              JZ      $ + 5H
02F0 020000      R     LJMP    ?C0280
02F3 E500        E     MOV     A,emg_2_status
02F5 6003              JZ      $ + 5H
02F7 020000      R     LJMP    ?C0280
                                           ; SOURCE LINE # 1601
02FA 7400        R     MOV     A,#LOW emg_cycle_status
02FC 2F                ADD     A,R7
02FD F582              MOV     DPL,A
02FF E4                CLR     A
0300 3400        R     ADDC    A,#HIGH emg_cycle_status
0302 F583              MOV     DPH,A
0304 E0                MOVX    A,@DPTR
0305 14                DEC     A
0306 6059              JZ      ?C0285
0308 14                DEC     A
0309 7003              JNZ     $ + 5H
030B 020000      R     LJMP    ?C0287
030E 2402              ADD     A,#02H
0310 6003              JZ      $ + 5H
0312 020000      R     LJMP    ?C0281
                                           ; SOURCE LINE # 1602
0315         ?C0283:
                                           ; SOURCE LINE # 1603
0315 900000      R     MOV     DPTR,#i
0318 E0                MOVX    A,@DPTR
0319 FB                MOV     R3,A
031A 25E0              ADD     A,ACC
031C 2400        E     ADD     A,#LOW g_mem+06BH
031E F582              MOV     DPL,A
0320 E4                CLR     A
0321 3400        E     ADDC    A,#HIGH g_mem+06BH
0323 F583              MOV     DPH,A
0325 E0                MOVX    A,@DPTR
0326 FE                MOV     R6,A
0327 A3                INC     DPTR
0328 E0                MOVX    A,@DPTR
0329 FF                MOV     R7,A
032A E4                CLR     A
032B FC                MOV     R4,A
032C FD                MOV     R5,A
032D EB                MOV     A,R3
032E 25E0              ADD     A,ACC
0330 25E0              ADD     A,ACC
0332 2400        E     ADD     A,#LOW g_meas+017H
0334 F582              MOV     DPL,A
0336 E4                CLR     A
0337 3400        E     ADDC    A,#HIGH g_meas+017H
0339 F583              MOV     DPH,A
033B E0                MOVX    A,@DPTR
033C F8                MOV     R0,A
033D A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 152 

033E E0                MOVX    A,@DPTR
033F F9                MOV     R1,A
0340 A3                INC     DPTR
0341 E0                MOVX    A,@DPTR
0342 FA                MOV     R2,A
0343 A3                INC     DPTR
0344 E0                MOVX    A,@DPTR
0345 FB                MOV     R3,A
0346 D3                SETB    C
0347 120000      E     LCALL   ?C?SLCMP
034A 5003              JNC     $ + 5H
034C 020000      R     LJMP    ?C0281
                                           ; SOURCE LINE # 1604
034F 900000      R     MOV     DPTR,#i
0352 E0                MOVX    A,@DPTR
0353 2400        R     ADD     A,#LOW emg_cycle_status
0355 F582              MOV     DPL,A
0357 E4                CLR     A
0358 3400        R     ADDC    A,#HIGH emg_cycle_status
035A F583              MOV     DPH,A
035C 7401              MOV     A,#01H
035E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1605
                                           ; SOURCE LINE # 1606
035F 807B              SJMP    ?C0281
                                           ; SOURCE LINE # 1607
0361         ?C0285:
                                           ; SOURCE LINE # 1608
0361 900000      R     MOV     DPTR,#i
0364 E0                MOVX    A,@DPTR
0365 25E0              ADD     A,ACC
0367 25E0              ADD     A,ACC
0369 2400        E     ADD     A,#LOW g_meas+017H
036B F582              MOV     DPL,A
036D E4                CLR     A
036E 3400        E     ADDC    A,#HIGH g_meas+017H
0370 F583              MOV     DPH,A
0372 E0                MOVX    A,@DPTR
0373 FC                MOV     R4,A
0374 A3                INC     DPTR
0375 E0                MOVX    A,@DPTR
0376 FD                MOV     R5,A
0377 A3                INC     DPTR
0378 E0                MOVX    A,@DPTR
0379 FE                MOV     R6,A
037A A3                INC     DPTR
037B E0                MOVX    A,@DPTR
037C FF                MOV     R7,A
037D E4                CLR     A
037E 7B0A              MOV     R3,#0AH
0380 FA                MOV     R2,A
0381 F9                MOV     R1,A
0382 F8                MOV     R0,A
0383 D3                SETB    C
0384 120000      E     LCALL   ?C?SLCMP
0387 4053              JC      ?C0281
                                           ; SOURCE LINE # 1609
0389 900000      R     MOV     DPTR,#i
038C E0                MOVX    A,@DPTR
038D 2400        R     ADD     A,#LOW emg_cycle_status
038F F582              MOV     DPL,A
0391 E4                CLR     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 153 

0392 3400        R     ADDC    A,#HIGH emg_cycle_status
0394 F583              MOV     DPH,A
0396 7402              MOV     A,#02H
0398 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1610
                                           ; SOURCE LINE # 1611
0399 8041              SJMP    ?C0281
                                           ; SOURCE LINE # 1612
039B         ?C0287:
                                           ; SOURCE LINE # 1613
039B 900000      R     MOV     DPTR,#i
039E E0                MOVX    A,@DPTR
039F 25E0              ADD     A,ACC
03A1 25E0              ADD     A,ACC
03A3 2400        E     ADD     A,#LOW g_mem+0B0H
03A5 F582              MOV     DPL,A
03A7 E4                CLR     A
03A8 3400        E     ADDC    A,#HIGH g_mem+0B0H
03AA F583              MOV     DPH,A
03AC C083              PUSH    DPH
03AE C082              PUSH    DPL
03B0 E0                MOVX    A,@DPTR
03B1 FC                MOV     R4,A
03B2 A3                INC     DPTR
03B3 E0                MOVX    A,@DPTR
03B4 FD                MOV     R5,A
03B5 A3                INC     DPTR
03B6 E0                MOVX    A,@DPTR
03B7 FE                MOV     R6,A
03B8 A3                INC     DPTR
03B9 E0                MOVX    A,@DPTR
03BA 2401              ADD     A,#01H
03BC FF                MOV     R7,A
03BD E4                CLR     A
03BE 3E                ADDC    A,R6
03BF FE                MOV     R6,A
03C0 E4                CLR     A
03C1 3D                ADDC    A,R5
03C2 FD                MOV     R5,A
03C3 E4                CLR     A
03C4 3C                ADDC    A,R4
03C5 FC                MOV     R4,A
03C6 D082              POP     DPL
03C8 D083              POP     DPH
03CA 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1614
03CD 900000      R     MOV     DPTR,#i
03D0 E0                MOVX    A,@DPTR
03D1 2400        R     ADD     A,#LOW emg_cycle_status
03D3 F582              MOV     DPL,A
03D5 E4                CLR     A
03D6 3400        R     ADDC    A,#HIGH emg_cycle_status
03D8 F583              MOV     DPH,A
03DA E4                CLR     A
03DB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1615
                                           ; SOURCE LINE # 1616
                                           ; SOURCE LINE # 1617
03DC         ?C0281:
03DC 900000      R     MOV     DPTR,#i
03DF E0                MOVX    A,@DPTR
03E0 04                INC     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 154 

03E1 F0                MOVX    @DPTR,A
03E2 020000      R     LJMP    ?C0279
03E5         ?C0280:
                                           ; SOURCE LINE # 1620
03E5 900000      R     MOV     DPTR,#rest_cycle_status
03E8 E0                MOVX    A,@DPTR
03E9 14                DEC     A
03EA 602B              JZ      ?C0291
03EC 14                DEC     A
03ED 7003              JNZ     $ + 5H
03EF 020000      R     LJMP    ?C0294
03F2 2402              ADD     A,#02H
03F4 6003              JZ      $ + 5H
03F6 020000      R     LJMP    ?C0288
                                           ; SOURCE LINE # 1621
03F9         ?C0289:
                                           ; SOURCE LINE # 1622
03F9 900000      E     MOV     DPTR,#rest_enabled
03FC E0                MOVX    A,@DPTR
03FD 7003              JNZ     $ + 5H
03FF 020000      R     LJMP    ?C0288
                                           ; SOURCE LINE # 1623
0402 120000      E     LCALL   CYCLES_TIMER_ReadCounter
0405 E4                CLR     A
0406 FC                MOV     R4,A
0407 FD                MOV     R5,A
0408 900000      R     MOV     DPTR,#timer_value_s
040B 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1624
040E 900000      R     MOV     DPTR,#rest_cycle_status
0411 7401              MOV     A,#01H
0413 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1625
                                           ; SOURCE LINE # 1626
0414 020000      R     LJMP    ?C0288
                                           ; SOURCE LINE # 1627
0417         ?C0291:
                                           ; SOURCE LINE # 1628
0417 900000      E     MOV     DPTR,#rest_enabled
041A E0                MOVX    A,@DPTR
041B 6003              JZ      $ + 5H
041D 020000      R     LJMP    ?C0288
                                           ; SOURCE LINE # 1629
0420 120000      E     LCALL   CYCLES_TIMER_ReadCounter
0423 E4                CLR     A
0424 FC                MOV     R4,A
0425 FD                MOV     R5,A
0426 900000      R     MOV     DPTR,#timer_value_e
0429 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1630
042C 900000      R     MOV     DPTR,#timer_value_e
042F E0                MOVX    A,@DPTR
0430 FC                MOV     R4,A
0431 A3                INC     DPTR
0432 E0                MOVX    A,@DPTR
0433 FD                MOV     R5,A
0434 A3                INC     DPTR
0435 E0                MOVX    A,@DPTR
0436 FE                MOV     R6,A
0437 A3                INC     DPTR
0438 E0                MOVX    A,@DPTR
0439 FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 155 

043A 900000      R     MOV     DPTR,#timer_value_s
043D E0                MOVX    A,@DPTR
043E F8                MOV     R0,A
043F A3                INC     DPTR
0440 E0                MOVX    A,@DPTR
0441 F9                MOV     R1,A
0442 A3                INC     DPTR
0443 E0                MOVX    A,@DPTR
0444 FA                MOV     R2,A
0445 A3                INC     DPTR
0446 E0                MOVX    A,@DPTR
0447 FB                MOV     R3,A
0448 C3                CLR     C
0449 120000      E     LCALL   ?C?ULCMP
044C 5020              JNC     ?C0293
                                           ; SOURCE LINE # 1631
044E 900000      R     MOV     DPTR,#timer_value_s
0451 E0                MOVX    A,@DPTR
0452 FC                MOV     R4,A
0453 A3                INC     DPTR
0454 E0                MOVX    A,@DPTR
0455 FD                MOV     R5,A
0456 A3                INC     DPTR
0457 E0                MOVX    A,@DPTR
0458 FE                MOV     R6,A
0459 A3                INC     DPTR
045A E0                MOVX    A,@DPTR
045B 24B0              ADD     A,#0B0H
045D FF                MOV     R7,A
045E EE                MOV     A,R6
045F 3404              ADDC    A,#04H
0461 FE                MOV     R6,A
0462 E4                CLR     A
0463 3D                ADDC    A,R5
0464 FD                MOV     R5,A
0465 E4                CLR     A
0466 3C                ADDC    A,R4
0467 FC                MOV     R4,A
0468 900000      R     MOV     DPTR,#timer_value_s
046B 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1632
046E         ?C0293:
                                           ; SOURCE LINE # 1633
046E 900000      R     MOV     DPTR,#rest_cycle_status
0471 7402              MOV     A,#02H
0473 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1634
                                           ; SOURCE LINE # 1635
0474 020000      R     LJMP    ?C0288
                                           ; SOURCE LINE # 1636
0477         ?C0294:
                                           ; SOURCE LINE # 1637
0477 900000      E     MOV     DPTR,#g_mem+0FCH
047A E0                MOVX    A,@DPTR
047B F8                MOV     R0,A
047C A3                INC     DPTR
047D E0                MOVX    A,@DPTR
047E F9                MOV     R1,A
047F A3                INC     DPTR
0480 E0                MOVX    A,@DPTR
0481 FA                MOV     R2,A
0482 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 156 

0483 E0                MOVX    A,@DPTR
0484 FB                MOV     R3,A
0485 C000              PUSH    AR0
0487 C001              PUSH    AR1
0489 C002              PUSH    AR2
048B C003              PUSH    AR3
048D 900000      R     MOV     DPTR,#timer_value_e
0490 E0                MOVX    A,@DPTR
0491 F8                MOV     R0,A
0492 A3                INC     DPTR
0493 E0                MOVX    A,@DPTR
0494 F9                MOV     R1,A
0495 A3                INC     DPTR
0496 E0                MOVX    A,@DPTR
0497 FA                MOV     R2,A
0498 A3                INC     DPTR
0499 E0                MOVX    A,@DPTR
049A FB                MOV     R3,A
049B 900000      R     MOV     DPTR,#timer_value_s
049E E0                MOVX    A,@DPTR
049F FC                MOV     R4,A
04A0 A3                INC     DPTR
04A1 E0                MOVX    A,@DPTR
04A2 FD                MOV     R5,A
04A3 A3                INC     DPTR
04A4 E0                MOVX    A,@DPTR
04A5 FE                MOV     R6,A
04A6 A3                INC     DPTR
04A7 E0                MOVX    A,@DPTR
04A8 C3                CLR     C
04A9 9B                SUBB    A,R3
04AA FF                MOV     R7,A
04AB EE                MOV     A,R6
04AC 9A                SUBB    A,R2
04AD FE                MOV     R6,A
04AE ED                MOV     A,R5
04AF 99                SUBB    A,R1
04B0 FD                MOV     R5,A
04B1 EC                MOV     A,R4
04B2 98                SUBB    A,R0
04B3 FC                MOV     R4,A
04B4 E4                CLR     A
04B5 7B0A              MOV     R3,#0AH
04B7 FA                MOV     R2,A
04B8 F9                MOV     R1,A
04B9 F8                MOV     R0,A
04BA 120000      E     LCALL   ?C?ULDIV
04BD D003              POP     AR3
04BF D002              POP     AR2
04C1 D001              POP     AR1
04C3 D000              POP     AR0
04C5 EB                MOV     A,R3
04C6 2F                ADD     A,R7
04C7 FF                MOV     R7,A
04C8 EA                MOV     A,R2
04C9 3E                ADDC    A,R6
04CA FE                MOV     R6,A
04CB E9                MOV     A,R1
04CC 3D                ADDC    A,R5
04CD FD                MOV     R5,A
04CE E8                MOV     A,R0
04CF 3C                ADDC    A,R4
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 157 

04D0 FC                MOV     R4,A
04D1 900000      E     MOV     DPTR,#g_mem+0FCH
04D4 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1638
04D7 900000      E     MOV     DPTR,#g_mem+0F0H
04DA E0                MOVX    A,@DPTR
04DB FC                MOV     R4,A
04DC A3                INC     DPTR
04DD E0                MOVX    A,@DPTR
04DE FD                MOV     R5,A
04DF A3                INC     DPTR
04E0 E0                MOVX    A,@DPTR
04E1 FE                MOV     R6,A
04E2 A3                INC     DPTR
04E3 E0                MOVX    A,@DPTR
04E4 2401              ADD     A,#01H
04E6 FF                MOV     R7,A
04E7 E4                CLR     A
04E8 3E                ADDC    A,R6
04E9 FE                MOV     R6,A
04EA E4                CLR     A
04EB 3D                ADDC    A,R5
04EC FD                MOV     R5,A
04ED E4                CLR     A
04EE 3C                ADDC    A,R4
04EF FC                MOV     R4,A
04F0 900000      E     MOV     DPTR,#g_mem+0F0H
04F3 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1639
04F6 E4                CLR     A
04F7 900000      R     MOV     DPTR,#rest_cycle_status
04FA F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1640
                                           ; SOURCE LINE # 1641
04FB         ?C0288:
                                           ; SOURCE LINE # 1644
04FB 120000      R     LCALL   save_cycles_eeprom
                                           ; SOURCE LINE # 1645
04FE 22                RET     
             ; FUNCTION cycles_counter_update (END)

             ; FUNCTION save_cycles_eeprom (BEGIN)
                                           ; SOURCE LINE # 1651
                                           ; SOURCE LINE # 1655
0000 900000      R     MOV     DPTR,#row_start
0003 740B              MOV     A,#0BH
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1656
0006 A3                INC     DPTR
0007 7401              MOV     A,#01H
0009 F0                MOVX    @DPTR,A
000A A3                INC     DPTR
000B 7400        E     MOV     A,#HIGH g_mem+0B0H
000D F0                MOVX    @DPTR,A
000E A3                INC     DPTR
000F 7400        E     MOV     A,#LOW g_mem+0B0H
0011 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1657
0012 A3                INC     DPTR
0013 7401              MOV     A,#01H
0015 F0                MOVX    @DPTR,A
0016 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 158 

0017 7400        E     MOV     A,#HIGH c_mem+0B0H
0019 F0                MOVX    @DPTR,A
001A A3                INC     DPTR
001B 7400        E     MOV     A,#LOW c_mem+0B0H
001D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1658
001E 740B              MOV     A,#0BH
0020 2404              ADD     A,#04H
0022 A3                INC     DPTR
0023 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1662
0024 E500        E     MOV     A,cycles_status
0026 14                DEC     A
0027 6052              JZ      ?C0298
0029 14                DEC     A
002A 6077              JZ      ?C0301
002C 14                DEC     A
002D 7003              JNZ     $ + 5H
002F 020000      R     LJMP    ?C0305
0032 2403              ADD     A,#03H
0034 6003              JZ      $ + 5H
0036 020000      R     LJMP    ?C0307
                                           ; SOURCE LINE # 1663
0039         ?C0297:
                                           ; SOURCE LINE # 1665
0039 900000      R     MOV     DPTR,#addr_start_c
003C E0                MOVX    A,@DPTR
003D FB                MOV     R3,A
003E A3                INC     DPTR
003F E0                MOVX    A,@DPTR
0040 FA                MOV     R2,A
0041 A3                INC     DPTR
0042 E0                MOVX    A,@DPTR
0043 F8                MOV     R0,A
0044 AC02              MOV     R4,AR2
0046 AD03              MOV     R5,AR3
0048 900000      R     MOV     DPTR,#addr_start
004B E0                MOVX    A,@DPTR
004C FB                MOV     R3,A
004D A3                INC     DPTR
004E E0                MOVX    A,@DPTR
004F FA                MOV     R2,A
0050 A3                INC     DPTR
0051 E0                MOVX    A,@DPTR
0052 F9                MOV     R1,A
0053 7E00              MOV     R6,#00H
0055 7F50              MOV     R7,#050H
0057 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 1666
005A 900000      R     MOV     DPTR,#addr_start
005D E0                MOVX    A,@DPTR
005E F9                MOV     R1,A
005F A3                INC     DPTR
0060 E0                MOVX    A,@DPTR
0061 FA                MOV     R2,A
0062 A3                INC     DPTR
0063 E0                MOVX    A,@DPTR
0064 900000      R     MOV     DPTR,#m_addr
0067 C9                XCH     A,R1
0068 F0                MOVX    @DPTR,A
0069 A3                INC     DPTR
006A EA                MOV     A,R2
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 159 

006B F0                MOVX    @DPTR,A
006C A3                INC     DPTR
006D E9                MOV     A,R1
006E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1667
006F 900000      R     MOV     DPTR,#row_start
0072 E0                MOVX    A,@DPTR
0073 900000      R     MOV     DPTR,#row_number
0076 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1668
0077 750001      E     MOV     cycles_status,#01H
                                           ; SOURCE LINE # 1669
007A 22                RET     
                                           ; SOURCE LINE # 1671
007B         ?C0298:
                                           ; SOURCE LINE # 1672
007B 120000      E     LCALL   EEPROM_UpdateTemperature
                                           ; SOURCE LINE # 1673
007E 900000      R     MOV     DPTR,#m_addr
0081 E0                MOVX    A,@DPTR
0082 FB                MOV     R3,A
0083 A3                INC     DPTR
0084 E0                MOVX    A,@DPTR
0085 FA                MOV     R2,A
0086 A3                INC     DPTR
0087 E0                MOVX    A,@DPTR
0088 F9                MOV     R1,A
0089 900000      R     MOV     DPTR,#row_number
008C E0                MOVX    A,@DPTR
008D FD                MOV     R5,A
008E 120000      E     LCALL   _EEPROM_StartWrite
0091 900000      R     MOV     DPTR,#status
0094 EF                MOV     A,R7
0095 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1674
0096 6407              XRL     A,#07H
0098 6003              JZ      ?C0300
009A E0                MOVX    A,@DPTR
009B 7059              JNZ     ?C0307
009D         ?C0300:
                                           ; SOURCE LINE # 1675
009D 750002      E     MOV     cycles_status,#02H
                                           ; SOURCE LINE # 1676
00A0 C200        E     CLR     can_write
                                           ; SOURCE LINE # 1677
                                           ; SOURCE LINE # 1678
00A2 22                RET     
                                           ; SOURCE LINE # 1680
00A3         ?C0301:
                                           ; SOURCE LINE # 1681
00A3 120000      E     LCALL   EEPROM_Query
00A6 900000      R     MOV     DPTR,#status
00A9 EF                MOV     A,R7
00AA F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1682
00AB 7049              JNZ     ?C0307
                                           ; SOURCE LINE # 1683
00AD 900000      R     MOV     DPTR,#row_end
00B0 E0                MOVX    A,@DPTR
00B1 FF                MOV     R7,A
00B2 900000      R     MOV     DPTR,#row_number
00B5 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 160 

00B6 C3                CLR     C
00B7 9F                SUBB    A,R7
00B8 5014              JNC     ?C0303
                                           ; SOURCE LINE # 1684
00BA 900000      R     MOV     DPTR,#m_addr+01H
00BD E4                CLR     A
00BE 75F010            MOV     B,#010H
00C1 120000      E     LCALL   ?C?IILDX
                                           ; SOURCE LINE # 1685
00C4 900000      R     MOV     DPTR,#row_number
00C7 E0                MOVX    A,@DPTR
00C8 04                INC     A
00C9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1686
00CA 750001      E     MOV     cycles_status,#01H
                                           ; SOURCE LINE # 1687
00CD 22                RET     
00CE         ?C0303:
                                           ; SOURCE LINE # 1688
                                           ; SOURCE LINE # 1689
00CE 750003      E     MOV     cycles_status,#03H
                                           ; SOURCE LINE # 1690
                                           ; SOURCE LINE # 1691
                                           ; SOURCE LINE # 1692
00D1 22                RET     
                                           ; SOURCE LINE # 1694
00D2         ?C0305:
                                           ; SOURCE LINE # 1695
00D2 D200        E     SETB    can_write
                                           ; SOURCE LINE # 1696
00D4 750004      E     MOV     cycles_status,#04H
                                           ; SOURCE LINE # 1699
00D7 900000      R     MOV     DPTR,#addr_start
00DA E0                MOVX    A,@DPTR
00DB FB                MOV     R3,A
00DC A3                INC     DPTR
00DD E0                MOVX    A,@DPTR
00DE FA                MOV     R2,A
00DF A3                INC     DPTR
00E0 E0                MOVX    A,@DPTR
00E1 F8                MOV     R0,A
00E2 AC02              MOV     R4,AR2
00E4 AD03              MOV     R5,AR3
00E6 A3                INC     DPTR
00E7 E0                MOVX    A,@DPTR
00E8 FB                MOV     R3,A
00E9 A3                INC     DPTR
00EA E0                MOVX    A,@DPTR
00EB FA                MOV     R2,A
00EC A3                INC     DPTR
00ED E0                MOVX    A,@DPTR
00EE F9                MOV     R1,A
00EF 7E00              MOV     R6,#00H
00F1 7F50              MOV     R7,#050H
00F3 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 1700
                                           ; SOURCE LINE # 1702
                                           ; SOURCE LINE # 1703
                                           ; SOURCE LINE # 1704
                                           ; SOURCE LINE # 1705
00F6         ?C0307:
00F6 22                RET     
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/09/2021 12:48:44 PAGE 161 

             ; FUNCTION save_cycles_eeprom (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =  10991    ----
   CONSTANT SIZE    =     32    ----
   XDATA SIZE       =    271      40
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      6      92
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      3       2
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
